

# åŸºäº qiankun çš„JQè€é¡¹ç›®å‡çº§-åŸºç¡€æ–¹æ¡ˆ

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

ä¸ºå®ç°å›¢é˜ŸJQè€é¡¹ç›®å‡çº§å’Œæ‰©å±•ï¼ŒåŸºäº **qiankun å¾®å‰ç«¯æ¡†æ¶** ï¼Œé‡‡ç”¨"ä¸»åº”ç”¨ + å­åº”ç”¨"çš„æ¶æ„æ¨¡å¼ï¼Œç›®æ ‡å®ç°ç»„ä»¶çº§åˆ«çš„å¾®å‰ç«¯ç®¡ç†ã€‚

### æŠ€æœ¯æ ˆé…ç½®

| åº”ç”¨ç±»å‹ | æŠ€æœ¯æ ˆ | ç«¯å£ | èŒè´£ |
|---------|--------|------|------|
| **ä¸»åº”ç”¨** | jQuery 3.6.0 + qiankun 2.10.16 + Webpack 5 | 8080 | è·¯ç”±æ§åˆ¶ã€åº”ç”¨åŠ è½½ç®¡ç†ã€å…¨å±€å¯¼èˆª |
| **å­åº”ç”¨** | React 18.2.0 + Ant Design 5.2.0 + Webpack 5 | 3000 | ä¸šåŠ¡ç»„ä»¶æ¸²æŸ“ã€å…·ä½“åŠŸèƒ½å®ç° |

---

## ğŸ”§ æ ¸å¿ƒæŠ€æœ¯å®ç°

### 1. åŠ¨æ€å¾®åº”ç”¨åŠ è½½æœºåˆ¶

é¡¹ç›®é‡‡ç”¨åŠ¨æ€æ³¨å…¥ qiankun çš„æ–¹å¼ï¼Œå®ç°æŒ‰éœ€åŠ è½½ï¼š

#### ä¸»åº”ç”¨è·¯ç”±é…ç½®
```javascript
// ä¸»åº”ç”¨ä¸­çš„è·¯ç”±é…ç½®
getRouteConfig() {
    return {
        '/data-market': { needMicroApp: true, component: 'data-market' },
        '/analytics': { needMicroApp: true, component: 'analytics' },
        '/reports': { needMicroApp: true, component: 'reports' },
        '/chart-modal': { needMicroApp: true, component: 'chart-modal' }
    };
}
```

#### åŠ¨æ€åŠ è½½é€»è¾‘
```javascript
// åŠ¨æ€åŠ è½½å¾®åº”ç”¨
loadMicroApp(component) {
    this.currentApp = loadMicroApp({
        name: `react-app-${component}`,
        entry: '//localhost:3000',
        container: '#subapp-container',
        props: { component: component } // å…³é”®ï¼šä¼ é€’ç»„ä»¶å
    });
}
```

### 2. URL è·¯ç”±ä¸ç»„ä»¶æ˜ å°„

å®ç°äº†åŸºäº URL çš„ç»„ä»¶åŠ¨æ€åŠ è½½æœºåˆ¶ï¼š

- `http://localhost:8080/data-market` â†’ æ•°æ®é›†å¸‚é¡µé¢ç»„ä»¶
- `http://localhost:8080/analytics` â†’ åˆ†æå¼¹çª—ç»„ä»¶  
- `http://localhost:8080/reports` â†’ æŠ¥è¡¨ä¸­å¿ƒç»„ä»¶
- `http://localhost:8080/chart-modal` â†’ å›¾è¡¨å¼¹çª—ç»„ä»¶

### 3. å­åº”ç”¨ç»„ä»¶è·¯ç”±å™¨

å­åº”ç”¨å†…éƒ¨é€šè¿‡ `ComponentRouter` æ ¹æ®ä¼ å…¥å‚æ•°åŠ¨æ€æ¸²æŸ“ï¼š

```javascript
const ComponentRouter = ({ component, ...props }) => {
  const renderComponent = () => {
    switch (component) {
      case 'data-market': 
        return <DataMarketApp {...props} />;
      case 'analytics': 
        return <AnalyticsApp {...props} />;
      case 'reports': 
        return <ReportsApp {...props} />;
      case 'chart-modal': 
        return <ChartModalApp {...props} />;
      default: 
        return <NotFoundApp {...props} />;
    }
  };
  
  return (
    <ConfigProvider locale={zhCN}>
      {renderComponent()}
    </ConfigProvider>
  );
};
```

### 4. è·¯ç”±é©±åŠ¨çš„åº”ç”¨ç®¡ç†

```javascript
// è·¯ç”±å˜åŒ–æ—¶çš„å¤„ç†é€»è¾‘
async handleRouteChange() {
    const routeInfo = this.routeConfig[currentPath];
    
    if (routeInfo.needMicroApp) {
        // åŠ è½½å­åº”ç”¨ç»„ä»¶
        await this.loadMicroApp(routeInfo.component); 
    } else {
        // å¸è½½å­åº”ç”¨
        await this.unloadMicroApp(); 
        // æ˜¾ç¤ºé™æ€é¡µé¢
        this.showStaticPage(routeInfo.component); 
    }
}
```

---

## ğŸ¯ æ¶æ„åˆ›æ–°ç‚¹

### âœ¨ å•å­åº”ç”¨å¤šç»„ä»¶æ¨¡å¼
- åªéƒ¨ç½²ä¸€ä¸ª React å­åº”ç”¨ï¼Œé€šè¿‡å‚æ•°æ§åˆ¶æ¸²æŸ“ä¸åŒä¸šåŠ¡ç»„ä»¶
- é¿å…äº†å¤šä¸ªå­åº”ç”¨çš„éƒ¨ç½²å’Œç»´æŠ¤æˆæœ¬
- å®ç°äº†ç»„ä»¶çº§åˆ«çš„å¾®å‰ç«¯ç²’åº¦

### âš¡ æŒ‰éœ€åŠ¨æ€åŠ è½½
- ä½¿ç”¨ `loadMicroApp` è€Œä¸æ˜¯ `registerMicroApps`
- åªåœ¨éœ€è¦æ—¶æ‰åŠ è½½å’Œå¯åŠ¨ qiankun
- æ”¯æŒåº”ç”¨çš„åŠ¨æ€å¸è½½å’Œé‡æ–°åŠ è½½

### ğŸš€ è·¯ç”±é©±åŠ¨ç®¡ç†
- åŸºäºè·¯ç”±é…ç½®çš„åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†
- æ”¯æŒé™æ€é¡µé¢å’Œå¾®åº”ç”¨çš„æ··åˆä½¿ç”¨
- æ— ç¼çš„ç”¨æˆ·ä½“éªŒåˆ‡æ¢

---

## ğŸ”„ ç³»ç»Ÿå·¥ä½œæµç¨‹

```mermaid
graph TD
    A[ç”¨æˆ·è®¿é—®URL] --> B[RouteManageråŒ¹é…è·¯ç”±]
    B --> C{æ˜¯å¦éœ€è¦å¾®åº”ç”¨?}
    C -->|æ˜¯| D[åŠ¨æ€åŠ è½½qiankun]
    C -->|å¦| E[æ˜¾ç¤ºé™æ€é¡µé¢]
    D --> F[ä¼ é€’componentå‚æ•°]
    F --> G[ComponentRouteræ¸²æŸ“ç»„ä»¶]
    G --> H[ä¸šåŠ¡ç»„ä»¶å±•ç¤º]
    E --> I[é™æ€å†…å®¹å±•ç¤º]
```


### è¯¦ç»†æ­¥éª¤

1. **åˆå§‹åŒ–é˜¶æ®µ**ï¼šä¸»åº”ç”¨å¯åŠ¨ï¼Œç»‘å®šè·¯ç”±ç›‘å¬äº‹ä»¶
2. **è·¯ç”±åŒ¹é…**ï¼šç”¨æˆ·è®¿é—® URLï¼Œ`RouteManager` åŒ¹é…è·¯ç”±é…ç½®
3. **åŠ¨æ€åˆ¤æ–­**ï¼šæ ¹æ® `needMicroApp` å†³å®šæ˜¯å¦éœ€è¦åŠ è½½å­åº”ç”¨
4. **ç»„ä»¶ä¼ é€’**ï¼šå°† `component` å‚æ•°ä¼ é€’ç»™å­åº”ç”¨
5. **ç»„ä»¶æ¸²æŸ“**ï¼šå­åº”ç”¨çš„ `ComponentRouter` æ ¹æ®å‚æ•°æ¸²æŸ“å¯¹åº”ç»„ä»¶
6. **ç”Ÿå‘½å‘¨æœŸç®¡ç†**ï¼šæ”¯æŒåº”ç”¨çš„æŒ‚è½½ã€å¸è½½å’Œé‡æ–°åŠ è½½

---

## ğŸ“Š æ¶æ„ä¼˜åŠ¿æ€»ç»“

| ä¼˜åŠ¿ç±»å‹ | å…·ä½“è¡¨ç° |
|----------|----------|
| **èµ„æºèŠ‚çº¦** | å•ä¸ªå­åº”ç”¨æ‰¿è½½å¤šä¸ªä¸šåŠ¡ç»„ä»¶ï¼Œå‡å°‘èµ„æºæ¶ˆè€— |
| **çµæ´»é…ç½®** | é€šè¿‡è·¯ç”±é…ç½®è¡¨è½»æ¾æ·»åŠ æ–°çš„ç»„ä»¶æ˜ å°„ |
| **ç‹¬ç«‹å¼€å‘** | ä¸»åº”ç”¨å’Œå­åº”ç”¨å¯ä»¥ç‹¬ç«‹å¼€å‘å’Œéƒ¨ç½² |
| **æŠ€æœ¯å¤šæ ·æ€§** | æ”¯æŒä¸»åº”ç”¨ jQuery + å­åº”ç”¨ React çš„æŠ€æœ¯æ ˆç»„åˆ |
| **ç”¨æˆ·ä½“éªŒ** | SPA çº§åˆ«çš„åˆ‡æ¢ä½“éªŒï¼Œæ— é¡µé¢åˆ·æ–° |

---

## ğŸ”§ æ¸è¿›å¼å‡çº§è¯„ä¼°

### âœ… å®Œå…¨æ”¯æŒçš„åœºæ™¯

| åœºæ™¯ | æ”¯æŒåº¦ | è¯´æ˜ |
|------|--------|------|
| **æ–°åŠŸèƒ½é¡µé¢** | 100% | å…¨éƒ¨ä½¿ç”¨ React å¼€å‘ |
| **é¡µé¢çº§æ›¿æ¢** | 100% | é€æ­¥å°†è€é¡µé¢æ›¿æ¢ä¸º React é¡µé¢ |
| **APIçŠ¶æ€å…±äº«** | 100% | è€é¡¹ç›®æ¥å£ã€çŠ¶æ€å®Œå…¨å¯åœ¨å­åº”ç”¨ä¸­ä½¿ç”¨ |
| **SDKæ–¹æ³•è°ƒç”¨** | 100% | è€é¡¹ç›®å·¥å…·ç±»å’ŒSDKå¯åœ¨å­åº”ç”¨ä¸­è°ƒç”¨ |

### âš ï¸ éœ€è¦æ‰©å±•çš„åœºæ™¯

| åœºæ™¯ | å½“å‰çŠ¶æ€ | æ‰©å±•æ–¹æ¡ˆ |
|------|----------|----------|
| **ç»„ä»¶çº§åµŒå…¥** | éœ€è¦æ‰©å±• | æ‰©å±• RouteManager æ”¯æŒä»»æ„å®¹å™¨åŠ è½½ |
| **å¼¹çª—ç»„ä»¶** | éœ€è¦æ‰©å±• | å»ºç«‹å¼¹çª—ç»„ä»¶çš„åŠ è½½å’Œå¸è½½æœºåˆ¶ |
| **äº‹ä»¶é€šä¿¡** | éœ€è¦å®Œå–„ | å®Œå–„ä¸»å­åº”ç”¨çš„äº‹ä»¶é€šä¿¡æœºåˆ¶ |

---

## ğŸ’¡ æŠ€æœ¯æ€»ç»“

> **é¡¹ç›®æ ¸å¿ƒç‰¹ç‚¹**ï¼šjQuery ä¸»åº”ç”¨ + å•ä¸ª React å­åº”ç”¨çš„å¾®å‰ç«¯æ¶æ„ï¼Œé€šè¿‡ URL è·¯ç”±é©±åŠ¨çš„æ–¹å¼ï¼ŒåŠ¨æ€æ³¨å…¥ qiankun åŠ è½½å­åº”ç”¨ï¼Œå¹¶æ ¹æ®è·¯ç”±å‚æ•°åœ¨å­åº”ç”¨å†…éƒ¨åˆ‡æ¢ä¸åŒçš„ä¸šåŠ¡ç»„ä»¶ï¼Œå®ç°ç»†ç²’åº¦çš„å¾®å‰ç«¯ç®¡ç†ã€‚

å½“å‰è®¾è®¡å¯ä¿æŒå¾®å‰ç«¯çš„è§£è€¦ä¼˜åŠ¿ï¼Œä¹Ÿå¯é¿å…å¤šåº”ç”¨éƒ¨ç½²çš„å¤æ‚æ€§ï¼Œé€‚åˆå°å›¢é˜Ÿé¡¹ç›®ä½æˆæœ¬æ¸è¿›å¼å‡çº§ã€‚