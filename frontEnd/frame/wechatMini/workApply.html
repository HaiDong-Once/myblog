<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.48">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/images/person/header-logo.png"><script async src="https://www.googletagmanager.com/gtag/js?id=G-YTP6YEPL7J"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-YTP6YEPL7J', { send_page_view: false });</script><title>小程序开发案例汇总 | ddd`s blog</title><meta name="description" content="ddd`s的blog站点">
    <link rel="modulepreload" href="/myblog/assets/app.4c8b15c1.js"><link rel="modulepreload" href="/myblog/assets/workApply.html.3c3eba7d.js"><link rel="modulepreload" href="/myblog/assets/img_5.eb58b3d4.js"><link rel="modulepreload" href="/myblog/assets/workApply.html.de773b7a.js"><link rel="prefetch" href="/myblog/assets/index.html.4721d112.js"><link rel="prefetch" href="/myblog/assets/SSE.html.aae7241a.js"><link rel="prefetch" href="/myblog/assets/aiRead.html.862d54e2.js"><link rel="prefetch" href="/myblog/assets/gpt1.html.5ea5d05b.js"><link rel="prefetch" href="/myblog/assets/gpt2.html.31b11bc8.js"><link rel="prefetch" href="/myblog/assets/gpt3.html.22c1f689.js"><link rel="prefetch" href="/myblog/assets/gpt4.html.987be3ad.js"><link rel="prefetch" href="/myblog/assets/cursor-workflow1.html.e424edc5.js"><link rel="prefetch" href="/myblog/assets/cursor-workflow2.html.0a0636ef.js"><link rel="prefetch" href="/myblog/assets/cursor-workflow3.html.7031a41e.js"><link rel="prefetch" href="/myblog/assets/personalShare.html.13a052b5.js"><link rel="prefetch" href="/myblog/assets/share.html.c841794f.js"><link rel="prefetch" href="/myblog/assets/share_2.html.e31248cf.js"><link rel="prefetch" href="/myblog/assets/share_3.html.21a9d787.js"><link rel="prefetch" href="/myblog/assets/share_4.html.42151f13.js"><link rel="prefetch" href="/myblog/assets/share_5.html.75490bde.js"><link rel="prefetch" href="/myblog/assets/share_6.html.18d9e4bf.js"><link rel="prefetch" href="/myblog/assets/心学.html.965dafa7.js"><link rel="prefetch" href="/myblog/assets/道德经.html.81048dee.js"><link rel="prefetch" href="/myblog/assets/社会心理学.html.c83e72e1.js"><link rel="prefetch" href="/myblog/assets/逆商.html.2a1947db.js"><link rel="prefetch" href="/myblog/assets/阿德勒.html.62463965.js"><link rel="prefetch" href="/myblog/assets/bom.html.6377b95c.js"><link rel="prefetch" href="/myblog/assets/bomView.html.5641c8fc.js"><link rel="prefetch" href="/myblog/assets/postMessage.html.1e11cb28.js"><link rel="prefetch" href="/myblog/assets/requestAnimationFrame.html.4aff8cd0.js"><link rel="prefetch" href="/myblog/assets/css.html.3ff5ede4.js"><link rel="prefetch" href="/myblog/assets/css2.html.a68883e1.js"><link rel="prefetch" href="/myblog/assets/css3.html.b2a809c3.js"><link rel="prefetch" href="/myblog/assets/css4.html.544eeea9.js"><link rel="prefetch" href="/myblog/assets/css5.html.1d2a3625.js"><link rel="prefetch" href="/myblog/assets/css6.html.2a72355d.js"><link rel="prefetch" href="/myblog/assets/scss.html.861a334c.js"><link rel="prefetch" href="/myblog/assets/html.html.3867686a.js"><link rel="prefetch" href="/myblog/assets/js.html.7de2c71d.js"><link rel="prefetch" href="/myblog/assets/map.html.0dc52cfd.js"><link rel="prefetch" href="/myblog/assets/practice.html.56c2ba78.js"><link rel="prefetch" href="/myblog/assets/node.html.1da44a6e.js"><link rel="prefetch" href="/myblog/assets/notes.html.fb65a104.js"><link rel="prefetch" href="/myblog/assets/base.html.aed0c6a9.js"><link rel="prefetch" href="/myblog/assets/app.html.fe2879e8.js"><link rel="prefetch" href="/myblog/assets/harmony.html.c9b8375b.js"><link rel="prefetch" href="/myblog/assets/harmony2.html.515c81b4.js"><link rel="prefetch" href="/myblog/assets/fullpage.html.551ec5ad.js"><link rel="prefetch" href="/myblog/assets/hook.html.d39b56a7.js"><link rel="prefetch" href="/myblog/assets/nuxt1.html.e6783d49.js"><link rel="prefetch" href="/myblog/assets/nuxt2.html.0d375ff7.js"><link rel="prefetch" href="/myblog/assets/nuxt3.html.ff08c1b2.js"><link rel="prefetch" href="/myblog/assets/nuxt4.html.72c4cac1.js"><link rel="prefetch" href="/myblog/assets/nuxt5.html.60fc5f4f.js"><link rel="prefetch" href="/myblog/assets/notes.html.6c413f64.js"><link rel="prefetch" href="/myblog/assets/react.html.ee44a9c6.js"><link rel="prefetch" href="/myblog/assets/react2.html.45731a37.js"><link rel="prefetch" href="/myblog/assets/react3.html.b80ed68b.js"><link rel="prefetch" href="/myblog/assets/react4.html.497d8901.js"><link rel="prefetch" href="/myblog/assets/react5.html.e8779a4d.js"><link rel="prefetch" href="/myblog/assets/react6.html.26e7ecc9.js"><link rel="prefetch" href="/myblog/assets/react7.html.04e3710c.js"><link rel="prefetch" href="/myblog/assets/react8.html.2718fb26.js"><link rel="prefetch" href="/myblog/assets/uniapp1.html.97d38e55.js"><link rel="prefetch" href="/myblog/assets/uniapp2.html.29cd9cb8.js"><link rel="prefetch" href="/myblog/assets/uniapp3.html.e26ec1dd.js"><link rel="prefetch" href="/myblog/assets/uniapp4.html.df1b1754.js"><link rel="prefetch" href="/myblog/assets/workApply1.html.39bf4400.js"><link rel="prefetch" href="/myblog/assets/workApply10.html.0bd0fe92.js"><link rel="prefetch" href="/myblog/assets/workApply11.html.f8cd42ac.js"><link rel="prefetch" href="/myblog/assets/workApply12.html.4aec0709.js"><link rel="prefetch" href="/myblog/assets/workApply13.html.12f8ae22.js"><link rel="prefetch" href="/myblog/assets/workApply14.html.dbae42ba.js"><link rel="prefetch" href="/myblog/assets/workApply15.html.de67ea67.js"><link rel="prefetch" href="/myblog/assets/workApply16.html.90cdb2ca.js"><link rel="prefetch" href="/myblog/assets/workApply17.html.1ed283c9.js"><link rel="prefetch" href="/myblog/assets/workApply18.html.5d306c13.js"><link rel="prefetch" href="/myblog/assets/workApply19.html.e4a233e8.js"><link rel="prefetch" href="/myblog/assets/workApply2.html.6aaf904f.js"><link rel="prefetch" href="/myblog/assets/workApply20.html.7435b15d.js"><link rel="prefetch" href="/myblog/assets/workApply21.html.f793910c.js"><link rel="prefetch" href="/myblog/assets/workApply22.html.a6d1f42f.js"><link rel="prefetch" href="/myblog/assets/workApply23.html.23bccbba.js"><link rel="prefetch" href="/myblog/assets/workApply24.html.b9f32b5a.js"><link rel="prefetch" href="/myblog/assets/workApply25.html.bafe0d73.js"><link rel="prefetch" href="/myblog/assets/workApply26.html.6bc24dca.js"><link rel="prefetch" href="/myblog/assets/workApply27.html.b4148efc.js"><link rel="prefetch" href="/myblog/assets/workApply28.html.cbc936be.js"><link rel="prefetch" href="/myblog/assets/workApply3.html.5ee26992.js"><link rel="prefetch" href="/myblog/assets/workApply4.html.955edb34.js"><link rel="prefetch" href="/myblog/assets/workApply5.html.9c1ecdaf.js"><link rel="prefetch" href="/myblog/assets/workApply6.html.bb9ad99e.js"><link rel="prefetch" href="/myblog/assets/workApply7.html.2205b8b6.js"><link rel="prefetch" href="/myblog/assets/workApply8.html.6dab6a94.js"><link rel="prefetch" href="/myblog/assets/workApply9.html.8b2b0886.js"><link rel="prefetch" href="/myblog/assets/ciWechatMini.html.e9e0acbe.js"><link rel="prefetch" href="/myblog/assets/webviewBridge.html.1266750d.js"><link rel="prefetch" href="/myblog/assets/hotUpdate.html.6abb7a2d.js"><link rel="prefetch" href="/myblog/assets/loseCode.html.9a32c411.js"><link rel="prefetch" href="/myblog/assets/loseRely.html.4ca293a4.js"><link rel="prefetch" href="/myblog/assets/pay.html.5c3f217f.js"><link rel="prefetch" href="/myblog/assets/image.html.4b3439b6.js"><link rel="prefetch" href="/myblog/assets/wechat.html.7b0fb96d.js"><link rel="prefetch" href="/myblog/assets/chatWebview.html.a986dd97.js"><link rel="prefetch" href="/myblog/assets/code1.html.df2d96c0.js"><link rel="prefetch" href="/myblog/assets/code2.html.44b62711.js"><link rel="prefetch" href="/myblog/assets/code3.html.82bc5453.js"><link rel="prefetch" href="/myblog/assets/monitor.html.d4b3cc1a.js"><link rel="prefetch" href="/myblog/assets/monitorSDK.html.0cf6d1e9.js"><link rel="prefetch" href="/myblog/assets/codeReuse.html.72bd8f85.js"><link rel="prefetch" href="/myblog/assets/git.html.bf32a6f2.js"><link rel="prefetch" href="/myblog/assets/qiankun1.html.9dd2d97e.js"><link rel="prefetch" href="/myblog/assets/qiankun2.html.8d068ff8.js"><link rel="prefetch" href="/myblog/assets/qiankun3.html.af5c2ad7.js"><link rel="prefetch" href="/myblog/assets/qiankun4.html.b1220b49.js"><link rel="prefetch" href="/myblog/assets/qiankun5.html.4aac0af4.js"><link rel="prefetch" href="/myblog/assets/package.html.89bb4c30.js"><link rel="prefetch" href="/myblog/assets/package1.html.a389173c.js"><link rel="prefetch" href="/myblog/assets/package2.html.e71c32a7.js"><link rel="prefetch" href="/myblog/assets/codeStandard.html.c4233831.js"><link rel="prefetch" href="/myblog/assets/codeStandard2.html.905e670f.js"><link rel="prefetch" href="/myblog/assets/test.html.87993038.js"><link rel="prefetch" href="/myblog/assets/Webpack5.html.c5462a20.js"><link rel="prefetch" href="/myblog/assets/vuepress.html.d99f3134.js"><link rel="prefetch" href="/myblog/assets/code1.html.cad69ae5.js"><link rel="prefetch" href="/myblog/assets/monitor.html.059ef06b.js"><link rel="prefetch" href="/myblog/assets/monitorSDK.html.b3d7a543.js"><link rel="prefetch" href="/myblog/assets/toolFun.html.de0f1fb8.js"><link rel="prefetch" href="/myblog/assets/macTool.html.943fc137.js"><link rel="prefetch" href="/myblog/assets/tool.html.949ab96c.js"><link rel="prefetch" href="/myblog/assets/vercel.html.6dbab05d.js"><link rel="prefetch" href="/myblog/assets/compositionApi.html.7c160aa4.js"><link rel="prefetch" href="/myblog/assets/vue2-7.html.41bc90b2.js"><link rel="prefetch" href="/myblog/assets/npmPrams.html.d8b19a85.js"><link rel="prefetch" href="/myblog/assets/pxtoviewport.html.3f6ba50c.js"><link rel="prefetch" href="/myblog/assets/webpackCase.html.b0cf4026.js"><link rel="prefetch" href="/myblog/assets/404.html.265028f6.js"><link rel="prefetch" href="/myblog/assets/index.html.ebb35400.js"><link rel="prefetch" href="/myblog/assets/SSE.html.8160cf30.js"><link rel="prefetch" href="/myblog/assets/aiRead.html.e298a7b9.js"><link rel="prefetch" href="/myblog/assets/gpt1.html.f3ade5e3.js"><link rel="prefetch" href="/myblog/assets/gpt2.html.43c00908.js"><link rel="prefetch" href="/myblog/assets/gpt3.html.cabf288b.js"><link rel="prefetch" href="/myblog/assets/gpt4.html.4396c718.js"><link rel="prefetch" href="/myblog/assets/cursor-workflow1.html.476c14df.js"><link rel="prefetch" href="/myblog/assets/cursor-workflow2.html.b63506d7.js"><link rel="prefetch" href="/myblog/assets/cursor-workflow3.html.696a364c.js"><link rel="prefetch" href="/myblog/assets/personalShare.html.b87a429e.js"><link rel="prefetch" href="/myblog/assets/share.html.13c73e47.js"><link rel="prefetch" href="/myblog/assets/share_2.html.08b12443.js"><link rel="prefetch" href="/myblog/assets/share_3.html.19a5c1dd.js"><link rel="prefetch" href="/myblog/assets/share_4.html.a7001255.js"><link rel="prefetch" href="/myblog/assets/share_5.html.6e9efa9b.js"><link rel="prefetch" href="/myblog/assets/share_6.html.e6dafc5e.js"><link rel="prefetch" href="/myblog/assets/心学.html.fff85f71.js"><link rel="prefetch" href="/myblog/assets/道德经.html.6a66223a.js"><link rel="prefetch" href="/myblog/assets/社会心理学.html.25b20d79.js"><link rel="prefetch" href="/myblog/assets/逆商.html.891d7f26.js"><link rel="prefetch" href="/myblog/assets/阿德勒.html.4ba466b3.js"><link rel="prefetch" href="/myblog/assets/bom.html.71d6142c.js"><link rel="prefetch" href="/myblog/assets/bomView.html.3e7e5aec.js"><link rel="prefetch" href="/myblog/assets/postMessage.html.1bb00862.js"><link rel="prefetch" href="/myblog/assets/requestAnimationFrame.html.d3feb3a4.js"><link rel="prefetch" href="/myblog/assets/css.html.f2e943de.js"><link rel="prefetch" href="/myblog/assets/css2.html.1514fccf.js"><link rel="prefetch" href="/myblog/assets/css3.html.1bc1b995.js"><link rel="prefetch" href="/myblog/assets/css4.html.89645d40.js"><link rel="prefetch" href="/myblog/assets/css5.html.68536f2b.js"><link rel="prefetch" href="/myblog/assets/css6.html.281d8ee7.js"><link rel="prefetch" href="/myblog/assets/scss.html.8f5b2855.js"><link rel="prefetch" href="/myblog/assets/html.html.16d87a02.js"><link rel="prefetch" href="/myblog/assets/js.html.60f98f80.js"><link rel="prefetch" href="/myblog/assets/map.html.6410fba4.js"><link rel="prefetch" href="/myblog/assets/practice.html.b21d48ed.js"><link rel="prefetch" href="/myblog/assets/node.html.802c9a09.js"><link rel="prefetch" href="/myblog/assets/notes.html.cf7d2a82.js"><link rel="prefetch" href="/myblog/assets/base.html.fe26b3b6.js"><link rel="prefetch" href="/myblog/assets/app.html.a7a9e4e5.js"><link rel="prefetch" href="/myblog/assets/harmony.html.a0153804.js"><link rel="prefetch" href="/myblog/assets/harmony2.html.6a8339cc.js"><link rel="prefetch" href="/myblog/assets/fullpage.html.fc3782ee.js"><link rel="prefetch" href="/myblog/assets/hook.html.5e02b155.js"><link rel="prefetch" href="/myblog/assets/nuxt1.html.d9c2db10.js"><link rel="prefetch" href="/myblog/assets/nuxt2.html.16d84764.js"><link rel="prefetch" href="/myblog/assets/nuxt3.html.f8832778.js"><link rel="prefetch" href="/myblog/assets/nuxt4.html.12fe634b.js"><link rel="prefetch" href="/myblog/assets/nuxt5.html.31c19cb1.js"><link rel="prefetch" href="/myblog/assets/notes.html.d76778b8.js"><link rel="prefetch" href="/myblog/assets/react.html.07243292.js"><link rel="prefetch" href="/myblog/assets/react2.html.b4cac7da.js"><link rel="prefetch" href="/myblog/assets/react3.html.0f2bc779.js"><link rel="prefetch" href="/myblog/assets/react4.html.6ccf961c.js"><link rel="prefetch" href="/myblog/assets/react5.html.8d91cc6a.js"><link rel="prefetch" href="/myblog/assets/react6.html.f02d8c43.js"><link rel="prefetch" href="/myblog/assets/react7.html.176f5012.js"><link rel="prefetch" href="/myblog/assets/react8.html.ce4cdd8c.js"><link rel="prefetch" href="/myblog/assets/uniapp1.html.82cfda57.js"><link rel="prefetch" href="/myblog/assets/uniapp2.html.0c9fe204.js"><link rel="prefetch" href="/myblog/assets/uniapp3.html.1671e0d2.js"><link rel="prefetch" href="/myblog/assets/uniapp4.html.76a6ee5f.js"><link rel="prefetch" href="/myblog/assets/workApply1.html.d3127409.js"><link rel="prefetch" href="/myblog/assets/workApply10.html.2dc23a78.js"><link rel="prefetch" href="/myblog/assets/workApply11.html.b04c5ff0.js"><link rel="prefetch" href="/myblog/assets/workApply12.html.dd0be2f3.js"><link rel="prefetch" href="/myblog/assets/workApply13.html.d565b6e7.js"><link rel="prefetch" href="/myblog/assets/workApply14.html.0a79a35c.js"><link rel="prefetch" href="/myblog/assets/workApply15.html.b63b6b2b.js"><link rel="prefetch" href="/myblog/assets/workApply16.html.3ef062c0.js"><link rel="prefetch" href="/myblog/assets/workApply17.html.3d988977.js"><link rel="prefetch" href="/myblog/assets/workApply18.html.61b7200d.js"><link rel="prefetch" href="/myblog/assets/workApply19.html.42af87b1.js"><link rel="prefetch" href="/myblog/assets/workApply2.html.c0f174a6.js"><link rel="prefetch" href="/myblog/assets/workApply20.html.78ac0acb.js"><link rel="prefetch" href="/myblog/assets/workApply21.html.6c7c6a8b.js"><link rel="prefetch" href="/myblog/assets/workApply22.html.19856fb8.js"><link rel="prefetch" href="/myblog/assets/workApply23.html.fe28f195.js"><link rel="prefetch" href="/myblog/assets/workApply24.html.c1becf1b.js"><link rel="prefetch" href="/myblog/assets/workApply25.html.05ede3bf.js"><link rel="prefetch" href="/myblog/assets/workApply26.html.0a5439e1.js"><link rel="prefetch" href="/myblog/assets/workApply27.html.47fbc9b7.js"><link rel="prefetch" href="/myblog/assets/workApply28.html.f1447876.js"><link rel="prefetch" href="/myblog/assets/workApply3.html.2b321d2a.js"><link rel="prefetch" href="/myblog/assets/workApply4.html.4b5020e2.js"><link rel="prefetch" href="/myblog/assets/workApply5.html.c9337ec3.js"><link rel="prefetch" href="/myblog/assets/workApply6.html.de876edf.js"><link rel="prefetch" href="/myblog/assets/workApply7.html.4bd17166.js"><link rel="prefetch" href="/myblog/assets/workApply8.html.eaf2ab8c.js"><link rel="prefetch" href="/myblog/assets/workApply9.html.43bdce9d.js"><link rel="prefetch" href="/myblog/assets/ciWechatMini.html.270c10f3.js"><link rel="prefetch" href="/myblog/assets/webviewBridge.html.fdd5c2c6.js"><link rel="prefetch" href="/myblog/assets/hotUpdate.html.d634a1f2.js"><link rel="prefetch" href="/myblog/assets/loseCode.html.8b4a7223.js"><link rel="prefetch" href="/myblog/assets/loseRely.html.293ec6ee.js"><link rel="prefetch" href="/myblog/assets/pay.html.06ae4d7a.js"><link rel="prefetch" href="/myblog/assets/image.html.d15f2a96.js"><link rel="prefetch" href="/myblog/assets/wechat.html.6a241efd.js"><link rel="prefetch" href="/myblog/assets/chatWebview.html.b380a3b6.js"><link rel="prefetch" href="/myblog/assets/code1.html.544b6c18.js"><link rel="prefetch" href="/myblog/assets/code2.html.58a7b834.js"><link rel="prefetch" href="/myblog/assets/code3.html.f313f971.js"><link rel="prefetch" href="/myblog/assets/monitor.html.044a1435.js"><link rel="prefetch" href="/myblog/assets/monitorSDK.html.3d345312.js"><link rel="prefetch" href="/myblog/assets/codeReuse.html.06ef5798.js"><link rel="prefetch" href="/myblog/assets/git.html.3802da2a.js"><link rel="prefetch" href="/myblog/assets/qiankun1.html.af1b6546.js"><link rel="prefetch" href="/myblog/assets/qiankun2.html.9876b69b.js"><link rel="prefetch" href="/myblog/assets/qiankun3.html.f0795b1d.js"><link rel="prefetch" href="/myblog/assets/qiankun4.html.1db48106.js"><link rel="prefetch" href="/myblog/assets/qiankun5.html.c03bb67c.js"><link rel="prefetch" href="/myblog/assets/package.html.37d7dd24.js"><link rel="prefetch" href="/myblog/assets/package1.html.239bee37.js"><link rel="prefetch" href="/myblog/assets/package2.html.4f8c9247.js"><link rel="prefetch" href="/myblog/assets/codeStandard.html.bde7378f.js"><link rel="prefetch" href="/myblog/assets/codeStandard2.html.2a7c3253.js"><link rel="prefetch" href="/myblog/assets/test.html.7c4e24d6.js"><link rel="prefetch" href="/myblog/assets/Webpack5.html.5a63951a.js"><link rel="prefetch" href="/myblog/assets/vuepress.html.79fc2fb0.js"><link rel="prefetch" href="/myblog/assets/code1.html.d9387ef7.js"><link rel="prefetch" href="/myblog/assets/monitor.html.16e00508.js"><link rel="prefetch" href="/myblog/assets/monitorSDK.html.a143d5ad.js"><link rel="prefetch" href="/myblog/assets/toolFun.html.424b712d.js"><link rel="prefetch" href="/myblog/assets/macTool.html.14ead1d6.js"><link rel="prefetch" href="/myblog/assets/tool.html.29538057.js"><link rel="prefetch" href="/myblog/assets/vercel.html.925c9561.js"><link rel="prefetch" href="/myblog/assets/compositionApi.html.ff7808b7.js"><link rel="prefetch" href="/myblog/assets/vue2-7.html.270a2bd6.js"><link rel="prefetch" href="/myblog/assets/npmPrams.html.3ae0903b.js"><link rel="prefetch" href="/myblog/assets/pxtoviewport.html.1f8175e2.js"><link rel="prefetch" href="/myblog/assets/webpackCase.html.26d56e03.js"><link rel="prefetch" href="/myblog/assets/404.html.ec34f3e3.js"><link rel="prefetch" href="/myblog/assets/404.2d9fc1e0.js"><link rel="prefetch" href="/myblog/assets/Layout.caa6d458.js">
    <link rel="stylesheet" href="/myblog/assets/style.1b4c1786.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/myblog/" class=""><img class="logo" src="/myblog/images/person/header-logo.png" alt="ddd`s blog"><span class="site-name can-hide">ddd`s blog</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="前端基础"><span class="title">前端基础</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="前端基础"><span class="title">前端基础</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/base/css/scss.md" class="" aria-label="css"><!--[--><!--]--> css <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/base/javaScript/js.md" class="" aria-label="javaScript"><!--[--><!--]--> javaScript <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/base/typeScript/notes.md" class="" aria-label="typeScript"><!--[--><!--]--> typeScript <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/base/nodejs/node.md" class="" aria-label="nodejs"><!--[--><!--]--> nodejs <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/base/browser/bom.md" class="" aria-label="浏览器"><!--[--><!--]--> 浏览器 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="前端框架"><span class="title">前端框架</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="前端框架"><span class="title">前端框架</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/frame/vue/workApply1.md" class="" aria-label="vue"><!--[--><!--]--> vue <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/frame/wechatMini/ciWechatMini.md" class="" aria-label="小程序"><!--[--><!--]--> 小程序 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/frame/react/react.md" class="" aria-label="react"><!--[--><!--]--> react <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/frame/app/app.md" class="" aria-label="app"><!--[--><!--]--> app <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/frame/nuxt/nuxt1.md" class="" aria-label="nuxt"><!--[--><!--]--> nuxt <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/frame/uniapp/uniapp1.md" class="" aria-label="uniapp"><!--[--><!--]--> uniapp <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/frame/harmony/harmony.md" class="" aria-label="鸿蒙开发"><!--[--><!--]--> 鸿蒙开发 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="前端工程化"><span class="title">前端工程化</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="前端工程化"><span class="title">前端工程化</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/project/SDK/monitor.md" class="" aria-label="前端方案实现"><!--[--><!--]--> 前端方案实现 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/project/microFrontend/qiankun1.md" class="" aria-label="微前端"><!--[--><!--]--> 微前端 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/project/git/git.md" class="" aria-label="git相关"><!--[--><!--]--> git相关 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/project/webpack/Webpack5.md" class="" aria-label="Webpack5"><!--[--><!--]--> Webpack5 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/project/standard/codeStandard2.md" class="" aria-label="代码规范"><!--[--><!--]--> 代码规范 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/project/test/test.md" class="" aria-label="前端测试"><!--[--><!--]--> 前端测试 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/project/codeReuse/codeReuse.md" class="" aria-label="代码逻辑复用"><!--[--><!--]--> 代码逻辑复用 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/project/package/package.md" class="" aria-label="包管理工具"><!--[--><!--]--> 包管理工具 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="AI应用"><span class="title">AI应用</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="AI应用"><span class="title">AI应用</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/myblog/AI/cursor/cursor-workflow1.md" class="" aria-label="Cursor"><!--[--><!--]--> Cursor <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/AI/apply/gpt1.md" class="" aria-label="AI应用"><!--[--><!--]--> AI应用 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="性能优化"><span class="title">性能优化</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="性能优化"><span class="title">性能优化</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/performance/wechat/wechat.md" class="" aria-label="小程序优化"><!--[--><!--]--> 小程序优化 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/performance/application/loseCode.md" class="" aria-label="性能优化实践"><!--[--><!--]--> 性能优化实践 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/performance/image/image.md" class="" aria-label="图片优化"><!--[--><!--]--> 图片优化 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="工具库"><span class="title">工具库</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="工具库"><span class="title">工具库</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/tools/blog/vuepress.md" class="" aria-label="博客搭建"><!--[--><!--]--> 博客搭建 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/tools/tool/tool.md" class="" aria-label="开发工具"><!--[--><!--]--> 开发工具 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/tools/code/toolFun.md" class="" aria-label="代码库"><!--[--><!--]--> 代码库 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="计算机基础"><span class="title">计算机基础</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="计算机基础"><span class="title">计算机基础</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/computer/structure/base.md" class="" aria-label="数据结构与算法"><!--[--><!--]--> 数据结构与算法 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="摄影艺术"><span class="title">摄影艺术</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="摄影艺术"><span class="title">摄影艺术</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/myblog/art/photo/personalShare.md" class="" aria-label="摄影分享"><!--[--><!--]--> 摄影分享 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="读书笔记"><span class="title">读书笔记</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="读书笔记"><span class="title">读书笔记</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/myblog/reader/classical/道德经.md" class="" aria-label="古典文学"><!--[--><!--]--> 古典文学 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/reader/psychology/阿德勒.md" class="" aria-label="心理学"><!--[--><!--]--> 心理学 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="其他"><span class="title">其他</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="其他"><span class="title">其他</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/myblog/other/share/share_4.md" class="" aria-label="前端分享"><!--[--><!--]--> 前端分享 <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="前端基础"><span class="title">前端基础</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="前端基础"><span class="title">前端基础</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/base/css/scss.md" class="" aria-label="css"><!--[--><!--]--> css <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/base/javaScript/js.md" class="" aria-label="javaScript"><!--[--><!--]--> javaScript <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/base/typeScript/notes.md" class="" aria-label="typeScript"><!--[--><!--]--> typeScript <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/base/nodejs/node.md" class="" aria-label="nodejs"><!--[--><!--]--> nodejs <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/base/browser/bom.md" class="" aria-label="浏览器"><!--[--><!--]--> 浏览器 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="前端框架"><span class="title">前端框架</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="前端框架"><span class="title">前端框架</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/frame/vue/workApply1.md" class="" aria-label="vue"><!--[--><!--]--> vue <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/frame/wechatMini/ciWechatMini.md" class="" aria-label="小程序"><!--[--><!--]--> 小程序 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/frame/react/react.md" class="" aria-label="react"><!--[--><!--]--> react <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/frame/app/app.md" class="" aria-label="app"><!--[--><!--]--> app <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/frame/nuxt/nuxt1.md" class="" aria-label="nuxt"><!--[--><!--]--> nuxt <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/frame/uniapp/uniapp1.md" class="" aria-label="uniapp"><!--[--><!--]--> uniapp <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/frame/harmony/harmony.md" class="" aria-label="鸿蒙开发"><!--[--><!--]--> 鸿蒙开发 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="前端工程化"><span class="title">前端工程化</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="前端工程化"><span class="title">前端工程化</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/project/SDK/monitor.md" class="" aria-label="前端方案实现"><!--[--><!--]--> 前端方案实现 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/project/microFrontend/qiankun1.md" class="" aria-label="微前端"><!--[--><!--]--> 微前端 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/project/git/git.md" class="" aria-label="git相关"><!--[--><!--]--> git相关 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/project/webpack/Webpack5.md" class="" aria-label="Webpack5"><!--[--><!--]--> Webpack5 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/project/standard/codeStandard2.md" class="" aria-label="代码规范"><!--[--><!--]--> 代码规范 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/project/test/test.md" class="" aria-label="前端测试"><!--[--><!--]--> 前端测试 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/project/codeReuse/codeReuse.md" class="" aria-label="代码逻辑复用"><!--[--><!--]--> 代码逻辑复用 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/project/package/package.md" class="" aria-label="包管理工具"><!--[--><!--]--> 包管理工具 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="AI应用"><span class="title">AI应用</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="AI应用"><span class="title">AI应用</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/myblog/AI/cursor/cursor-workflow1.md" class="" aria-label="Cursor"><!--[--><!--]--> Cursor <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/AI/apply/gpt1.md" class="" aria-label="AI应用"><!--[--><!--]--> AI应用 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="性能优化"><span class="title">性能优化</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="性能优化"><span class="title">性能优化</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/performance/wechat/wechat.md" class="" aria-label="小程序优化"><!--[--><!--]--> 小程序优化 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/performance/application/loseCode.md" class="" aria-label="性能优化实践"><!--[--><!--]--> 性能优化实践 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/performance/image/image.md" class="" aria-label="图片优化"><!--[--><!--]--> 图片优化 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="工具库"><span class="title">工具库</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="工具库"><span class="title">工具库</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/tools/blog/vuepress.md" class="" aria-label="博客搭建"><!--[--><!--]--> 博客搭建 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/tools/tool/tool.md" class="" aria-label="开发工具"><!--[--><!--]--> 开发工具 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/tools/code/toolFun.md" class="" aria-label="代码库"><!--[--><!--]--> 代码库 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="计算机基础"><span class="title">计算机基础</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="计算机基础"><span class="title">计算机基础</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/myblog/frontEnd/computer/structure/base.md" class="" aria-label="数据结构与算法"><!--[--><!--]--> 数据结构与算法 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="摄影艺术"><span class="title">摄影艺术</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="摄影艺术"><span class="title">摄影艺术</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/myblog/art/photo/personalShare.md" class="" aria-label="摄影分享"><!--[--><!--]--> 摄影分享 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="读书笔记"><span class="title">读书笔记</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="读书笔记"><span class="title">读书笔记</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/myblog/reader/classical/道德经.md" class="" aria-label="古典文学"><!--[--><!--]--> 古典文学 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/myblog/reader/psychology/阿德勒.md" class="" aria-label="心理学"><!--[--><!--]--> 心理学 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="其他"><span class="title">其他</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="其他"><span class="title">其他</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/myblog/other/share/share_4.md" class="" aria-label="前端分享"><!--[--><!--]--> 前端分享 <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">小程序应用实例 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/myblog/frontEnd/frame/wechatMini/ciWechatMini.html" class="sidebar-item" aria-label="微信小程序ci发布"><!--[--><!--]--> 微信小程序ci发布 <!--[--><!--]--></a><!----></li><li><a href="/myblog/frontEnd/frame/wechatMini/webviewBridge.html" class="sidebar-item" aria-label="WebView Bridge 跨平台方案：统一 API 实现多端小程序通信"><!--[--><!--]--> WebView Bridge 跨平台方案：统一 API 实现多端小程序通信 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="小程序开发案例汇总"><!--[--><!--]--> 小程序开发案例汇总 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序公共弹窗组件封装" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序公共弹窗组件封装"><!--[--><!--]--> 小程序公共弹窗组件封装 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#代码实现" class="router-link-active router-link-exact-active sidebar-item" aria-label="代码实现"><!--[--><!--]--> 代码实现 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#使用方法" class="router-link-active router-link-exact-active sidebar-item" aria-label="使用方法"><!--[--><!--]--> 使用方法 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序map地图显示组件使用案例" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序map地图显示组件使用案例"><!--[--><!--]--> 小程序map地图显示组件使用案例 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序使用腾讯地图选点组件" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序使用腾讯地图选点组件"><!--[--><!--]--> 小程序使用腾讯地图选点组件 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#代码实现-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="代码实现"><!--[--><!--]--> 代码实现 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序登录状态管理-原生" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序登录状态管理（原生）"><!--[--><!--]--> 小程序登录状态管理（原生） <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#管家小程序登录流程分析" class="router-link-active router-link-exact-active sidebar-item" aria-label="管家小程序登录流程分析"><!--[--><!--]--> 管家小程序登录流程分析 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#解决方案" class="router-link-active router-link-exact-active sidebar-item" aria-label="解决方案"><!--[--><!--]--> 解决方案 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序本地缓存二次封装-过期-续期-获取全部" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序本地缓存二次封装（过期，续期，获取全部）"><!--[--><!--]--> 小程序本地缓存二次封装（过期，续期，获取全部） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序页面栈" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序页面栈"><!--[--><!--]--> 小程序页面栈 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#解决小程序返回按钮和物理返回跳转指定页面" class="router-link-active router-link-exact-active sidebar-item" aria-label="解决小程序返回按钮和物理返回跳转指定页面"><!--[--><!--]--> 解决小程序返回按钮和物理返回跳转指定页面 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#中转页方案-中转页——目标页" class="router-link-active router-link-exact-active sidebar-item" aria-label="中转页方案（中转页——目标页）"><!--[--><!--]--> 中转页方案（中转页——目标页） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#页面栈详情" class="router-link-active router-link-exact-active sidebar-item" aria-label="页面栈详情"><!--[--><!--]--> 页面栈详情 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序性能优化" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序性能优化"><!--[--><!--]--> 小程序性能优化 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#图片优化" class="router-link-active router-link-exact-active sidebar-item" aria-label="图片优化"><!--[--><!--]--> 图片优化 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#未使用依赖清除" class="router-link-active router-link-exact-active sidebar-item" aria-label="未使用依赖清除"><!--[--><!--]--> 未使用依赖清除 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#减重后数据统计" class="router-link-active router-link-exact-active sidebar-item" aria-label="减重后数据统计"><!--[--><!--]--> 减重后数据统计 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#打开小程序按需注入" class="router-link-active router-link-exact-active sidebar-item" aria-label="打开小程序按需注入"><!--[--><!--]--> 打开小程序按需注入 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#使用分包加载" class="router-link-active router-link-exact-active sidebar-item" aria-label="使用分包加载"><!--[--><!--]--> 使用分包加载 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#数据预拉取" class="router-link-active router-link-exact-active sidebar-item" aria-label="数据预拉取"><!--[--><!--]--> 数据预拉取 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#数据持久化-全局数据和缓存的合理利用" class="router-link-active router-link-exact-active sidebar-item" aria-label="数据持久化：全局数据和缓存的合理利用"><!--[--><!--]--> 数据持久化：全局数据和缓存的合理利用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序状态管理" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序状态管理"><!--[--><!--]--> 小程序状态管理 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序体验优化" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序体验优化"><!--[--><!--]--> 小程序体验优化 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序canvas实现多边形雷达图-蜘蛛图" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序canvas实现多边形雷达图，蜘蛛图"><!--[--><!--]--> 小程序canvas实现多边形雷达图，蜘蛛图 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#接口数据缓存方案" class="router-link-active router-link-exact-active sidebar-item" aria-label="接口数据缓存方案"><!--[--><!--]--> 接口数据缓存方案 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#data数据缓存" class="router-link-active router-link-exact-active sidebar-item" aria-label="data数据缓存"><!--[--><!--]--> data数据缓存 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#接口缓存promise方案" class="router-link-active router-link-exact-active sidebar-item" aria-label="接口缓存promise方案"><!--[--><!--]--> 接口缓存promise方案 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序工具函数封装" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序工具函数封装"><!--[--><!--]--> 小程序工具函数封装 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#全局loading解决方案" class="router-link-active router-link-exact-active sidebar-item" aria-label="全局loading解决方案"><!--[--><!--]--> 全局loading解决方案 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#扫码进入小程序参数解析" class="router-link-active router-link-exact-active sidebar-item" aria-label="扫码进入小程序参数解析"><!--[--><!--]--> 扫码进入小程序参数解析 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序input双向绑定" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序input双向绑定"><!--[--><!--]--> 小程序input双向绑定 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#全表单双向绑定" class="router-link-active router-link-exact-active sidebar-item" aria-label="全表单双向绑定"><!--[--><!--]--> 全表单双向绑定 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序switchtab跳转传参和刷新页面解决方案" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序switchTab跳转传参和刷新页面解决方案"><!--[--><!--]--> 小程序switchTab跳转传参和刷新页面解决方案 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#使用wx-relaunch" class="router-link-active router-link-exact-active sidebar-item" aria-label="使用wx.reLaunch"><!--[--><!--]--> 使用wx.reLaunch <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#调用页面栈刷新页面" class="router-link-active router-link-exact-active sidebar-item" aria-label="调用页面栈刷新页面"><!--[--><!--]--> 调用页面栈刷新页面 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#使用全局变量和缓存" class="router-link-active router-link-exact-active sidebar-item" aria-label="使用全局变量和缓存"><!--[--><!--]--> 使用全局变量和缓存 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#伪元素放大点击区域" class="router-link-active router-link-exact-active sidebar-item" aria-label="伪元素放大点击区域"><!--[--><!--]--> 伪元素放大点击区域 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序规避审核方法" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序规避审核方法"><!--[--><!--]--> 小程序规避审核方法 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#问题分析" class="router-link-active router-link-exact-active sidebar-item" aria-label="问题分析"><!--[--><!--]--> 问题分析 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#审核机制" class="router-link-active router-link-exact-active sidebar-item" aria-label="审核机制"><!--[--><!--]--> 审核机制 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#方法总结" class="router-link-active router-link-exact-active sidebar-item" aria-label="方法总结"><!--[--><!--]--> 方法总结 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#解决方案-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="解决方案"><!--[--><!--]--> 解决方案 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序echart图表使用" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序echart图表使用"><!--[--><!--]--> 小程序echart图表使用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序内跳转其他小程序" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序内跳转其他小程序"><!--[--><!--]--> 小程序内跳转其他小程序 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#navigatetominiprogram-api跳转" class="router-link-active router-link-exact-active sidebar-item" aria-label="navigateToMiniProgram api跳转"><!--[--><!--]--> navigateToMiniProgram api跳转 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#navigator标签跳转" class="router-link-active router-link-exact-active sidebar-item" aria-label="navigator标签跳转"><!--[--><!--]--> navigator标签跳转 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#注意事项" class="router-link-active router-link-exact-active sidebar-item" aria-label="注意事项"><!--[--><!--]--> 注意事项 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序图片上传" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序图片上传"><!--[--><!--]--> 小程序图片上传 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#wux-uploader组件" class="router-link-active router-link-exact-active sidebar-item" aria-label="wux-uploader组件"><!--[--><!--]--> wux-uploader组件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#微信uploader组件" class="router-link-active router-link-exact-active sidebar-item" aria-label="微信uploader组件"><!--[--><!--]--> 微信uploader组件 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序分享方案" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序分享方案"><!--[--><!--]--> 小程序分享方案 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#button组件方案" class="router-link-active router-link-exact-active sidebar-item" aria-label="button组件方案"><!--[--><!--]--> button组件方案 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#回调函数方案" class="router-link-active router-link-exact-active sidebar-item" aria-label="回调函数方案"><!--[--><!--]--> 回调函数方案 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#分享动态图片" class="router-link-active router-link-exact-active sidebar-item" aria-label="分享动态图片"><!--[--><!--]--> 分享动态图片 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序数据监听封装-watch" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序数据监听封装 watch"><!--[--><!--]--> 小程序数据监听封装 watch <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#监听基本数据类型" class="router-link-active router-link-exact-active sidebar-item" aria-label="监听基本数据类型"><!--[--><!--]--> 监听基本数据类型 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#复杂类型监听" class="router-link-active router-link-exact-active sidebar-item" aria-label="复杂类型监听"><!--[--><!--]--> 复杂类型监听 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序返回上一页传参" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序返回上一页传参"><!--[--><!--]--> 小程序返回上一页传参 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#进度球波浪动画组件" class="router-link-active router-link-exact-active sidebar-item" aria-label="进度球波浪动画组件"><!--[--><!--]--> 进度球波浪动画组件 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#canvas动画组" class="router-link-active router-link-exact-active sidebar-item" aria-label="canvas动画组"><!--[--><!--]--> canvas动画组 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#静态组件" class="router-link-active router-link-exact-active sidebar-item" aria-label="静态组件"><!--[--><!--]--> 静态组件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#svg版本-小程序不支持" class="router-link-active router-link-exact-active sidebar-item" aria-label="svg版本(小程序不支持)"><!--[--><!--]--> svg版本(小程序不支持) <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序消息订阅" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序消息订阅"><!--[--><!--]--> 小程序消息订阅 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序弹窗淡入淡出" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序弹窗淡入淡出"><!--[--><!--]--> 小程序弹窗淡入淡出 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序弹页面自动滚动动画" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序弹页面自动滚动动画"><!--[--><!--]--> 小程序弹页面自动滚动动画 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序文件预览" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序文件预览"><!--[--><!--]--> 小程序文件预览 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序分包加载" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序分包加载"><!--[--><!--]--> 小程序分包加载 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序路由和传参" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序路由和传参"><!--[--><!--]--> 小程序路由和传参 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#路由api" class="router-link-active router-link-exact-active sidebar-item" aria-label="路由api"><!--[--><!--]--> 路由api <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#navigator组件" class="router-link-active router-link-exact-active sidebar-item" aria-label="navigator组件"><!--[--><!--]--> navigator组件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#路由跳转传参" class="router-link-active router-link-exact-active sidebar-item" aria-label="路由跳转传参"><!--[--><!--]--> 路由跳转传参 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序自定义组件和使用" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序自定义组件和使用"><!--[--><!--]--> 小程序自定义组件和使用 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#组件传参" class="router-link-active router-link-exact-active sidebar-item" aria-label="组件传参"><!--[--><!--]--> 组件传参 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#父子组件传值—父传子" class="router-link-active router-link-exact-active sidebar-item" aria-label="父子组件传值—父传子"><!--[--><!--]--> 父子组件传值—父传子 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#父子组件传值—子传父" class="router-link-active router-link-exact-active sidebar-item" aria-label="父子组件传值—子传父"><!--[--><!--]--> 父子组件传值—子传父 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#组件内路由跳转" class="router-link-active router-link-exact-active sidebar-item" aria-label="组件内路由跳转"><!--[--><!--]--> 组件内路由跳转 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#input输入联想" class="router-link-active router-link-exact-active sidebar-item" aria-label="input输入联想"><!--[--><!--]--> input输入联想 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序自定义导航栏" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序自定义导航栏"><!--[--><!--]--> 小程序自定义导航栏 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#导航栏分析" class="router-link-active router-link-exact-active sidebar-item" aria-label="导航栏分析"><!--[--><!--]--> 导航栏分析 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#导航栏图解" class="router-link-active router-link-exact-active sidebar-item" aria-label="导航栏图解"><!--[--><!--]--> 导航栏图解 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#组件封装" class="router-link-active router-link-exact-active sidebar-item" aria-label="组件封装"><!--[--><!--]--> 组件封装 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#组件使用" class="router-link-active router-link-exact-active sidebar-item" aria-label="组件使用"><!--[--><!--]--> 组件使用 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序复制文本到到粘贴板" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序复制文本到到粘贴板"><!--[--><!--]--> 小程序复制文本到到粘贴板 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序多选列表开发票组件" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序多选列表开发票组件"><!--[--><!--]--> 小程序多选列表开发票组件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序使用canvas旋转图片" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序使用canvas旋转图片"><!--[--><!--]--> 小程序使用canvas旋转图片 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序调用微信企业客服" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序调用微信企业客服"><!--[--><!--]--> 小程序调用微信企业客服 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序内直接使用" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序内直接使用"><!--[--><!--]--> 小程序内直接使用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序web-view页面使用" class="router-link-active router-link-exact-active sidebar-item" aria-label="小程序web-view页面使用"><!--[--><!--]--> 小程序web-view页面使用 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="小程序开发案例汇总" tabindex="-1"><a class="header-anchor" href="#小程序开发案例汇总" aria-hidden="true">#</a> 小程序开发案例汇总</h1><nav class="table-of-contents"><ul><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序公共弹窗组件封装" class="router-link-active router-link-exact-active">小程序公共弹窗组件封装</a><ul><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#代码实现" class="router-link-active router-link-exact-active">代码实现</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#使用方法" class="router-link-active router-link-exact-active">使用方法</a></li></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序map地图显示组件使用案例" class="router-link-active router-link-exact-active">小程序map地图显示组件使用案例</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序使用腾讯地图选点组件" class="router-link-active router-link-exact-active">小程序使用腾讯地图选点组件</a><ul><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#代码实现-1" class="router-link-active router-link-exact-active">代码实现</a></li></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序登录状态管理-原生" class="router-link-active router-link-exact-active">小程序登录状态管理（原生）</a><ul><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#管家小程序登录流程分析" class="router-link-active router-link-exact-active">管家小程序登录流程分析</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#解决方案" class="router-link-active router-link-exact-active">解决方案</a></li></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序本地缓存二次封装-过期-续期-获取全部" class="router-link-active router-link-exact-active">小程序本地缓存二次封装（过期，续期，获取全部）</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序页面栈" class="router-link-active router-link-exact-active">小程序页面栈</a><ul><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#解决小程序返回按钮和物理返回跳转指定页面" class="router-link-active router-link-exact-active">解决小程序返回按钮和物理返回跳转指定页面</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#中转页方案-中转页——目标页" class="router-link-active router-link-exact-active">中转页方案（中转页——目标页）</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#页面栈详情" class="router-link-active router-link-exact-active">页面栈详情</a></li></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序性能优化" class="router-link-active router-link-exact-active">小程序性能优化</a><ul><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#图片优化" class="router-link-active router-link-exact-active">图片优化</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#未使用依赖清除" class="router-link-active router-link-exact-active">未使用依赖清除</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#减重后数据统计" class="router-link-active router-link-exact-active">减重后数据统计</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#打开小程序按需注入" class="router-link-active router-link-exact-active">打开小程序按需注入</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#使用分包加载" class="router-link-active router-link-exact-active">使用分包加载</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#数据预拉取" class="router-link-active router-link-exact-active">数据预拉取</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#数据持久化-全局数据和缓存的合理利用" class="router-link-active router-link-exact-active">数据持久化：全局数据和缓存的合理利用</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序状态管理" class="router-link-active router-link-exact-active">小程序状态管理</a></li></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序体验优化" class="router-link-active router-link-exact-active">小程序体验优化</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序canvas实现多边形雷达图-蜘蛛图" class="router-link-active router-link-exact-active">小程序canvas实现多边形雷达图，蜘蛛图</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#接口数据缓存方案" class="router-link-active router-link-exact-active">接口数据缓存方案</a><ul><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#data数据缓存" class="router-link-active router-link-exact-active">data数据缓存</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#接口缓存promise方案" class="router-link-active router-link-exact-active">接口缓存promise方案</a></li></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序工具函数封装" class="router-link-active router-link-exact-active">小程序工具函数封装</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#全局loading解决方案" class="router-link-active router-link-exact-active">全局loading解决方案</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#扫码进入小程序参数解析" class="router-link-active router-link-exact-active">扫码进入小程序参数解析</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序input双向绑定" class="router-link-active router-link-exact-active">小程序input双向绑定</a><ul><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#全表单双向绑定" class="router-link-active router-link-exact-active">全表单双向绑定</a></li></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序switchtab跳转传参和刷新页面解决方案" class="router-link-active router-link-exact-active">小程序switchTab跳转传参和刷新页面解决方案</a><ul><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#使用wx-relaunch" class="router-link-active router-link-exact-active">使用wx.reLaunch</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#调用页面栈刷新页面" class="router-link-active router-link-exact-active">调用页面栈刷新页面</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#使用全局变量和缓存" class="router-link-active router-link-exact-active">使用全局变量和缓存</a></li></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#伪元素放大点击区域" class="router-link-active router-link-exact-active">伪元素放大点击区域</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序规避审核方法" class="router-link-active router-link-exact-active">小程序规避审核方法</a><ul><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#问题分析" class="router-link-active router-link-exact-active">问题分析</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#审核机制" class="router-link-active router-link-exact-active">审核机制</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#方法总结" class="router-link-active router-link-exact-active">方法总结</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#解决方案-1" class="router-link-active router-link-exact-active">解决方案</a></li></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序echart图表使用" class="router-link-active router-link-exact-active">小程序echart图表使用</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序内跳转其他小程序" class="router-link-active router-link-exact-active">小程序内跳转其他小程序</a><ul><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#navigatetominiprogram-api跳转" class="router-link-active router-link-exact-active">navigateToMiniProgram api跳转</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#navigator标签跳转" class="router-link-active router-link-exact-active">navigator标签跳转</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#注意事项" class="router-link-active router-link-exact-active">注意事项</a></li></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序图片上传" class="router-link-active router-link-exact-active">小程序图片上传</a><ul><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#wux-uploader组件" class="router-link-active router-link-exact-active">wux-uploader组件</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#微信uploader组件" class="router-link-active router-link-exact-active">微信uploader组件</a></li></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序分享方案" class="router-link-active router-link-exact-active">小程序分享方案</a><ul><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#button组件方案" class="router-link-active router-link-exact-active">button组件方案</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#回调函数方案" class="router-link-active router-link-exact-active">回调函数方案</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#分享动态图片" class="router-link-active router-link-exact-active">分享动态图片</a></li></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序数据监听封装-watch" class="router-link-active router-link-exact-active">小程序数据监听封装 watch</a><ul><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#监听基本数据类型" class="router-link-active router-link-exact-active">监听基本数据类型</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#复杂类型监听" class="router-link-active router-link-exact-active">复杂类型监听</a></li></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序返回上一页传参" class="router-link-active router-link-exact-active">小程序返回上一页传参</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#进度球波浪动画组件" class="router-link-active router-link-exact-active">进度球波浪动画组件</a><ul><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#canvas动画组" class="router-link-active router-link-exact-active">canvas动画组</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#静态组件" class="router-link-active router-link-exact-active">静态组件</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#svg版本-小程序不支持" class="router-link-active router-link-exact-active">svg版本(小程序不支持)</a></li></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序消息订阅" class="router-link-active router-link-exact-active">小程序消息订阅</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序弹窗淡入淡出" class="router-link-active router-link-exact-active">小程序弹窗淡入淡出</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序弹页面自动滚动动画" class="router-link-active router-link-exact-active">小程序弹页面自动滚动动画</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序文件预览" class="router-link-active router-link-exact-active">小程序文件预览</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序分包加载" class="router-link-active router-link-exact-active">小程序分包加载</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序路由和传参" class="router-link-active router-link-exact-active">小程序路由和传参</a><ul><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#路由api" class="router-link-active router-link-exact-active">路由api</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#navigator组件" class="router-link-active router-link-exact-active">navigator组件</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#路由跳转传参" class="router-link-active router-link-exact-active">路由跳转传参</a></li></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序自定义组件和使用" class="router-link-active router-link-exact-active">小程序自定义组件和使用</a><ul><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#组件传参" class="router-link-active router-link-exact-active">组件传参</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#父子组件传值—父传子" class="router-link-active router-link-exact-active">父子组件传值—父传子</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#父子组件传值—子传父" class="router-link-active router-link-exact-active">父子组件传值—子传父</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#组件内路由跳转" class="router-link-active router-link-exact-active">组件内路由跳转</a></li></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#input输入联想" class="router-link-active router-link-exact-active">input输入联想</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序自定义导航栏" class="router-link-active router-link-exact-active">小程序自定义导航栏</a><ul><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#导航栏分析" class="router-link-active router-link-exact-active">导航栏分析</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#导航栏图解" class="router-link-active router-link-exact-active">导航栏图解</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#组件封装" class="router-link-active router-link-exact-active">组件封装</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#组件使用" class="router-link-active router-link-exact-active">组件使用</a></li></ul></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序复制文本到到粘贴板" class="router-link-active router-link-exact-active">小程序复制文本到到粘贴板</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序多选列表开发票组件" class="router-link-active router-link-exact-active">小程序多选列表开发票组件</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序使用canvas旋转图片" class="router-link-active router-link-exact-active">小程序使用canvas旋转图片</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序调用微信企业客服" class="router-link-active router-link-exact-active">小程序调用微信企业客服</a><ul><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序内直接使用" class="router-link-active router-link-exact-active">小程序内直接使用</a></li><li><a aria-current="page" href="/myblog/frontEnd/frame/wechatMini/workApply.html#小程序web-view页面使用" class="router-link-active router-link-exact-active">小程序web-view页面使用</a></li></ul></li></ul></nav><h2 id="小程序公共弹窗组件封装" tabindex="-1"><a class="header-anchor" href="#小程序公共弹窗组件封装" aria-hidden="true">#</a> 小程序公共弹窗组件封装</h2><h3 id="代码实现" tabindex="-1"><a class="header-anchor" href="#代码实现" aria-hidden="true">#</a> 代码实现</h3><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!--
  @description: 公共弹窗组件
  @author: hhd (2023-02-13)
  @update: 
--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wxs</span> <span class="token attr-name">module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>filter<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../../app.wxs<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wxs</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page-pop<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{ common_box.show }}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>card-pop<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>title-pop<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>提示<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>icon-box-pop<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{common_box.success === 1}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{filter.buildStatic(<span class="token punctuation">&#39;</span>/map/mapServe/success-red-icon.png<span class="token punctuation">&#39;</span>)}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>提交成功<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>content-pop<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ common_box.title }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button-pop<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>confirmCommonBox<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ common_box.confirm_text }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">common_box</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  
    <span class="token doc-comment comment">/**
     * 组件的方法列表
     */</span>
    <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token function">showCommonBox</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> close <span class="token operator">=</span> config<span class="token punctuation">.</span>close
            <span class="token keyword">if</span> <span class="token punctuation">(</span>close <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                close <span class="token operator">=</span> <span class="token boolean">false</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                close <span class="token operator">=</span> <span class="token boolean">true</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">let</span> common_box <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token literal-property property">title</span><span class="token operator">:</span> config<span class="token punctuation">.</span>title <span class="token operator">||</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">confirm_text</span><span class="token operator">:</span> config<span class="token punctuation">.</span>confirmText <span class="token operator">||</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">callback</span><span class="token operator">:</span> config<span class="token punctuation">.</span>callback <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
                <span class="token literal-property property">success</span><span class="token operator">:</span> config<span class="token punctuation">.</span>success <span class="token operator">||</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">rightBottomText</span><span class="token operator">:</span> config<span class="token punctuation">.</span>rightBottomText <span class="token operator">||</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">rightBottomCallback</span><span class="token operator">:</span> config<span class="token punctuation">.</span>rightBottomCallback <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
                <span class="token literal-property property">fontWeight</span><span class="token operator">:</span> config<span class="token punctuation">.</span>fontWeight <span class="token operator">||</span> <span class="token string">&#39;bold&#39;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> config<span class="token punctuation">.</span>type <span class="token operator">||</span> <span class="token number">1</span><span class="token punctuation">,</span>
                close
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                common_box
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">rightBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>common_box<span class="token punctuation">.</span>rightBottomCallback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>common_box<span class="token punctuation">.</span><span class="token function">rightBottomCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>rightBottomCallback <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">closeCommonBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">confirmCommonBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">closeCommonBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>common_box<span class="token punctuation">.</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>common_box<span class="token punctuation">.</span><span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>callback <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">closeCommonBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>common_box<span class="token punctuation">.</span>show <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token literal-property property">common_box</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>common_box
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">.page-pop</span><span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.6<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">z-index</span><span class="token punctuation">:</span> 999<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.page-pop .card-pop</span><span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span>-50%<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 670rpx<span class="token punctuation">;</span>
  <span class="token property">min-height</span><span class="token punctuation">:</span> 100rpx<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #ffffff<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 15rpx<span class="token punctuation">;</span>
  <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 30rpx  <span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.card-pop .title-pop</span><span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 28rpx<span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> bold<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #333333<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 50rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.card-pop .icon-box-pop</span><span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 90rpx<span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 28rpx<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #db343e<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.card-pop .icon-box-pop image</span><span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto 12rpx<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 52rpx<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 52rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.card-pop .content-pop</span><span class="token punctuation">{</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 35rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.card-pop .button-pop</span><span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 610rpx<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 90rpx<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #db343e<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 15rpx<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 35rpx auto 0<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 28rpx<span class="token punctuation">;</span>
  <span class="token property">line-height</span><span class="token punctuation">:</span> 90rpx<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #ffffff<span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="使用方法" tabindex="-1"><a class="header-anchor" href="#使用方法" aria-hidden="true">#</a> 使用方法</h3><h4 id="组件引用" tabindex="-1"><a class="header-anchor" href="#组件引用" aria-hidden="true">#</a> 组件引用</h4><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;usingComponents&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;dialog&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/mycomponents/dialog/index&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="组件注入" tabindex="-1"><a class="header-anchor" href="#组件注入" aria-hidden="true">#</a> 组件注入</h4><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- dialog组件 --&gt;</span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dialog</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dialog<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dialog</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>dialog <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">selectComponent</span><span class="token punctuation">(</span><span class="token string">&#39;#dialog&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="组件调用" tabindex="-1"><a class="header-anchor" href="#组件调用" aria-hidden="true">#</a> 组件调用</h4><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>dialog<span class="token punctuation">.</span><span class="token function">showCommonBox</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&quot;提交成功，审核通过后3-5天同步到地图&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">confirmText</span><span class="token operator">:</span> <span class="token string">&quot;确定&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">success</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token string-property property">&#39;callback&#39;</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 确认按钮回调</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序map地图显示组件使用案例" tabindex="-1"><a class="header-anchor" href="#小程序map地图显示组件使用案例" aria-hidden="true">#</a> 小程序map地图显示组件使用案例</h2><ul><li>文档地址：<a href="https://developers.weixin.qq.com/miniprogram/dev/component/map.html" target="_blank" rel="noopener noreferrer">https://developers.weixin.qq.com/miniprogram/dev/component/map.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!--wxml--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>map</span>
  <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myMap<span class="token punctuation">&quot;</span></span>
  <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> 400px<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span>
  <span class="token attr-name">latitude</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{latitude}}<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">longitude</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{longitude}}<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">markers</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{markers}}<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">enable-scroll</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{false}}<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">show-location</span>
<span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>map</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">latitude</span><span class="token operator">:</span> <span class="token number">23.099994</span><span class="token punctuation">,</span> <span class="token comment">// 纬度</span>
    <span class="token literal-property property">longitude</span><span class="token operator">:</span> <span class="token number">113.324520</span><span class="token punctuation">,</span> <span class="token comment">// 经度</span>
     <span class="token literal-property property">markers</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>  <span class="token comment">// 标记点信息</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token string">&#39;40px&#39;</span><span class="token punctuation">,</span>  <span class="token comment">// 必填</span>
      <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token string">&#39;26px&#39;</span><span class="token punctuation">,</span>  <span class="token comment">// 必填</span>
      <span class="token literal-property property">latitude</span><span class="token operator">:</span> <span class="token number">23.099994</span><span class="token punctuation">,</span>
      <span class="token literal-property property">longitude</span><span class="token operator">:</span> <span class="token number">113.324520</span><span class="token punctuation">,</span>
      <span class="token literal-property property">iconPath</span><span class="token operator">:</span> <span class="token string">&#39;...location-icon.png&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 自定义标记点icon</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序使用腾讯地图选点组件" tabindex="-1"><a class="header-anchor" href="#小程序使用腾讯地图选点组件" aria-hidden="true">#</a> 小程序使用腾讯地图选点组件</h2><ul><li>官方文档：<a href="https://mp.weixin.qq.com/wxopen/plugindevdoc?appid=wx76a9a06e5b4e693e" target="_blank" rel="noopener noreferrer">https://mp.weixin.qq.com/wxopen/plugindevdoc?appid=wx76a9a06e5b4e693e<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h3 id="代码实现-1" tabindex="-1"><a class="header-anchor" href="#代码实现-1" aria-hidden="true">#</a> 代码实现</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>  <span class="token comment">// 取值</span>
 <span class="token function">onShow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1111111</span><span class="token punctuation">)</span>
    <span class="token comment">// 从地图选点插件返回后，在页面的onShow生命周期函数中能够调用插件接口，取得选点结果对象</span>
    <span class="token comment">// 如果点击确认选点按钮，则返回选点结果对象，否则返回null</span>
    <span class="token keyword">const</span> location <span class="token operator">=</span> chooseLocation<span class="token punctuation">.</span><span class="token function">getLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>location<span class="token punctuation">,</span><span class="token number">11111</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>location<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">let</span> data_options <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>data_options<span class="token punctuation">;</span>
      data_options<span class="token punctuation">.</span>address <span class="token operator">=</span> location<span class="token punctuation">.</span>address<span class="token punctuation">;</span>
      <span class="token keyword">let</span> markers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token string">&#39;40px&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token string">&#39;26px&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">latitude</span><span class="token operator">:</span> location<span class="token punctuation">.</span>latitude<span class="token punctuation">,</span>
        <span class="token literal-property property">longitude</span><span class="token operator">:</span> location<span class="token punctuation">.</span>longitude<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">]</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">latitude</span><span class="token operator">:</span> location<span class="token punctuation">.</span>latitude<span class="token punctuation">,</span>
        <span class="token literal-property property">longitude</span><span class="token operator">:</span> location<span class="token punctuation">.</span>longitude<span class="token punctuation">,</span>
        data_options<span class="token punctuation">,</span>
        markers
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


<span class="token doc-comment comment">/**
 * 打开地图选点组件
 */</span>
<span class="token function">toMapSelect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> key <span class="token operator">=</span> &#39;<span class="token constant">H3GBZ</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span><span class="token punctuation">;</span> <span class="token comment">//使用在腾讯位置服务申请的key</span>
  <span class="token keyword">const</span> referer <span class="token operator">=</span> <span class="token string">&#39;立信计划&#39;</span><span class="token punctuation">;</span> <span class="token comment">// 调用插件的app的名称</span>
  <span class="token keyword">const</span> location <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">latitude</span><span class="token operator">:</span> <span class="token number">39.89631551</span><span class="token punctuation">,</span>
    <span class="token literal-property property">longitude</span><span class="token operator">:</span> <span class="token number">116.323459711</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> category <span class="token operator">=</span> <span class="token string">&#39;其他&#39;</span><span class="token punctuation">;</span>
  wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;plugin://chooseLocation/index?key=&#39;</span>
            <span class="token operator">+</span> key <span class="token operator">+</span> <span class="token string">&#39;&amp;referer=&#39;</span> <span class="token operator">+</span> referer <span class="token operator">+</span> <span class="token string">&#39;&amp;location=&#39;</span>
            <span class="token operator">+</span> location <span class="token operator">+</span> <span class="token string">&#39;&amp;category=&#39;</span> <span class="token operator">+</span> category
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序登录状态管理-原生" tabindex="-1"><a class="header-anchor" href="#小程序登录状态管理-原生" aria-hidden="true">#</a> 小程序登录状态管理（原生）</h2><h3 id="管家小程序登录流程分析" tabindex="-1"><a class="header-anchor" href="#管家小程序登录流程分析" aria-hidden="true">#</a> 管家小程序登录流程分析</h3><p><img src="/myblog/images/frontEnd/20220713222830.png" alt="图片"></p><h3 id="解决方案" tabindex="-1"><a class="header-anchor" href="#解决方案" aria-hidden="true">#</a> 解决方案</h3><h4 id="短信——冷启动-app-js" tabindex="-1"><a class="header-anchor" href="#短信——冷启动-app-js" aria-hidden="true">#</a> 短信——冷启动 app.js</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  globalData<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 管家小程序全局变量</span>
    userParam<span class="token operator">:</span> <span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 批次id</span>
      uid<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 用户id</span>
      token<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 登录token</span>
      digest<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 企业digest</span>
      product_type<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 版本类型</span>
      phone<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 手机号码</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  
    
  <span class="token function-variable function">onLaunch</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token doc-comment comment">/**
       * 全局登录绑定状态管理
       * <span class="token keyword">@param</span> <span class="token punctuation">{</span>object<span class="token punctuation">}</span> options 初始化参数
       * <span class="token keyword">@param</span> <span class="token parameter">shuidi_user_map_status</span> 企业绑定状态 值：当前用户id
       */</span>
      <span class="token function-variable function">bindUserInfo</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//知晓哪个用户登录，并绑定公司用户</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>wx<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">&#39;shuidi_user_map_status&#39;</span><span class="token punctuation">)</span> <span class="token operator">!=</span> options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>uid<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>uid <span class="token operator">=</span> options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>uid<span class="token punctuation">;</span>
            wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&quot;shuidi_user_id&quot;</span><span class="token punctuation">,</span> options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>uid<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>token<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>token <span class="token operator">=</span> options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>token<span class="token punctuation">;</span>
            wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&quot;shuidi_uid_token&quot;</span><span class="token punctuation">,</span> options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>id <span class="token operator">=</span> options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
            wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&quot;shuidi_assoc_id&quot;</span><span class="token punctuation">,</span> options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>product_type<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>product_type <span class="token operator">=</span> options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>product_type<span class="token punctuation">;</span>
            wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&quot;shuidi_product_type&quot;</span><span class="token punctuation">,</span> options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>product_type<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>digest<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>digest <span class="token operator">=</span> options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>digest<span class="token punctuation">;</span>
            wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&quot;shuidi_digest&quot;</span><span class="token punctuation">,</span> options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>digest<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>uid <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>token <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>digest <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>product_type<span class="token punctuation">)</span><span class="token punctuation">{</span>
            api<span class="token punctuation">.</span><span class="token function">save_user_company_map</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
              digest<span class="token operator">:</span> options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>digest<span class="token punctuation">,</span>
              source<span class="token operator">:</span> options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>product_type<span class="token punctuation">,</span>
              kp_id<span class="token operator">:</span> options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>id<span class="token operator">?</span>options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>id<span class="token operator">:</span><span class="token string">&#39;&#39;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res<span class="token operator">=&gt;</span><span class="token punctuation">{</span>
              <span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">&amp;&amp;</span> res<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&#39;shuidi_user_map_status&#39;</span><span class="token punctuation">,</span> options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
              <span class="token punctuation">}</span>
              api<span class="token punctuation">.</span><span class="token function">user_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">&amp;&amp;</span> <span class="token operator">+</span>res<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                  <span class="token keyword">this</span><span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>phone <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token operator">?.</span>phone <span class="token operator">??</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">;</span>
                  wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&quot;user_name&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>phone<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>uid <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>query<span class="token punctuation">.</span>token<span class="token punctuation">)</span><span class="token punctuation">{</span>    
            api<span class="token punctuation">.</span><span class="token function">user_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
              <span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">&amp;&amp;</span> <span class="token operator">+</span>res<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>phone <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token operator">?.</span>phone <span class="token operator">??</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">;</span>
                wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&quot;user_name&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>phone<span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="短信——热启动-shuidi-page-js" tabindex="-1"><a class="header-anchor" href="#短信——热启动-shuidi-page-js" aria-hidden="true">#</a> 短信——热启动 shuidi-page.js</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> api <span class="token operator">=</span> app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>api<span class="token punctuation">;</span>


<span class="token doc-comment comment">/**
 * 重写 Page 对象
 * <span class="token keyword">@param</span> <span class="token punctuation">{</span>*<span class="token punctuation">}</span> pageConfig 修改页面 page 对象
 * @使用方式：
    导入： import Page from &#39;/common/shuidi-page&#39;
 */</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">ShuidiPage</span><span class="token punctuation">(</span>pageConfig<span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token comment">// onLond函数赋值</span>
    <span class="token keyword">let</span> onLoad <span class="token operator">=</span> pageConfig<span class="token punctuation">.</span>onLoad<span class="token punctuation">;</span>
    pageConfig<span class="token punctuation">.</span><span class="token function-variable function">onLoad</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">{</span>

        <span class="token doc-comment comment">/**
         * 全局登录绑定状态管理
         * <span class="token keyword">@param</span> <span class="token punctuation">{</span>object<span class="token punctuation">}</span> options 初始化参数
         * <span class="token keyword">@param</span> <span class="token parameter">shuidi_user_map_status</span> 企业绑定状态 值：当前用户id
         */</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>wx<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">&#39;shuidi_user_map_status&#39;</span><span class="token punctuation">)</span> <span class="token operator">!=</span> options<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>uid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>uid <span class="token operator">=</span> options<span class="token punctuation">.</span>uid<span class="token punctuation">;</span>
              wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&quot;shuidi_user_id&quot;</span><span class="token punctuation">,</span> options<span class="token punctuation">.</span>uid<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>token <span class="token operator">=</span> options<span class="token punctuation">.</span>token<span class="token punctuation">;</span>
              wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&quot;shuidi_uid_token&quot;</span><span class="token punctuation">,</span> options<span class="token punctuation">.</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>id <span class="token operator">=</span> options<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
              wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&quot;shuidi_assoc_id&quot;</span><span class="token punctuation">,</span> options<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>product_type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>product_type <span class="token operator">=</span> options<span class="token punctuation">.</span>product_type<span class="token punctuation">;</span>
              wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&quot;shuidi_product_type&quot;</span><span class="token punctuation">,</span> options<span class="token punctuation">.</span>product_type<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>digest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>digest <span class="token operator">=</span> options<span class="token punctuation">.</span>digest<span class="token punctuation">;</span>
              wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&quot;shuidi_digest&quot;</span><span class="token punctuation">,</span> options<span class="token punctuation">.</span>digest<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>uid <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>token <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>digest <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>product_type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              api<span class="token punctuation">.</span><span class="token function">save_user_company_map</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  digest<span class="token operator">:</span> options<span class="token punctuation">.</span>digest<span class="token punctuation">,</span>
                  source<span class="token operator">:</span> options<span class="token punctuation">.</span>product_type<span class="token punctuation">,</span>
                  kp_id<span class="token operator">:</span> options<span class="token punctuation">.</span>id <span class="token operator">?</span> options<span class="token punctuation">.</span>id <span class="token operator">:</span> <span class="token string">&#39;&#39;</span>
              <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                  <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">&amp;&amp;</span> res<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                      wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&#39;shuidi_user_map_status&#39;</span><span class="token punctuation">,</span> options<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
                  <span class="token punctuation">}</span>
                  api<span class="token punctuation">.</span><span class="token function">user_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">&amp;&amp;</span> <span class="token operator">+</span>res<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                      app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>phone <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token operator">?.</span>phone <span class="token operator">??</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">;</span>
                      wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&quot;user_name&quot;</span><span class="token punctuation">,</span> app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>phone<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                  <span class="token punctuation">}</span><span class="token punctuation">)</span>
              <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>uid <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            api<span class="token punctuation">.</span><span class="token function">user_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
              <span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">&amp;&amp;</span> <span class="token operator">+</span>res<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>phone <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token operator">?.</span>phone <span class="token operator">??</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">;</span>
                wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&quot;user_name&quot;</span><span class="token punctuation">,</span> app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>phone<span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      
        <span class="token function">onLoad</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">Page</span><span class="token punctuation">(</span>pageConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> ShuidiPage<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="授权登录api-js" tabindex="-1"><a class="header-anchor" href="#授权登录api-js" aria-hidden="true">#</a> 授权登录api.js</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>    <span class="token comment">// 拦截 decode_data 授权登录获取登录信息接口</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token operator">?.</span>user_token<span class="token operator">?.</span>user_id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>uid <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>user_token<span class="token punctuation">.</span>user_id<span class="token punctuation">;</span>
        wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&quot;shuidi_user_id&quot;</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>user_token<span class="token punctuation">.</span>user_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token operator">?.</span>user_token<span class="token operator">?.</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>token <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>user_token<span class="token punctuation">.</span>token<span class="token punctuation">;</span>
          wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&quot;shuidi_uid_token&quot;</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>user_token<span class="token punctuation">.</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token operator">?.</span>phoneNumber<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>phone <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>phoneNumber<span class="token punctuation">;</span>
        wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&quot;user_name&quot;</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>phoneNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      http<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>config<span class="token punctuation">.</span>baseUrl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/mobile/active/base</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        data<span class="token operator">:</span> <span class="token punctuation">{</span> action<span class="token operator">:</span> <span class="token string">&#39;home&#39;</span><span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token operator">?.</span>data<span class="token operator">?.</span>digest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>digest <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>digest<span class="token punctuation">;</span>
          wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&quot;shuidi_digest&quot;</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>digest<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="退出登录清除全局和缓存" tabindex="-1"><a class="header-anchor" href="#退出登录清除全局和缓存" aria-hidden="true">#</a> 退出登录清除全局和缓存</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>wx<span class="token punctuation">.</span><span class="token function">clearStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="使用-登录状态数据获取" tabindex="-1"><a class="header-anchor" href="#使用-登录状态数据获取" aria-hidden="true">#</a> 使用： 登录状态数据获取</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> api <span class="token operator">=</span> app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>api<span class="token punctuation">;</span>

<span class="token comment">/*
  @description: 全局参数获取封装
  @author: hhd (2022-06-17)
  @使用方式：
    导入： import getData from &#39;...../common/getData&#39;;
    调用获取全局变量： getData.getUid()
 */</span>


<span class="token keyword">var</span> getData <span class="token operator">=</span> <span class="token punctuation">{</span>

  <span class="token doc-comment comment">/*************** 获取全局参数 *****************/</span>
  <span class="token doc-comment comment">/**
   * 获取user_id
   * <span class="token keyword">@returns</span> <span class="token punctuation">{</span>string, number<span class="token punctuation">}</span>
   */</span>
  <span class="token function-variable function">getUid</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>uid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>uid
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> wx<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">&#39;shuidi_user_id&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token doc-comment comment">/**
   * 获取token
   * <span class="token keyword">@returns</span> <span class="token punctuation">{</span>string, number<span class="token punctuation">}</span>
   */</span>
  <span class="token function-variable function">getToken</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>token
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> wx<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">&#39;shuidi_uid_token&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token doc-comment comment">/**
   * 获取id
   * <span class="token keyword">@returns</span> <span class="token punctuation">{</span>string, number<span class="token punctuation">}</span>
   */</span>
  <span class="token function-variable function">getId</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>id
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> wx<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">&#39;shuidi_assoc_id&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token doc-comment comment">/**
   * 获取product_type
   * <span class="token keyword">@returns</span> <span class="token punctuation">{</span>string, number<span class="token punctuation">}</span>
   */</span>
  <span class="token function-variable function">getProductType</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>product_type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>product_type
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> wx<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">&#39;shuidi_product_type&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token doc-comment comment">/**
   * 获取digest
   * <span class="token keyword">@returns</span> <span class="token punctuation">{</span>string, number<span class="token punctuation">}</span>
   */</span>
  <span class="token function-variable function">getDigest</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>digest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>digest
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> wx<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">&#39;shuidi_digest&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token doc-comment comment">/**
   * 获取手机号码: phone
   * <span class="token keyword">@returns</span> <span class="token punctuation">{</span>string, number<span class="token punctuation">}</span>
   */</span>
  <span class="token function-variable function">getPhone</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>digest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userParam<span class="token punctuation">.</span>phone
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> wx<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">&#39;user_name&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> getData<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序本地缓存二次封装-过期-续期-获取全部" tabindex="-1"><a class="header-anchor" href="#小程序本地缓存二次封装-过期-续期-获取全部" aria-hidden="true">#</a> 小程序本地缓存二次封装（过期，续期，获取全部）</h2><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">/*
  @description: 本地缓存二次封装
  @title: wxCache.js
  @author: hhd
  @Time: 2022-6-27 17:30
  @last: 2022-6-30 10:00
  @导入方式：
    import wxCache from &#39;./common/wxCache.js&#39; // 导入wxCache.js
    App({
      data:{},
      wxCache: new wxCache(), // 全局导入
    })
  @使用方式：
    app.wxCache.set(&#39;time&#39;,&#39;123&#39;, 1, true);
    app.wxCache.get(&#39;time&#39;);

  @局部引用： 
    import wxCache from &#39;/common/wxCache.js&#39;
    wxCache.set(&#39;time&#39;,&#39;123&#39;, 1, true)
 */</span>

<span class="token comment">// export default class WxCache {   // undifend</span>

<span class="token keyword">var</span> wxCache <span class="token operator">=</span> <span class="token punctuation">{</span>

  <span class="token doc-comment comment">/**
   * 设置缓存数据
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>String<span class="token punctuation">}</span> key 缓存字段名
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>*<span class="token punctuation">}</span> value 缓存字段值
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>Number<span class="token punctuation">}</span> expire  缓存过期时间 单位：秒
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>Boolean<span class="token punctuation">}</span> isRenewal 是否开启持续使用中续期：默认开启
   */</span>
  <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> expire<span class="token punctuation">,</span> isRenewal<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>expire<span class="token punctuation">)</span>
      value <span class="token operator">=</span> value <span class="token operator">??</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>key<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;key cannot be empty&quot;</span><span class="token punctuation">)</span> 

      <span class="token keyword">let</span> data<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>expire<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isNaN</span><span class="token punctuation">(</span>expire<span class="token punctuation">)</span> <span class="token operator">||</span> expire <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Expire must be a number&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> expirefrom <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span>expire<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 秒转化毫秒</span>
        data <span class="token operator">=</span> <span class="token punctuation">{</span>
          value<span class="token operator">:</span> value<span class="token punctuation">,</span> <span class="token comment">// 存储值</span>
          time<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 存储时时间戳</span>
          expire<span class="token operator">:</span> expirefrom<span class="token punctuation">,</span> <span class="token comment">// 过期时间</span>
          isRenewal<span class="token punctuation">,</span> <span class="token comment">// 是否开启续期功能</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        data <span class="token operator">=</span> value<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  

  <span class="token doc-comment comment">/**
   * 获取缓存数据
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>String<span class="token punctuation">}</span> key 缓存字段名
   * <span class="token keyword">@returns</span> <span class="token punctuation">{</span>String<span class="token punctuation">}</span>
   */</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>wx<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 判断key是否存在</span>
      <span class="token keyword">const</span> now <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取当前时间</span>
      <span class="token keyword">let</span> storage<span class="token punctuation">;</span>
      <span class="token keyword">try</span><span class="token punctuation">{</span>
        storage <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>wx<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 获取缓存数据JSON</span>
      <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">{</span>
        storage <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token comment">// 获取缓存数据非JSON</span>
      <span class="token punctuation">}</span>
      
    <span class="token keyword">if</span><span class="token punctuation">(</span>storage<span class="token operator">?.</span>expire<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>storage<span class="token operator">?.</span>time <span class="token operator">+</span> storage<span class="token operator">?.</span>expire<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> now <span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 未过期期间被调用 则自动续期 进行保活</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>storage<span class="token operator">?.</span>isRenewal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            storage<span class="token punctuation">.</span>time <span class="token operator">=</span> now<span class="token punctuation">;</span>
            wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>storage<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token comment">// 未过期获取</span>
          <span class="token keyword">return</span> storage<span class="token operator">?.</span>value
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token comment">// 已过期删除</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// 没有设置时间处理返回</span>
        <span class="token keyword">return</span> storage
    <span class="token punctuation">}</span>

  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token doc-comment comment">/**
   * 获取全部storage
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>string<span class="token punctuation">}</span> dataType 返回数据类型 object(默认), array
   * <span class="token keyword">@returns</span> <span class="token punctuation">{</span>object,array<span class="token punctuation">}</span> 
   */</span>
  <span class="token function-variable function">getAll</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>dataType<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> info <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getStorageInfoSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">let</span> allStorageArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> allStorageObj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> item <span class="token keyword">of</span> info<span class="token punctuation">.</span>keys<span class="token punctuation">)</span><span class="token punctuation">{</span>
        allStorageArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          key<span class="token operator">:</span> item<span class="token punctuation">,</span>
          value<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        allStorageObj<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>dataType <span class="token operator">===</span> <span class="token string">&quot;array&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> allStorageArr
      <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> allStorageObj
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token doc-comment comment">/**
   * 移除缓存数据
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>String<span class="token punctuation">}</span> key 
   */</span>
  <span class="token function-variable function">remove</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      wx<span class="token punctuation">.</span><span class="token function">removeStorageSync</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token doc-comment comment">/**
   * 清空所有缓存数据
   */</span>
  <span class="token function-variable function">clearAll</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    wx<span class="token punctuation">.</span><span class="token function">clearStorageSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> wxCache<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序页面栈" tabindex="-1"><a class="header-anchor" href="#小程序页面栈" aria-hidden="true">#</a> 小程序页面栈</h2><h3 id="解决小程序返回按钮和物理返回跳转指定页面" tabindex="-1"><a class="header-anchor" href="#解决小程序返回按钮和物理返回跳转指定页面" aria-hidden="true">#</a> 解决小程序返回按钮和物理返回跳转指定页面</h3><ul><li>A -&gt; B</li><li>点击头部 navigator 返回键可通过重写 navigator bar 自定义返回键 handler 进行拦截</li><li>侧滑、安卓机底部物理返回键可以在 B 页 onUnload 生命周期通过事件或其他方法 通知前置 A 页当前发生回退行为，在 A 页 onShow 生命周期触发拦截如再次返回 B 页， 虽然逻辑层发生了回退但从交互、视觉角度当前仍停留在 B 页</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> pages <span class="token operator">=</span> <span class="token function">getCurrentPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//获取当前页面信息栈</span>
<span class="token keyword">const</span> prevPage1 <span class="token operator">=</span> pages<span class="token punctuation">[</span>pages<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>     <span class="token comment">//获取当前页面信息</span>
<span class="token keyword">const</span> prevPage2 <span class="token operator">=</span> pages<span class="token punctuation">[</span>pages<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span>     <span class="token comment">//获取上一个页面信息</span>

<span class="token keyword">const</span> page <span class="token operator">=</span> <span class="token function">getCurrentPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>page<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  page<span class="token punctuation">[</span>page<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    收货人<span class="token operator">:</span> 选中的某个收货人详情   <span class="token comment">//[object]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  wx<span class="token punctuation">.</span><span class="token function">navigateBack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    delta<span class="token operator">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>页面栈信息 <img src="/myblog/images/frontEnd/img.png" alt="图片"></li></ul><h3 id="中转页方案-中转页——目标页" tabindex="-1"><a class="header-anchor" href="#中转页方案-中转页——目标页" aria-hidden="true">#</a> 中转页方案（中转页——目标页）</h3><h3 id="页面栈详情" tabindex="-1"><a class="header-anchor" href="#页面栈详情" aria-hidden="true">#</a> 页面栈详情</h3><p><img src="/myblog/images/frontEnd/img_1.png" alt="图片"><img src="/myblog/images/frontEnd/img_2.png" alt="图片"><img src="/myblog/images/frontEnd/img_3.png" alt="图片"></p><h2 id="小程序性能优化" tabindex="-1"><a class="header-anchor" href="#小程序性能优化" aria-hidden="true">#</a> 小程序性能优化</h2><p><img src="/myblog/images/frontEnd/img_4.png" alt="图片"></p><h3 id="图片优化" tabindex="-1"><a class="header-anchor" href="#图片优化" aria-hidden="true">#</a> 图片优化</h3><ul><li>使用图片懒加载，未显示的部分不加载（适用于滑动加载长页面）</li><li>雪碧图技术，整张图片切出icon（不利于后期维护）</li><li>拆分域名，接口，文件，图片使用不同域名 （图片单独域名）</li><li>cdn内容分发 （已使用）</li><li>图片开启http缓存，在服务器端配置请求头cache-control（已配置）</li><li>开发阶段尽量控制图片请求量，icon用字体或者组件库代替</li><li>开发图片icon转字体插件,减少http请求和本地资源大小 (未实现）</li></ul><h3 id="未使用依赖清除" tabindex="-1"><a class="header-anchor" href="#未使用依赖清除" aria-hidden="true">#</a> 未使用依赖清除</h3><ul><li>依赖分析和清除 <img src="/myblog/images/frontEnd/img_5.png" alt="图片"></li><li><ul><li>分包echarts,完成手写蜘蛛图后替换 替换后减少960kb（已完成）</li></ul></li></ul><h3 id="减重后数据统计" tabindex="-1"><a class="header-anchor" href="#减重后数据统计" aria-hidden="true">#</a> 减重后数据统计</h3><ul><li>（使用小程序助手数据分析）</li><li>减重后数据统计：减重比例：42%；</li><li>减重量：3253-1892=1361KB</li><li>打开率：从平均92%—94%以上 ； 低端机从低于88%—90%以上</li><li>小程序总体启动时间：从平均4.7s—4.4s; 安卓机从5.3s—5秒以内</li></ul><h3 id="打开小程序按需注入" tabindex="-1"><a class="header-anchor" href="#打开小程序按需注入" aria-hidden="true">#</a> 打开小程序按需注入</h3><ul><li>使用真机调试查看注入量</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// app.json文件</span>
<span class="token punctuation">{</span>
  lazyCodeLoading<span class="token operator">:</span> <span class="token string">&quot;requiredComponents&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="使用分包加载" tabindex="-1"><a class="header-anchor" href="#使用分包加载" aria-hidden="true">#</a> 使用分包加载</h3><ul><li>独立分包无法使用主包内公共依赖和组件</li><li>分包预加载使用局限较大，不适用信用管家项目</li></ul><h3 id="数据预拉取" tabindex="-1"><a class="header-anchor" href="#数据预拉取" aria-hidden="true">#</a> 数据预拉取</h3><ul><li>说明：在冷启动时通过微信后台向服务器拉取业务数据，减少了首屏渲染等待时间；</li><li>除首页其他页接口量较小</li></ul><h3 id="数据持久化-全局数据和缓存的合理利用" tabindex="-1"><a class="header-anchor" href="#数据持久化-全局数据和缓存的合理利用" aria-hidden="true">#</a> 数据持久化：全局数据和缓存的合理利用</h3><h3 id="小程序状态管理" tabindex="-1"><a class="header-anchor" href="#小程序状态管理" aria-hidden="true">#</a> 小程序状态管理</h3><h2 id="小程序体验优化" tabindex="-1"><a class="header-anchor" href="#小程序体验优化" aria-hidden="true">#</a> 小程序体验优化</h2><p>1.取消 :active使用，滑动页面时效果不清除</p><ul><li>用hover-class=&quot;&quot; 代替</li></ul><p>2.设置页面滚动 overflow:scroll要同时开启惯性滚动</p><ul><li>-webkit-overflow-scrolling: touch (适配ios端）</li></ul><p>3.可点击区域过小问题</p><ul><li>点击icon宽高应该大于20px</li></ul><p>4.存在定时器未回收的问题，定时器是全局的，需要手动回收（未生效）</p><ul><li>跳转下一页是清除上一页定时器</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">let</span> interval1 <span class="token operator">=</span> <span class="token keyword">null</span>
interval1 <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span>_<span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">start2</span><span class="token punctuation">(</span><span class="token operator">++</span>time2<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span>  

<span class="token function-variable function">onUnload</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 清除定时器</span>
    interval1 <span class="token operator">&amp;&amp;</span> <span class="token function">clearInterval</span><span class="token punctuation">(</span>interval1<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>5.setData使用过于频繁，减少setData使用频次，降低性能消耗</p><h2 id="小程序canvas实现多边形雷达图-蜘蛛图" tabindex="-1"><a class="header-anchor" href="#小程序canvas实现多边形雷达图-蜘蛛图" aria-hidden="true">#</a> 小程序canvas实现多边形雷达图，蜘蛛图</h2><p><img src="/myblog/images/frontEnd/img_6.png" alt="图片"></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">/*
  @description: 多边形，雷达图，蜘蛛图canvas组件
  @author: hhd (2021-12-17)
  @使用方式：
    导入： import myCanvas from &#39;/common/myCanvas&#39;;
    雷达图数据配置：
        const configData = {
          canvasW: 700, // canvas宽
          canvasH: 600, // canvas高
          canvasRadius: 200, // 外框半径
          canvasLineWidth: 2, // 外框线宽
          rBorderColor: &#39;#999&#39;, // 外框颜色
          rBorderBg: &#39;#e8f9f0&#39;, // 外框背景颜色
          rLinklineColor: &#39;#999&#39;, // 连接线颜色
          titleFont: 26, // 字体大小
          titleColor: &#39;#999&#39;, // 字体颜色
          radarData : [  // 雷达图配置 radarData数量 = 雷达图数量
            {
              color : &#39;#63d798&#39;, // 雷达图1颜色
              lineWidth: 2, // 雷达图1线宽
              isFull: false, // 是否填充背景
              mData : [ // mData数量 = 雷达图边数
                { title: &quot;诚信意愿&quot;, score: 10, fullScore: 10},
                { title: &quot;合规履约&quot;, score: 9, fullScore: 10 },
                { title: &quot;经营能力&quot;, score: 6, fullScore: 10 },
              ]
            },
            {
              color : &#39;#dd3239&#39;, // 雷达图2颜色
              lineWidth: 2, // 雷达图2线宽
              isFull: false, // 是否填充背景
              mData : [
                { title: &quot;诚信意愿&quot;, score: 10, fullScore: 10},
                { title: &quot;合规履约&quot;, score: 1, fullScore: 10 },
                { title: &quot;经营能力&quot;, score: 2, fullScore: 10 },
              ]
            },
          ]
        }
    调用： myCanvas.radar(configData)
 */</span>


<span class="token keyword">var</span> myCanvas <span class="token operator">=</span> <span class="token punctuation">{</span> 

    <span class="token function">radar</span><span class="token punctuation">(</span>configData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> ctx <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">createCanvasContext</span><span class="token punctuation">(</span><span class="token string">&quot;canvas&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> canvasW <span class="token operator">=</span> configData<span class="token punctuation">.</span>canvasW <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getRatio</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// canvas宽</span>
        <span class="token keyword">const</span> canvasH <span class="token operator">=</span> configData<span class="token punctuation">.</span>canvasH <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getRatio</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//canvas高</span>
        <span class="token keyword">const</span> <span class="token constant">L_RADIUS</span> <span class="token operator">=</span> configData<span class="token punctuation">.</span>canvasRadius <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getRatio</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 大圆半径</span>
        <span class="token keyword">const</span> <span class="token constant">LINE_WIDTH</span> <span class="token operator">=</span> configData<span class="token punctuation">.</span>canvasLineWidth <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getRatio</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 线宽</span>
        <span class="token keyword">const</span> rBorderColor <span class="token operator">=</span> configData<span class="token punctuation">.</span>renderBorder<span class="token punctuation">;</span> <span class="token comment">// 外框颜色</span>
        <span class="token keyword">const</span> rBorderBg <span class="token operator">=</span> configData<span class="token punctuation">.</span>rBorderBg<span class="token punctuation">;</span> <span class="token comment">// 外框背景色</span>
        <span class="token keyword">const</span> rLinklineColor <span class="token operator">=</span> configData<span class="token punctuation">.</span>rLinklineColor<span class="token punctuation">;</span> <span class="token comment">// 连接线颜色</span>
        <span class="token keyword">const</span> titleFont <span class="token operator">=</span> configData<span class="token punctuation">.</span>titleFont<span class="token punctuation">;</span> <span class="token comment">// 字体大小</span>
        <span class="token keyword">const</span> titleColor <span class="token operator">=</span> configData<span class="token punctuation">.</span>titleColor<span class="token punctuation">;</span> <span class="token comment">// 字体大小</span>

        <span class="token comment">//清空画布</span>
        ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> canvasW<span class="token punctuation">,</span> canvasH<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 重新映射 canvas的 (0, 0)，映射的结果是让canvas的坐标原点位于 canvas的中心位</span>
        ctx<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span>canvasW <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> canvasH <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 多边形的边数</span>
        <span class="token keyword">const</span> mCount <span class="token operator">=</span> configData<span class="token punctuation">.</span>radarData<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mData<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token comment">// 需要旋转多少度，才能将多边形旋转到底边平行于 X轴，奇多边形才需要，偶多边形不需要旋转</span>
        <span class="token keyword">const</span> sAngle <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">90</span> <span class="token operator">/</span> mCount <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> rotateAngle <span class="token operator">=</span> mCount <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> sAngle <span class="token operator">*</span> <span class="token punctuation">(</span>mCount <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">===</span> <span class="token number">3</span> <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//底边平行x轴</span>
        <span class="token comment">// 多边形外接圆半径</span>
        <span class="token keyword">const</span> lCoordinates <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getCoordinatesByRadius</span><span class="token punctuation">(</span><span class="token constant">L_RADIUS</span><span class="token punctuation">,</span>mCount<span class="token punctuation">,</span><span class="token operator">-</span>rotateAngle<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 绘制边框线</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">renderBorder</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span>rBorderColor<span class="token punctuation">,</span> <span class="token constant">LINE_WIDTH</span><span class="token punctuation">,</span> <span class="token constant">L_RADIUS</span><span class="token punctuation">,</span> <span class="token operator">-</span>rotateAngle<span class="token punctuation">,</span> mCount<span class="token punctuation">,</span>rBorderBg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 绘制连接线</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">renderLinkLine</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>lCoordinates<span class="token punctuation">,</span>rLinklineColor<span class="token punctuation">,</span><span class="token constant">LINE_WIDTH</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 绘制文字</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">drawText</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span>lCoordinates<span class="token punctuation">,</span> configData<span class="token punctuation">.</span>radarData<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mData<span class="token punctuation">,</span> titleFont <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getRatio</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>titleColor<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 绘制雷达图</span>
        configData<span class="token punctuation">.</span>radarData<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">drawRadar</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span>item<span class="token punctuation">.</span>mData<span class="token punctuation">,</span><span class="token constant">L_RADIUS</span><span class="token punctuation">,</span><span class="token operator">-</span>rotateAngle<span class="token punctuation">,</span>item<span class="token punctuation">.</span>color<span class="token punctuation">,</span>item<span class="token punctuation">.</span>lineWidth<span class="token punctuation">,</span>item<span class="token punctuation">.</span>isFull<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    

      <span class="token doc-comment comment">/**
       * 获取多边形坐标
       * <span class="token keyword">@param</span> <span class="token parameter">mRadius</span> 半径
       * <span class="token keyword">@param</span> <span class="token parameter">mCount</span> 边数
       * <span class="token keyword">@param</span> <span class="token parameter">rotateAngle</span> 旋转角度
       * <span class="token keyword">@return</span> <span class="token punctuation">{</span>Array<span class="token punctuation">}</span>
       */</span>
      <span class="token function">getCoordinatesByRadius</span><span class="token punctuation">(</span>mRadius<span class="token punctuation">,</span> mCount<span class="token punctuation">,</span> rotateAngle <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> mAngle <span class="token operator">=</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> mCount<span class="token punctuation">;</span>
        <span class="token keyword">let</span> coordinates <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> mCount <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">let</span> x <span class="token operator">=</span> mRadius <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>mAngle <span class="token operator">*</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> rotateAngle<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">let</span> y <span class="token operator">=</span> mRadius <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>mAngle <span class="token operator">*</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> rotateAngle<span class="token punctuation">)</span><span class="token punctuation">;</span>
          coordinates<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> coordinates<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
    
      <span class="token doc-comment comment">/**
       * 绘制边框
       * <span class="token keyword">@param</span> <span class="token parameter">cxt</span> 上下文
       * <span class="token keyword">@param</span> <span class="token parameter">color</span> 线框颜色
       * <span class="token keyword">@param</span> <span class="token parameter">lineWidth</span> 线宽
       * <span class="token keyword">@param</span> <span class="token parameter">radius</span> 半径
       * <span class="token keyword">@param</span> <span class="token parameter">rotateAngle</span> 旋转角度
       * <span class="token keyword">@param</span> <span class="token parameter">background</span> 背景色
       */</span>
      <span class="token function">renderBorder</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span>color<span class="token punctuation">,</span>lineWidth<span class="token punctuation">,</span>radius<span class="token punctuation">,</span>rotateAngle<span class="token punctuation">,</span>mCount<span class="token punctuation">,</span>background<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> coordinates <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getCoordinatesByRadius</span><span class="token punctuation">(</span>radius<span class="token punctuation">,</span>mCount<span class="token punctuation">,</span>rotateAngle<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        coordinates<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>coordinate<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>coordinate<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> coordinate<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>coordinate<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> coordinate<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">setStrokeStyle</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">setLineWidth</span><span class="token punctuation">(</span>lineWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>background<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          ctx<span class="token punctuation">.</span><span class="token function">setFillStyle</span><span class="token punctuation">(</span>background<span class="token punctuation">)</span><span class="token punctuation">;</span>
          ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        ctx<span class="token punctuation">.</span><span class="token function">closePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
    
      <span class="token doc-comment comment">/**
       * 绘制连接线
       * <span class="token keyword">@param</span> <span class="token parameter">ctx</span> 上下文
       * <span class="token keyword">@param</span> <span class="token parameter">centerX</span> 中心x
       * <span class="token keyword">@param</span> <span class="token parameter">centerY</span> 中心y
       * <span class="token keyword">@param</span> <span class="token parameter">coordinates</span> 外边框坐标
       * <span class="token keyword">@param</span> <span class="token parameter">color</span> 连线颜色
       * <span class="token keyword">@param</span> <span class="token parameter">lineWidth</span> 连线宽度
       */</span>
      <span class="token function">renderLinkLine</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> centerX<span class="token punctuation">,</span> centerY<span class="token punctuation">,</span> coordinates<span class="token punctuation">,</span> color<span class="token punctuation">,</span> lineWidth<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        coordinates<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>coordinate<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>centerX<span class="token punctuation">,</span> centerY<span class="token punctuation">)</span><span class="token punctuation">;</span>
          ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>coordinate<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> coordinate<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          ctx<span class="token punctuation">.</span><span class="token function">setStrokeStyle</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>
          ctx<span class="token punctuation">.</span><span class="token function">setLineWidth</span><span class="token punctuation">(</span>lineWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
          ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          ctx<span class="token punctuation">.</span><span class="token function">closePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
    
      <span class="token doc-comment comment">/**
       * 绘制雷达图
       * <span class="token keyword">@param</span> <span class="token parameter">ctx</span> 上下文
       * <span class="token keyword">@param</span> <span class="token parameter">mData</span> 企业参数
       * <span class="token keyword">@param</span> <span class="token parameter">lRadius</span> 半径
       * <span class="token keyword">@param</span> <span class="token parameter">rotateAngle</span> 旋转角度
       * <span class="token keyword">@param</span> <span class="token parameter">color</span> 雷达图颜色
       * <span class="token keyword">@param</span> <span class="token parameter">lineWidth</span> 雷达图线宽
       * <span class="token keyword">@param</span> <span class="token parameter">isFill</span> 是否填充
       */</span>
      <span class="token function">drawRadar</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> mData<span class="token punctuation">,</span> lRadius<span class="token punctuation">,</span> rotateAngle <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> color<span class="token punctuation">,</span>lineWidth <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> isFill <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> mCount <span class="token operator">=</span> mData<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token keyword">let</span> radius <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        mData<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          radius<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>score <span class="token operator">/</span> item<span class="token punctuation">.</span>fullScore<span class="token punctuation">)</span> <span class="token operator">*</span> lRadius<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        radius<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span>mData<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>score <span class="token operator">/</span> mData<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fullScore<span class="token punctuation">)</span> <span class="token operator">*</span> lRadius<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> mAngle <span class="token operator">=</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> mCount<span class="token punctuation">;</span>
        <span class="token keyword">let</span> coordinates <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> mCount <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">let</span> x <span class="token operator">=</span> radius<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>mAngle <span class="token operator">*</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> rotateAngle<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">let</span> y <span class="token operator">=</span> radius<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>mAngle <span class="token operator">*</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> rotateAngle<span class="token punctuation">)</span><span class="token punctuation">;</span>
          coordinates<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        coordinates<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>coordinate<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>coordinate<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> coordinate<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>coordinate<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> coordinate<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">setStrokeStyle</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">setLineWidth</span><span class="token punctuation">(</span>lineWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>isFill<span class="token punctuation">)</span><span class="token punctuation">{</span>
          ctx<span class="token punctuation">.</span><span class="token function">setFillStyle</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>
          ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        ctx<span class="token punctuation">.</span><span class="token function">closePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">drawCircle</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span>coordinates<span class="token punctuation">,</span>color<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    

      <span class="token doc-comment comment">/**
       * 绘制圆点
       * <span class="token keyword">@param</span> <span class="token parameter">ctx</span> 上下文
       * <span class="token keyword">@param</span> <span class="token parameter">coordinates</span> 圆点坐标
       * <span class="token keyword">@param</span> <span class="token parameter">color</span> 圆点颜色
       */</span>
      <span class="token function-variable function">drawCircle</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span>coordinates<span class="token punctuation">,</span>color<span class="token punctuation">)</span><span class="token punctuation">{</span>
        ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> color<span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        coordinates<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>coordinate<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>coordinate<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> coordinate<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          ctx<span class="token punctuation">.</span><span class="token function">closePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
    
      <span class="token doc-comment comment">/**
       * 绘制文字
       * <span class="token keyword">@param</span> <span class="token parameter">ctx</span> 上下文
       * <span class="token keyword">@param</span> <span class="token parameter">coordinates</span> 文字坐标
       * <span class="token keyword">@param</span> <span class="token parameter">mData</span> 文字数据
       * <span class="token keyword">@param</span> <span class="token parameter">fontSize</span> 文字大小
       * <span class="token keyword">@param</span> <span class="token parameter">color</span> 文字颜色
       */</span>
      <span class="token function">drawText</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> coordinates<span class="token punctuation">,</span> mData<span class="token punctuation">,</span> fontSize<span class="token punctuation">,</span> color<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> yArr <span class="token operator">=</span> coordinates<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>coordinate <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> coordinate<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> maxY <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token operator">...</span>yArr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//最高点</span>
        <span class="token keyword">const</span> minY <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token operator">...</span>yArr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 最低点</span>
        <span class="token keyword">const</span> moveDistance <span class="token operator">=</span> <span class="token number">15</span> <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getRatio</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">setFontSize</span><span class="token punctuation">(</span>fontSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">setFillStyle</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>
        coordinates<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>coordinate<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>mData<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> x <span class="token operator">=</span> coordinate<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> y <span class="token operator">=</span> coordinate<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>maxY <span class="token operator">==</span> coordinate<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              y <span class="token operator">+=</span> moveDistance<span class="token punctuation">;</span>
              ctx<span class="token punctuation">.</span><span class="token function">setTextAlign</span><span class="token punctuation">(</span><span class="token string">&quot;center&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              ctx<span class="token punctuation">.</span><span class="token function">setTextBaseline</span><span class="token punctuation">(</span><span class="token string">&quot;top&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>minY <span class="token operator">==</span> coordinate<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              ctx<span class="token punctuation">.</span><span class="token function">setTextBaseline</span><span class="token punctuation">(</span><span class="token string">&quot;bottom&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              ctx<span class="token punctuation">.</span><span class="token function">setTextAlign</span><span class="token punctuation">(</span><span class="token string">&quot;center&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              y <span class="token operator">-=</span> moveDistance<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>coordinate<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              ctx<span class="token punctuation">.</span><span class="token function">setTextAlign</span><span class="token punctuation">(</span><span class="token string">&quot;right&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              ctx<span class="token punctuation">.</span><span class="token function">setTextBaseline</span><span class="token punctuation">(</span><span class="token string">&quot;middle&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              x <span class="token operator">-=</span> moveDistance<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>coordinate<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              ctx<span class="token punctuation">.</span><span class="token function">setTextAlign</span><span class="token punctuation">(</span><span class="token string">&quot;left&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              ctx<span class="token punctuation">.</span><span class="token function">setTextBaseline</span><span class="token punctuation">(</span><span class="token string">&quot;middle&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              x <span class="token operator">+=</span> moveDistance<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span>mData<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>title<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>


      <span class="token doc-comment comment">/**
       * 获取系统信息
       */</span>
      <span class="token function">getRatio</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> systemInfo <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getSystemInfoSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> ratio <span class="token operator">=</span> <span class="token number">750</span> <span class="token operator">/</span> systemInfo<span class="token punctuation">.</span>windowWidth<span class="token punctuation">;</span> <span class="token comment">// rpx/px比例</span>
        <span class="token keyword">return</span> ratio<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token punctuation">}</span>


module<span class="token punctuation">.</span>exports <span class="token operator">=</span> myCanvas<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="接口数据缓存方案" tabindex="-1"><a class="header-anchor" href="#接口数据缓存方案" aria-hidden="true">#</a> 接口数据缓存方案</h2><h3 id="data数据缓存" tabindex="-1"><a class="header-anchor" href="#data数据缓存" aria-hidden="true">#</a> data数据缓存</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 声明Map对象缓存数据******</span>
<span class="token keyword">const</span> dataCache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">let</span> key <span class="token operator">=</span> name
    <span class="token comment">// 从data 缓存中获取 数据******</span>
    <span class="token keyword">let</span> data <span class="token operator">=</span> dataCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">// 返回缓存数据******</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span> <span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
      <span class="token comment">// 没有缓存重新请求接口******</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dataCache<span class="token punctuation">)</span>
      
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        http<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            
          dataCache<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token comment">// 设置缓存******</span>
          
          <span class="token keyword">return</span> <span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>err <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            
          dataCache<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token comment">// 清除异常数据******</span>
          
          <span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="接口缓存promise方案" tabindex="-1"><a class="header-anchor" href="#接口缓存promise方案" aria-hidden="true">#</a> 接口缓存promise方案</h3><ul><li>开关控制，设置有效期，惰性+主动删除过期数据，key名=接口名+参数，map()，promise缓存同一时间同一接口并发</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// promise方案</span>

<span class="token keyword">class</span> <span class="token class-name">ItemCache</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>promise<span class="token punctuation">,</span> timeout<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// data可存返回数据，也可存promise</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>promise <span class="token operator">=</span> promise
      <span class="token comment">// 设定超时时间，设定为多少秒</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>timeout <span class="token operator">=</span> timeout
      <span class="token comment">// 创建对象时候的时间，大约设定为数据获得的时间</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>cacheTime <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">ExpriesCache</span> <span class="token punctuation">{</span>
  <span class="token comment">// 定义静态数据map来作为缓存池</span>
  <span class="token keyword">static</span> cacheMap <span class="token operator">=</span>  <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 数据是否超时</span>
  <span class="token keyword">static</span> <span class="token function">isOverTime</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> promise <span class="token operator">=</span> ExpriesCache<span class="token punctuation">.</span>cacheMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
      <span class="token comment">// 没有数据 判定超时</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>promise<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span>
      <span class="token comment">// 获取系统当前时间戳</span>
      <span class="token keyword">const</span> currentTime <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        
      <span class="token comment">// 获取当前时间与存储时间的过去的秒数</span>
      <span class="token keyword">const</span> overTime <span class="token operator">=</span> <span class="token punctuation">(</span>currentTime <span class="token operator">-</span> promise<span class="token punctuation">.</span>cacheTime<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000</span>
      <span class="token comment">// 如果过去的秒数大于当前的超时时间，也返回null让其去服务端取数据</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>overTime<span class="token punctuation">)</span> <span class="token operator">&gt;</span> promise<span class="token punctuation">.</span>timeout<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 惰性清除过期数据</span>
          ExpriesCache<span class="token punctuation">.</span>cacheMap<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
          <span class="token keyword">return</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 不超时</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 当前data在 cache 中是否超时</span>
  <span class="token keyword">static</span> <span class="token function">has</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token operator">!</span>ExpriesCache<span class="token punctuation">.</span><span class="token function">isOverTime</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 删除 cache 中的 data</span>
  <span class="token keyword">static</span> <span class="token keyword">delete</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> ExpriesCache<span class="token punctuation">.</span>cacheMap<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> 
  <span class="token punctuation">}</span>
  <span class="token comment">// 获取缓存</span>
  <span class="token keyword">static</span> <span class="token function">get</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> isDataOverTiem <span class="token operator">=</span> ExpriesCache<span class="token punctuation">.</span><span class="token function">isOverTime</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>isDataOverTiem<span class="token punctuation">)</span>
      <span class="token comment">//如果 数据超时，返回null，但是没有超时，返回promise</span>
      <span class="token keyword">return</span> isDataOverTiem <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> ExpriesCache<span class="token punctuation">.</span>cacheMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span>promise
  <span class="token punctuation">}</span>
  <span class="token comment">// 设置存储，默认过期时间600秒</span>
  <span class="token keyword">static</span> <span class="token function">set</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> promise<span class="token punctuation">,</span> timeout <span class="token operator">=</span> <span class="token number">600</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 设置 itemCache</span>
      <span class="token keyword">const</span> itemCache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ItemCache</span><span class="token punctuation">(</span>promise<span class="token punctuation">,</span> timeout<span class="token punctuation">)</span>
      <span class="token comment">// 缓存</span>
      ExpriesCache<span class="token punctuation">.</span>cacheMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> itemCache<span class="token punctuation">)</span>
      <span class="token comment">// 定时器主动清除过期数据</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;删除改过期数据&#39;</span><span class="token punctuation">,</span>name<span class="token punctuation">)</span>
        ExpriesCache<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> timeout<span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ExpriesCache<span class="token punctuation">.</span>cacheMap<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 声明key接口名 name+参数拼接</span>
  <span class="token keyword">static</span> <span class="token function">getName</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> paramsUrl <span class="token operator">=</span> tool<span class="token punctuation">.</span><span class="token function">paramsUrl</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>
    <span class="token keyword">const</span> key <span class="token operator">=</span> name <span class="token operator">+</span> paramsUrl
    <span class="token keyword">return</span> key
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


actions<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> name <span class="token operator">=</span> item<span class="token punctuation">.</span>name <span class="token operator">||</span> item<span class="token punctuation">.</span>action<span class="token punctuation">;</span>
  api<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">async</span> params <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    params <span class="token operator">=</span> params <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token keyword">in</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      params<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> params<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">?</span> params<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token string">&#39;&#39;</span> <span class="token operator">:</span> params<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> api<span class="token punctuation">.</span><span class="token function">getopenid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> opendata <span class="token operator">=</span> <span class="token punctuation">{</span>
      openid<span class="token operator">:</span> result<span class="token punctuation">[</span><span class="token string">&quot;openid&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      sign<span class="token operator">:</span> result<span class="token punctuation">[</span><span class="token string">&quot;sign&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>action <span class="token operator">===</span> <span class="token string">&#39;get_union_id&#39;</span> <span class="token operator">||</span> item<span class="token punctuation">.</span>action <span class="token operator">===</span> <span class="token string">&#39;wx_decode_data&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      opendata<span class="token punctuation">[</span><span class="token string">&quot;session_key&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token string">&#39;session_key&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 是否开启缓存,获取属性后删除</span>
    <span class="token comment">// let isCache = params &amp;&amp; params.isCache</span>
    <span class="token comment">// params &amp;&amp; params.isCache &amp;&amp; delete params.isCache</span>

    <span class="token keyword">let</span> isCache <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token comment">// 生成key</span>
    <span class="token keyword">let</span> key <span class="token operator">=</span> ExpriesCache<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 获得数据</span>
    <span class="token keyword">let</span> promise <span class="token operator">=</span> ExpriesCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>isCache <span class="token operator">&amp;&amp;</span> promise<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">// 返回缓存数据******</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
      <span class="token keyword">return</span> promise
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
      <span class="token keyword">const</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        http<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          url<span class="token operator">:</span> item<span class="token punctuation">.</span>url<span class="token punctuation">,</span>
          data<span class="token operator">:</span> <span class="token punctuation">{</span>
            action<span class="token operator">:</span> item<span class="token punctuation">.</span>action<span class="token punctuation">,</span>
            t<span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token operator">...</span>opendata<span class="token punctuation">,</span>
            <span class="token operator">...</span>params<span class="token punctuation">,</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>err <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token comment">// 添加请求状态</span>
      isCache <span class="token operator">&amp;&amp;</span> ExpriesCache<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> promise<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span><span class="token punctuation">)</span> 
      <span class="token keyword">return</span> promise
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序工具函数封装" tabindex="-1"><a class="header-anchor" href="#小程序工具函数封装" aria-hidden="true">#</a> 小程序工具函数封装</h2><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">/*
  @description: 工具函数模块
  @author: hhd (2021-11-23)
  @使用方式：
    导入： import tool from &#39;/common/tool&#39;;
    调用： tool.isTelMobile(this.data.phone)
 */</span>


<span class="token keyword">var</span> tool <span class="token operator">=</span> <span class="token punctuation">{</span> 

  <span class="token doc-comment comment">/************************ 正则验证函数 ***********************/</span>
  <span class="token doc-comment comment">/**
   * 身份证号码验证
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>number<span class="token punctuation">}</span> value 
   * <span class="token keyword">@returns</span> <span class="token punctuation">{</span>boolean<span class="token punctuation">}</span>
   */</span>
  <span class="token function-variable function">checkIdCard</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token doc-comment comment">/**
   * 手机号码+固定电话验证
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>number<span class="token punctuation">}</span> value 
   * <span class="token keyword">@returns</span> <span class="token punctuation">{</span>boolean<span class="token punctuation">}</span>
   */</span>
  <span class="token function-variable function">isTelMobile</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^1\d{10}$|^(0\d{2,3}-?|\(0\d{2,3}\))?[1-9]\d{4,7}(-\d{1,8})?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token doc-comment comment">/**
   * 手机号码验证
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>number<span class="token punctuation">}</span> value 
   * <span class="token keyword">@returns</span> <span class="token punctuation">{</span>boolean<span class="token punctuation">}</span>
   */</span>
  <span class="token function-variable function">isMobile</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^1[3456789]\d{9}$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token doc-comment comment">/**
   * 固定电话验证
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>number<span class="token punctuation">}</span> value 
   * <span class="token keyword">@returns</span> <span class="token punctuation">{</span>boolean<span class="token punctuation">}</span>
   */</span>
  <span class="token function-variable function">isTel</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^0\d{2,3}-?\d{7,8}$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token doc-comment comment">/**
   * 邮箱验证
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>number<span class="token punctuation">}</span> value 
   * <span class="token keyword">@returns</span> <span class="token punctuation">{</span>boolean<span class="token punctuation">}</span>
   */</span>
  <span class="token function-variable function">isEmail</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token doc-comment comment">/**
   * 数字验证
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>number<span class="token punctuation">}</span> value 
   * <span class="token keyword">@returns</span> <span class="token punctuation">{</span>boolean<span class="token punctuation">}</span>
   */</span>
  <span class="token function-variable function">isNumber</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^[0-9]*$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token doc-comment comment">/**
   * 中文汉字验证
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>number<span class="token punctuation">}</span> value 
   * <span class="token keyword">@returns</span> <span class="token punctuation">{</span>boolean<span class="token punctuation">}</span>
   */</span>
  <span class="token function-variable function">isChinese</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^[\u4e00-\u9fa5]{0,}$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token doc-comment comment">/************************* 字符串处理函数 ************************/</span>
  <span class="token doc-comment comment">/**
   * 手机号中间四位变成*, 手机号隐藏
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>string,number<span class="token punctuation">}</span> value 
   * <span class="token keyword">@returns</span> <span class="token punctuation">{</span>string<span class="token punctuation">}</span>
   */</span> 
  <span class="token function-variable function">telFormat</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> tel <span class="token operator">=</span> <span class="token function">String</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">return</span> tel<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;****&quot;</span> <span class="token operator">+</span> tel<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token doc-comment comment">/**
   * 获取url链接参数，返回参数对象
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>string<span class="token punctuation">}</span> url 
   * <span class="token keyword">@returns</span> <span class="token punctuation">{</span>object<span class="token punctuation">}</span>
   */</span>  
  <span class="token function-variable function">getUrlOptions</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> params <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;?&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;&amp;&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    params<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> obj<span class="token punctuation">[</span>item<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;=&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;=&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> obj
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token doc-comment comment">/**
   * 键值对拼接成URL参数
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>object<span class="token punctuation">}</span> obj 键值对参数
   * <span class="token keyword">@returns</span> <span class="token punctuation">{</span>string<span class="token punctuation">}</span> url参数
   */</span>  
  <span class="token function-variable function">paramsUrl</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> params <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
     <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       params<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">return</span> params<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;&amp;&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token doc-comment comment">/************************** 时间操作函数 ************************/</span>
  <span class="token doc-comment comment">/**
   * 获取当前时间
   * <span class="token keyword">@returns</span> <span class="token punctuation">{</span>string<span class="token punctuation">}</span>
   */</span>  
  <span class="token function-variable function">getNowTime</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> now <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> year <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> month <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> date <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">10</span> <span class="token operator">?</span> now<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token string">&#39;0&#39;</span> <span class="token operator">+</span> now<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> hour <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">10</span> <span class="token operator">?</span> now<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token string">&#39;0&#39;</span> <span class="token operator">+</span> now<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> miu <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">10</span> <span class="token operator">?</span> now<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token string">&#39;0&#39;</span> <span class="token operator">+</span> now<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> sec <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">10</span> <span class="token operator">?</span> now<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token string">&#39;0&#39;</span> <span class="token operator">+</span> now<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">+</span>year <span class="token operator">+</span> <span class="token string">&quot;年&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>month <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;月&quot;</span> <span class="token operator">+</span> date <span class="token operator">+</span> <span class="token string">&quot;日 &quot;</span> <span class="token operator">+</span> hour <span class="token operator">+</span> <span class="token string">&quot;:&quot;</span> <span class="token operator">+</span> miu <span class="token operator">+</span> <span class="token string">&quot;:&quot;</span> <span class="token operator">+</span> sec<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token doc-comment comment">/**
   * 格式化时间
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>string<span class="token punctuation">}</span> formater 时间格式 YYYY-MM-DD HH:mm:ss
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>string,Date<span class="token punctuation">}</span> time 传入时间
   * <span class="token keyword">@returns</span> <span class="token punctuation">{</span>string<span class="token punctuation">}</span>
   * <span class="token keyword">@description</span> dateFormater(&#39;YYYY-MM-DD HH:mm:ss&#39;)  默认取当前时间
   * <span class="token keyword">@description</span> dateFormater(&#39;YYYY年MM月DD日&#39;, this.data.time)
   */</span>  
  <span class="token function-variable function">dateFormater</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>formater<span class="token punctuation">,</span> time<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> date <span class="token operator">=</span> time <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token constant">Y</span> <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    <span class="token constant">M</span> <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token constant">D</span> <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token constant">H</span> <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    m <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    s <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> formater<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">YYYY|yyyy</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token constant">Y</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">YY|yy</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token constant">Y</span><span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">MM</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token constant">M</span><span class="token operator">&lt;</span><span class="token number">10</span> <span class="token operator">?</span> <span class="token string">&#39;0&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">M</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">DD</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token constant">D</span><span class="token operator">&lt;</span><span class="token number">10</span> <span class="token operator">?</span> <span class="token string">&#39;0&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">D</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">HH|hh</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token constant">H</span><span class="token operator">&lt;</span><span class="token number">10</span> <span class="token operator">?</span> <span class="token string">&#39;0&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">H</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">mm</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token punctuation">(</span>m<span class="token operator">&lt;</span><span class="token number">10</span> <span class="token operator">?</span> <span class="token string">&#39;0&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token operator">+</span> m<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">ss</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token punctuation">(</span>s<span class="token operator">&lt;</span><span class="token number">10</span> <span class="token operator">?</span> <span class="token string">&#39;0&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token operator">+</span> s<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> tool<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="全局loading解决方案" tabindex="-1"><a class="header-anchor" href="#全局loading解决方案" aria-hidden="true">#</a> 全局loading解决方案</h2><ul><li>未解决同步请求闪烁问题</li><li>可以用axios拦截器，或者函数工具封装</li><li>扩展：设置一个延迟关闭时间，设置 500 及loading至少展示半秒，防闪烁；或者使用防抖；</li><li>扩展：或者只使用 loadingCount 控制，再给定一个超时关闭loading的时间。</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">let</span> loadingCount <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">// 记录当前正在请求的数量</span>
<span class="token keyword">let</span> isLoading <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token comment">// 是否存着loading</span>
<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>res<span class="token punctuation">,</span> rej<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>loadingCount <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isLoading<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    wx<span class="token punctuation">.</span><span class="token function">showLoading</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      title<span class="token operator">:</span> <span class="token string">&#39;加载中&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    isLoading <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
  loadingCount <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    url<span class="token operator">:</span> obj<span class="token punctuation">.</span>url <span class="token operator">?</span> obj<span class="token punctuation">.</span>url <span class="token operator">:</span> baseApi<span class="token punctuation">,</span>
    data<span class="token operator">:</span> obj<span class="token punctuation">.</span>data <span class="token operator">?</span> obj<span class="token punctuation">.</span>data <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    method<span class="token operator">:</span> obj<span class="token punctuation">.</span>method <span class="token operator">?</span> obj<span class="token punctuation">.</span>method <span class="token operator">:</span> <span class="token string">&#39;GET&#39;</span><span class="token punctuation">,</span>
    header<span class="token operator">:</span> header<span class="token punctuation">,</span>
    <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">res</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">rej</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">complete</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>loadingCount <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>loadingCount<span class="token punctuation">)</span>
      loadingCount <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>loadingCount <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> isLoading<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        wx<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        isLoading <span class="token operator">=</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="扫码进入小程序参数解析" tabindex="-1"><a class="header-anchor" href="#扫码进入小程序参数解析" aria-hidden="true">#</a> 扫码进入小程序参数解析</h2><ul><li>在<code>onLoad(options)</code>中获取<code>options.q</code>，q是转码后的url，（http://sjdk.com?dad=1&amp;ds=2)</li><li>deCode解码url后，调用url获参函数，将url中的参数转为对象，重新复制给options</li></ul><p><img src="/myblog/images/frontEnd/img_7.png" alt="图片"></p><h2 id="小程序input双向绑定" tabindex="-1"><a class="header-anchor" href="#小程序input双向绑定" aria-hidden="true">#</a> 小程序input双向绑定</h2><ul><li>模拟语法糖 绑定<code>bindinput</code>输入事件 绑定<code>value=&quot;{{}}&quot;</code>中的变量</li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>weui-input<span class="token punctuation">&quot;</span></span> 
       <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>input<span class="token punctuation">&quot;</span></span> 
       <span class="token attr-name">bindinput</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>getCredit<span class="token punctuation">&quot;</span></span> 
       <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{credit_no}}<span class="token punctuation">&quot;</span></span> 
       <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>该企业的纳税识别号<span class="token punctuation">&quot;</span></span> 
<span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>input中value值赋值给变量</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token function">getCredit</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      credit_no<span class="token operator">:</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="全表单双向绑定" tabindex="-1"><a class="header-anchor" href="#全表单双向绑定" aria-hidden="true">#</a> 全表单双向绑定</h3><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>input-box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>title-box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>属于免征纳税对象 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>radio-group</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>radio<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bindchange</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>radioChange<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>is_no_tax_group<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>radio</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#1ec56a<span class="token punctuation">&quot;</span></span> <span class="token attr-name">checked</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{data_options.is_no_tax_group==<span class="token punctuation">&#39;</span>1<span class="token punctuation">&#39;</span>}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>是<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>radio</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#1ec56a<span class="token punctuation">&quot;</span></span> <span class="token attr-name">checked</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{data_options.is_no_tax_group==<span class="token punctuation">&#39;</span>0<span class="token punctuation">&#39;</span>}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>否<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>radio-group</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>input input2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span> 纳税总额 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
        <span class="token attr-name">bindinput</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bindInput<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">bindfocus</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>inputFocus<span class="token punctuation">&quot;</span></span> 
        <span class="token attr-name">data-item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>total_tax_amount<span class="token punctuation">&quot;</span></span> 
        <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{data_options.total_tax_amount}}<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">placeholder-style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>color:#999<span class="token punctuation">&quot;</span></span> 
        <span class="token attr-name">disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{totalTaxDisabled}}<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>digit<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>请输入金额<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>unit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>元<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code> <span class="token doc-comment comment">/*********** 表单内容data数据 ************/</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    data_options<span class="token operator">:</span><span class="token punctuation">{</span> <span class="token punctuation">}</span> <span class="token comment">// 表单对象</span>
 <span class="token punctuation">}</span>
  
  
  <span class="token doc-comment comment">/**
   * 表单双向绑定
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>string<span class="token punctuation">}</span> e.currentTarget.dataset.item： Input标识
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>string<span class="token punctuation">}</span> e.detail.value：输入值
   */</span>
  <span class="token keyword">function</span> <span class="token function">bindInput</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> item<span class="token operator">=</span>e<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>item<span class="token punctuation">;</span> <span class="token comment">// 绑定不同标识</span>
    <span class="token keyword">const</span> data_options<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>data_options
    data_options<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token operator">=</span>e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value <span class="token comment">// 对象动态赋值</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> data_options <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>


  <span class="token doc-comment comment">/**
   * 单选按钮双向绑定
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>string<span class="token punctuation">}</span> e.currentTarget.dataset.item： radio标识
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>string<span class="token punctuation">}</span> e.detail.value：选中值
   */</span>
  <span class="token keyword">function</span> <span class="token function">radioChange</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> item<span class="token operator">=</span>e<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>item<span class="token punctuation">;</span>  <span class="token comment">// 绑定不同标识</span>
    <span class="token keyword">const</span> data_options<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>data_options
    data_options<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token operator">=</span>e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value <span class="token comment">// 对象动态赋值</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> data_options <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>item <span class="token operator">==</span> <span class="token string">&#39;is_no_tax_group&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isNOTax</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 是否免征纳税控制</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序switchtab跳转传参和刷新页面解决方案" tabindex="-1"><a class="header-anchor" href="#小程序switchtab跳转传参和刷新页面解决方案" aria-hidden="true">#</a> 小程序switchTab跳转传参和刷新页面解决方案</h2><h3 id="使用wx-relaunch" tabindex="-1"><a class="header-anchor" href="#使用wx-relaunch" aria-hidden="true">#</a> 使用wx.reLaunch</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token doc-comment comment">/** 
   * 查老赖——前往认领支付
   */</span> 
  <span class="token keyword">function</span> <span class="token function">toCreditCheck</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">homeClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 首页按钮是否点击统计</span>
    wx<span class="token punctuation">.</span><span class="token function">reLaunch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/pages/center/index?product_type=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>product_type<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;digest=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>digest<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="调用页面栈刷新页面" tabindex="-1"><a class="header-anchor" href="#调用页面栈刷新页面" aria-hidden="true">#</a> 调用页面栈刷新页面</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 调用页面栈刷新页面</span>
wx<span class="token punctuation">.</span><span class="token function">switchTab</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      url<span class="token operator">:</span> <span class="token string">&quot;/pages/classify/classify&quot;</span><span class="token punctuation">,</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// 此方法相当于刷新页面</span>
        <span class="token keyword">var</span> page <span class="token operator">=</span> <span class="token function">getCurrentPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取当前页面栈</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>page <span class="token operator">==</span> <span class="token keyword">undefined</span> <span class="token operator">||</span> page <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
        page<span class="token punctuation">.</span><span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// onShow执行this.onLoad刷新</span>
<span class="token function-variable function">onShow</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="使用全局变量和缓存" tabindex="-1"><a class="header-anchor" href="#使用全局变量和缓存" aria-hidden="true">#</a> 使用全局变量和缓存</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 1、设置全局变量传参</span>
<span class="token comment">// 设置参数：</span>
<span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>index <span class="token operator">=</span> <span class="token number">12321</span>
<span class="token comment">// 获取参数：</span>
<span class="token keyword">let</span> index<span class="token operator">=</span><span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>index

<span class="token comment">// 本地缓存</span>
<span class="token keyword">let</span> risk_data <span class="token operator">=</span> <span class="token punctuation">{</span>
    product_type <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>product_type<span class="token punctuation">,</span> 
    digest <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>digest<span class="token punctuation">,</span> 
    id <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>id<span class="token punctuation">,</span> 
<span class="token punctuation">}</span> 
wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">&#39;risk_data&#39;</span><span class="token punctuation">,</span>risk_data<span class="token punctuation">)</span>

risk_data <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">&#39;risk_data&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  digest<span class="token operator">:</span> risk_data<span class="token punctuation">.</span>digest<span class="token punctuation">,</span>
  kp_id<span class="token operator">:</span> risk_data<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
  product_type<span class="token operator">:</span> risk_data<span class="token punctuation">.</span>product_type<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
wx<span class="token punctuation">.</span><span class="token function">removeStorageSync</span><span class="token punctuation">(</span><span class="token string">&#39;risk_data&#39;</span><span class="token punctuation">)</span>  <span class="token comment">// 删除缓存</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="伪元素放大点击区域" tabindex="-1"><a class="header-anchor" href="#伪元素放大点击区域" aria-hidden="true">#</a> 伪元素放大点击区域</h2><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fater<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>focus<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>changeAgreeCheck<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-scss ext-scss line-numbers-mode"><pre class="language-scss"><code><span class="token comment">/* 放大点击区域功能类 */</span>
<span class="token selector">.focus</span><span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span>relative<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.focus::after</span><span class="token punctuation">{</span>
  <span class="token property">content</span><span class="token punctuation">:</span><span class="token string">&#39;&#39;</span><span class="token punctuation">;</span> 
  <span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span>60rpx<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span>60rpx<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span>50%<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span>50%<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span>-50%<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.fater .focus::after</span><span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span>30rpx<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span>30rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序规避审核方法" tabindex="-1"><a class="header-anchor" href="#小程序规避审核方法" aria-hidden="true">#</a> 小程序规避审核方法</h2><h3 id="问题分析" tabindex="-1"><a class="header-anchor" href="#问题分析" aria-hidden="true">#</a> 问题分析</h3><ul><li>贷款：添加贷款类目：需要相关资质</li><li>催债：不可发布相关内容</li></ul><h3 id="审核机制" tabindex="-1"><a class="header-anchor" href="#审核机制" aria-hidden="true">#</a> 审核机制</h3><ul><li>业务操作演示</li><li>代码内容审核（可能有关键词检索，或者单独打开某页面）</li><li>不能有空不功能不全的内容（需要有假业务逻辑代替）</li><li>主要关注该版本上线内容，与其他业务同时上线成功率更好（单独上线违规内容会被针对）</li><li>同一版本审核不通过可能会有标记，最好跳过一个版本再提审</li></ul><h3 id="方法总结" tabindex="-1"><a class="header-anchor" href="#方法总结" aria-hidden="true">#</a> 方法总结</h3><ul><li>后台数据控制：去掉前端关键字，注释，后端返回数据代替；</li><li>给审核人员看一套：设置倒计时：1天后打开，或者绑定企业才可见</li><li>反复不通过尝试跳过这个版本，再发布审核（未通过）</li></ul><h3 id="解决方案-1" tabindex="-1"><a class="header-anchor" href="#解决方案-1" aria-hidden="true">#</a> 解决方案</h3><ul><li>债务关键信息内容，后台接口返回；贷款链接后台接口返回；提审小程序通过后，后台再发布，</li><li>后续如遇到审核不通过，修改后台状态重复上面步骤</li></ul><h2 id="小程序echart图表使用" tabindex="-1"><a class="header-anchor" href="#小程序echart图表使用" aria-hidden="true">#</a> 小程序echart图表使用</h2><ul><li>github下载地址: <a href="https://github.com/ecomfe/echarts-for-weixin" target="_blank" rel="noopener noreferrer">echarts-for-weixin<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>下载<code>ec-canvas</code>包在小程序内</li></ul><p><img src="/myblog/images/frontEnd/img_8.png" alt="图片"></p><ul><li><code>index.json</code>注入组件</li></ul><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;usingComponents&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;ec-canvas&quot;</span><span class="token operator">:</span> <span class="token string">&quot;../../../../ec-canvas/ec-canvas&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>使用</li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>echarts<span class="token punctuation">&quot;</span></span> <span class="token attr-name">hidden</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&#39;</span>{{submitFlag}}<span class="token punctuation">&#39;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ec-canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mychart<span class="token punctuation">&quot;</span></span> <span class="token attr-name">canvas-id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&#39;</span>mychart-line<span class="token punctuation">&#39;</span></span> <span class="token attr-name">ec</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{ec}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ec-canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> echarts <span class="token keyword">from</span> <span class="token string">&#39;../../../../ec-canvas/echarts&#39;</span><span class="token punctuation">;</span>

<span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 图标初始化</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>echartsComponnet <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">selectComponent</span><span class="token punctuation">(</span><span class="token string">&#39;#mychart&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">init_echarts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 构建echart</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>


<span class="token doc-comment comment">/**
 * 图表初始化
 */</span>
<span class="token function-variable function">init_echarts</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>echartsComponnet<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">(</span>canvas<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 初始化图表</span>
    <span class="token keyword">const</span> Chart <span class="token operator">=</span> echarts<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>canvas<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      width<span class="token operator">:</span> width<span class="token punctuation">,</span>
      height<span class="token operator">:</span> height
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Chart<span class="token punctuation">.</span><span class="token function">setOption</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getOption</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 注意这里一定要返回 chart 实例，否则会影响事件处理等</span>
    <span class="token keyword">return</span> Chart<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>


<span class="token doc-comment comment">/**
 *配置数据
 */</span>
<span class="token function-variable function">getOption</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token comment">// 处理数据 </span>
  <span class="token keyword">let</span> myCompanyValue <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  myCompanyValue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>myCompany<span class="token punctuation">.</span>operate_score<span class="token punctuation">)</span>
  myCompanyValue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>myCompany<span class="token punctuation">.</span>risk_score<span class="token punctuation">)</span>
  myCompanyValue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>myCompany<span class="token punctuation">.</span>honesty_score<span class="token punctuation">)</span>
  <span class="token keyword">let</span> otherCompanyValue <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  otherCompanyValue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>otherCompany<span class="token punctuation">.</span>operate_score<span class="token punctuation">)</span>
  otherCompanyValue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>otherCompany<span class="token punctuation">.</span>risk_score<span class="token punctuation">)</span>
  otherCompanyValue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>otherCompany<span class="token punctuation">.</span>honesty_score<span class="token punctuation">)</span>

  <span class="token keyword">var</span> option <span class="token operator">=</span> <span class="token punctuation">{</span>
    backgroundColor<span class="token operator">:</span> <span class="token string">&quot;rgba(0,0,0,0)&quot;</span><span class="token punctuation">,</span>
    color<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;#63d798&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#dd3239&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    tooltip<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    xAxis<span class="token operator">:</span> <span class="token punctuation">{</span>
      show<span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    yAxis<span class="token operator">:</span> <span class="token punctuation">{</span>
      show<span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    radar<span class="token operator">:</span> <span class="token punctuation">{</span>
      indicator<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">&#39;经营能力&#39;</span><span class="token punctuation">,</span>
        max<span class="token operator">:</span> <span class="token number">164</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token string">&#39;合规履约&#39;</span><span class="token punctuation">,</span>
          max<span class="token operator">:</span> <span class="token number">173</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token string">&#39;诚信意愿&#39;</span><span class="token punctuation">,</span>
          max<span class="token operator">:</span> <span class="token number">163</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    series<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>myCompany<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> vs </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>otherCompany<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      type<span class="token operator">:</span> <span class="token string">&#39;radar&#39;</span><span class="token punctuation">,</span>
      data<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        value<span class="token operator">:</span> myCompanyValue<span class="token punctuation">,</span>
        name<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>myCompany<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          value<span class="token operator">:</span> otherCompanyValue<span class="token punctuation">,</span>
          name<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>otherCompany<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> option<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序内跳转其他小程序" tabindex="-1"><a class="header-anchor" href="#小程序内跳转其他小程序" aria-hidden="true">#</a> 小程序内跳转其他小程序</h2><h3 id="navigatetominiprogram-api跳转" tabindex="-1"><a class="header-anchor" href="#navigatetominiprogram-api跳转" aria-hidden="true">#</a> navigateToMiniProgram api跳转</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 打开水滴小程序</span>
wx<span class="token punctuation">.</span><span class="token function">navigateToMiniProgram</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  appId<span class="token operator">:</span> <span class="token string">&#39;wxdc49880077ff6a04&#39;</span><span class="token punctuation">,</span>  <span class="token comment">// appid 必填</span>
  path<span class="token operator">:</span> <span class="token string">&#39;/pages/home/home&#39;</span><span class="token punctuation">,</span><span class="token comment">// path 非必填：默认到首页</span>
  extraData<span class="token operator">:</span> <span class="token punctuation">{</span>navType<span class="token operator">:</span> <span class="token string">&quot;shuidimin&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 参数</span>
  envVersion<span class="token operator">:</span> <span class="token string">&#39;release&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 开发版:develop  体验版:trial  正式版:release  </span>
  <span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 打开成功回调</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="navigator标签跳转" tabindex="-1"><a class="header-anchor" href="#navigator标签跳转" aria-hidden="true">#</a> navigator标签跳转</h3><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>navigator</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>miniProgram<span class="token punctuation">&quot;</span></span> <span class="token attr-name">open-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>navigate<span class="token punctuation">&quot;</span></span> <span class="token attr-name">app-id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>release<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>navigator</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="注意事项" tabindex="-1"><a class="header-anchor" href="#注意事项" aria-hidden="true">#</a> 注意事项</h3><ul><li>从 2.3.0 版本开始，若用户未点击小程序页面任意位置，则开发者将无法调用此接口自动跳转至其他小程序。</li><li>需要用户确认跳转;在跳转至其他小程序前，将统一增加弹窗，询问是否跳转，用户确认后才可以跳转其他小程序。如果用户点击取消，则回调 fail cancel。</li></ul><h2 id="小程序图片上传" tabindex="-1"><a class="header-anchor" href="#小程序图片上传" aria-hidden="true">#</a> 小程序图片上传</h2><h3 id="wux-uploader组件" tabindex="-1"><a class="header-anchor" href="#wux-uploader组件" aria-hidden="true">#</a> wux-uploader组件</h3><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>upload<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wux-upload</span> 
    <span class="token attr-name">listType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>picture-card<span class="token punctuation">&quot;</span></span> 
    <span class="token attr-name">sizeType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{ compressed }}<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">fileList</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{ fileList }}<span class="token punctuation">&quot;</span></span> 
    <span class="token attr-name">controlled</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>.........di.cn/uploadimage<span class="token punctuation">&quot;</span></span> 
    <span class="token attr-name"><span class="token namespace">bind:</span>change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onChange<span class="token punctuation">&quot;</span></span> 
    <span class="token attr-name"><span class="token namespace">bind:</span>success</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onSuccess<span class="token punctuation">&quot;</span></span> 
    <span class="token attr-name"><span class="token namespace">bind:</span>fail</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onFail<span class="token punctuation">&quot;</span></span> 
    <span class="token attr-name"><span class="token namespace">bind:</span>complete</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onComplete<span class="token punctuation">&quot;</span></span> 
    <span class="token attr-name"><span class="token namespace">bind:</span>preview</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onPreview<span class="token punctuation">&quot;</span></span> 
    <span class="token attr-name"><span class="token namespace">bind:</span>remove</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onRemove<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>+<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wux-upload</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>buttons<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>left<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>上传交易截图或合同资料<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>资料仅用于验证，不公开展示<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wux-upload</span> 
      <span class="token attr-name">fileList</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{ fileList }}<span class="token punctuation">&quot;</span></span> 
      <span class="token attr-name">controlled</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>.........di.cn/uploadimage<span class="token punctuation">&quot;</span></span> 
      <span class="token attr-name">sizeType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{compressed}}<span class="token punctuation">&quot;</span></span> 
      <span class="token attr-name"><span class="token namespace">bind:</span>change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onChange<span class="token punctuation">&quot;</span></span> 
      <span class="token attr-name"><span class="token namespace">bind:</span>success</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onSuccess<span class="token punctuation">&quot;</span></span> 
      <span class="token attr-name"><span class="token namespace">bind:</span>fail</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onFail<span class="token punctuation">&quot;</span></span> 
      <span class="token attr-name"><span class="token namespace">bind:</span>complete</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onComplete<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>right<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{filter.buildStatic(<span class="token punctuation">&#39;</span>/center/debt/upload-icon.png<span class="token punctuation">&#39;</span>)}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>上传<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wux-upload</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>  data<span class="token punctuation">{</span>
      <span class="token literal-property property">fileList</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 上传图片集合</span>
      <span class="token literal-property property">compressed</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;compressed&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 图片尺寸设置</span>
  <span class="token punctuation">}</span>


  <span class="token doc-comment comment">/**
   * 上传图片功能模块
   */</span>
  <span class="token function">onChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> file<span class="token punctuation">,</span> fileList <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>detail
    <span class="token keyword">if</span> <span class="token punctuation">(</span>file<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token string">&#39;uploading&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">progress</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        wx<span class="token punctuation">.</span><span class="token function">showLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>file<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token string">&#39;done&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">imageUrl</span><span class="token operator">:</span> file<span class="token punctuation">.</span>url<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> fileList <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 成功回调</span>
  <span class="token function">onSuccess</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;onSuccess&#39;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 失败回调</span>
  <span class="token function">onFail</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;onFail&#39;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 上传完成</span>
  <span class="token function">onComplete</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      wx<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 上传进度</span>
  <span class="token function">onProgress</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">progress</span><span class="token operator">:</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>file<span class="token punctuation">.</span>progress<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 预览图片</span>
  <span class="token function">onPreview</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> file<span class="token punctuation">,</span> fileList <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>detail
      wx<span class="token punctuation">.</span><span class="token function">previewImage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">current</span><span class="token operator">:</span> file<span class="token punctuation">.</span>url<span class="token punctuation">,</span>
          <span class="token literal-property property">urls</span><span class="token operator">:</span> fileList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> n<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 删除图片</span>
  <span class="token function">onRemove</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;remove&#39;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="微信uploader组件" tabindex="-1"><a class="header-anchor" href="#微信uploader组件" aria-hidden="true">#</a> 微信uploader组件</h3><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>img-view<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mp-cells</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mp-cell</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mp-uploader</span> 
              <span class="token attr-name">bindfail</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>uploadError<span class="token punctuation">&quot;</span></span> 
              <span class="token attr-name">bindsuccess</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>uploadSuccess<span class="token punctuation">&quot;</span></span> 
              <span class="token attr-name">binddelete</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>deleteFile<span class="token punctuation">&quot;</span></span>
              <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{selectFile}}<span class="token punctuation">&quot;</span></span> 
              <span class="token attr-name">upload</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{uplaodFile}}<span class="token punctuation">&quot;</span></span> 
              <span class="token attr-name">files</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{files}}<span class="token punctuation">&quot;</span></span>
              <span class="token attr-name">delete</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
              <span class="token attr-name">max-count</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>9<span class="token punctuation">&quot;</span></span>
              <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>图片上传<span class="token punctuation">&quot;</span></span> 
              <span class="token attr-name">tips</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>图片上传提示<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mp-uploader</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mp-cell</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mp-cells</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code> data<span class="token operator">:</span> <span class="token punctuation">{</span>
    files<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
      url<span class="token operator">:</span> <span class="token string">&#39;https://hbimg.huabanimg.com/7dba3ddeccf5953d5845f3c76057806f771983a777e79-uRDtUA_fw658/format/webp&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    urls<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 返回图片集合，多图</span>
  <span class="token punctuation">}</span>
  
  <span class="token doc-comment comment">/**
   * 生命周期函数--监听页面加载
   */</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      selectFile<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">selectFile</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      uplaodFile<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">uplaodFile</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>  
  
  <span class="token comment">// 选择图片</span>
  <span class="token function-variable function">chooseImage</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token keyword">var</span> that <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    wx<span class="token punctuation">.</span><span class="token function">chooseImage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        sizeType<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;original&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;compressed&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 可以指定是原图还是压缩图，默认二者都有</span>
        sourceType<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;album&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;camera&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 可以指定来源是相册还是相机，默认二者都有</span>
        count<span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 最多可选图片张数</span>
        <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
            that<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                files<span class="token operator">:</span> that<span class="token punctuation">.</span>data<span class="token punctuation">.</span>files<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>tempFilePaths<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 预览图片</span>
  <span class="token function-variable function">previewImage</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
      wx<span class="token punctuation">.</span><span class="token function">previewImage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          current<span class="token operator">:</span> e<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token comment">// 当前显示图片的http链接</span>
          urls<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>files <span class="token comment">// 需要预览的图片http链接列表</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token function">selectFile</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;files&#39;</span><span class="token punctuation">,</span> files<span class="token punctuation">)</span>
      <span class="token comment">// 返回false可以阻止某次文件上传</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token function">uplaodFile</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;upload files&#39;</span><span class="token punctuation">,</span> files<span class="token punctuation">)</span>
    <span class="token comment">// 文件上传的函数，返回一个promise</span>
    <span class="token keyword">let</span> that <span class="token operator">=</span> <span class="token keyword">this</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">[</span>index<span class="token punctuation">,</span>item<span class="token punctuation">]</span> <span class="token keyword">of</span> files<span class="token punctuation">.</span>tempFilePaths<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span>
        <span class="token comment">//上传图片</span>
        wx<span class="token punctuation">.</span><span class="token function">uploadFile</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token comment">//请求后台的路径</span>
          url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">..........di.cn/uploadimage</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
          <span class="token comment">//小程序本地的路径</span>
          filePath<span class="token operator">:</span> item<span class="token punctuation">,</span>
          <span class="token comment">//后台获取我们图片的key</span>
          name<span class="token operator">:</span> <span class="token string">&#39;file&#39;</span><span class="token punctuation">,</span>
          <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token string">&#39;https://filecdn.shuidi.cn/img/&#39;</span> <span class="token operator">+</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>path <span class="token operator">+</span> <span class="token string">&#39;/&#39;</span> <span class="token operator">+</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">+</span> <span class="token string">&#39;x&#39;</span> <span class="token operator">+</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>height<span class="token operator">+</span> <span class="token string">&#39;.jpg&#39;</span>
            that<span class="token punctuation">.</span>data<span class="token punctuation">.</span>urls<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
            <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>data<span class="token punctuation">.</span>urls<span class="token punctuation">)</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>index<span class="token operator">+</span><span class="token number">1</span> <span class="token operator">==</span> files<span class="token punctuation">.</span>tempFilePaths<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>
              <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                urls<span class="token operator">:</span> that<span class="token punctuation">.</span>data<span class="token punctuation">.</span>urls
              <span class="token punctuation">}</span><span class="token punctuation">)</span>
              <span class="token comment">//上传成功</span>
              wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                title<span class="token operator">:</span> <span class="token string">&#39;上传成功&#39;</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//上传失败</span>
            <span class="token function">reject</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
            wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
              title<span class="token operator">:</span> <span class="token string">&#39;上传失败&#39;</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token function">uploadError</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;upload error&#39;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">uploadSuccess</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;upload success&#39;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">deleteFile</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;upload delete&#39;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>files<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>files<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span>index <span class="token operator">=&gt;</span> index <span class="token operator">==</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序分享方案" tabindex="-1"><a class="header-anchor" href="#小程序分享方案" aria-hidden="true">#</a> 小程序分享方案</h2><h3 id="button组件方案" tabindex="-1"><a class="header-anchor" href="#button组件方案" aria-hidden="true">#</a> button组件方案</h3><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">data-name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>shareBtn<span class="token punctuation">&quot;</span></span> <span class="token attr-name">open-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>share<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>share share2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="回调函数方案" tabindex="-1"><a class="header-anchor" href="#回调函数方案" aria-hidden="true">#</a> 回调函数方案</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token doc-comment comment">/**
   * 自定义分享小程序
   * <span class="token keyword">@html</span>:  &lt;button data-name=&quot;shareBtn&quot; open-type=&quot;share&quot;&gt;&lt;/button&gt;
   * <span class="token keyword">@param</span> <span class="token parameter">from</span>: button:页面内转发按钮，menu右上角菜单转发
   * <span class="token keyword">@param</span> <span class="token parameter">title</span>: 转发标题
   * <span class="token keyword">@param</span> <span class="token parameter">path</span>：转发路径（必须已/开头完整路径）
   * <span class="token keyword">@param</span> <span class="token parameter">imageUrl</span>: 图片路径长宽比5:4
   */</span>
  <span class="token function-variable function">onShareAppMessage</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Pa<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>abnormalStatus <span class="token operator">==</span> <span class="token boolean">true</span> <span class="token operator">?</span> <span class="token number">2523</span> <span class="token operator">:</span> <span class="token number">2531</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>openid<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>from <span class="token operator">==</span> <span class="token string">&#39;button&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">var</span> title<span class="token operator">=</span><span class="token string">&quot;企业信用管家&quot;</span>
      <span class="token keyword">var</span> path<span class="token operator">=</span><span class="token string">&quot;/pages/center/manageAbnormal/index&quot;</span>
      <span class="token keyword">var</span> imageUrl<span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">../../../img/center/manAbnormal/share-bg.png</span><span class="token template-punctuation string">`</span></span>
      <span class="token keyword">return</span><span class="token punctuation">{</span>
        title<span class="token operator">:</span>title<span class="token punctuation">,</span>
        path<span class="token operator">:</span>path<span class="token punctuation">,</span>
        imageUrl<span class="token operator">:</span>imageUrl<span class="token punctuation">,</span>
        <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="分享动态图片" tabindex="-1"><a class="header-anchor" href="#分享动态图片" aria-hidden="true">#</a> 分享动态图片</h3><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- 分享图片弹窗 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>shareImg<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{shareImgFlag}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>share-bg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{filter.buildStatic(<span class="token punctuation">&#39;</span>/center/debt/bg-img2.png<span class="token punctuation">&#39;</span>)}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>已助力<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>{{debt_total}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>笔债务追回<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code> <span class="token doc-comment comment">/**
   * 自定义分享小程序
   * <span class="token keyword">@html</span>:  &lt;button data-name=&quot;shareBtn&quot; open-type=&quot;share&quot;&gt;&lt;/button&gt;
   * <span class="token keyword">@param</span> <span class="token parameter">from</span>: button:页面内转发按钮，menu右上角菜单转发
   * <span class="token keyword">@param</span> <span class="token parameter">title</span>: 转发标题
   * <span class="token keyword">@param</span> <span class="token parameter">path</span>：转发路径（必须已/开头完整路径）
   * <span class="token keyword">@param</span> <span class="token parameter">imageUrl</span>: 图片路径长宽比5:4
   * <span class="token keyword">@param</span> <span class="token parameter">shareImgFlag</span>: 弹窗图控制
   */</span>
  <span class="token function-variable function">onShareAppMessage</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Pa<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token number">3858</span><span class="token punctuation">)</span> <span class="token comment">// 登记页分享量总和</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> shareImgFlag<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> shareImgFlag<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>from <span class="token operator">==</span> <span class="token string">&#39;button&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">var</span> title<span class="token operator">=</span><span class="token string">&quot;债务登记&quot;</span>
      <span class="token keyword">var</span> path<span class="token operator">=</span><span class="token string">&quot;/packageA/pages/center/debt/form/index&quot;</span>
      <span class="token keyword">return</span><span class="token punctuation">{</span>
        title<span class="token operator">:</span>title<span class="token punctuation">,</span>
        path<span class="token operator">:</span>path<span class="token punctuation">,</span>
        <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序数据监听封装-watch" tabindex="-1"><a class="header-anchor" href="#小程序数据监听封装-watch" aria-hidden="true">#</a> 小程序数据监听封装 watch</h2><h3 id="监听基本数据类型" tabindex="-1"><a class="header-anchor" href="#监听基本数据类型" aria-hidden="true">#</a> 监听基本数据类型</h3><ul><li><code>app.js</code>文件</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 数据监听器</span>
  <span class="token function">initWatch</span><span class="token punctuation">(</span>_page<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>_page<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;未检测到Page对象,请将当前page传入该函数&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>_page<span class="token punctuation">.</span>watch<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//判断是否有需要监听的字段</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;未检测到Page.watch字段(如果不需要监听，请移除initWatch的调用片段)&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> _dataKey <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>_page<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>_page<span class="token punctuation">.</span>watch<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_key<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">//遍历需要监听的字段</span>
      _page<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token string">&#39;__&#39;</span> <span class="token operator">+</span> _key<span class="token punctuation">]</span> <span class="token operator">=</span> _page<span class="token punctuation">.</span>data<span class="token punctuation">[</span>_key<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//存储监听的数据</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>_dataKey<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>_key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//如果该字段存在于Page.data中，说明合法</span>
        Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>_page<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token punctuation">{</span>
          <span class="token punctuation">[</span>_key<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">//被监听的字段</span>
            enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token keyword">let</span> oldVal <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token string">&#39;__&#39;</span> <span class="token operator">+</span> _key<span class="token punctuation">]</span><span class="token punctuation">;</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">!==</span> oldVal<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//如果新设置的值与原值不等，则触发监听函数</span>
                <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//为了同步,否则如果回调函数中有获取该字段值数据时将不同步,获取到的是旧值</span>
                  _page<span class="token punctuation">.</span>watch<span class="token punctuation">[</span>_key<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>_page<span class="token punctuation">,</span> oldVal<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置监听函数的上下文对象为当前的Page对象并执行</span>
                <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
              <span class="token punctuation">}</span>
              <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token string">&#39;__&#39;</span> <span class="token operator">+</span> _key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token string">&#39;__&#39;</span> <span class="token operator">+</span> _key<span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;监听的属性[&#39;</span> <span class="token operator">+</span> _key <span class="token operator">+</span> <span class="token string">&#39;]在Page.data中未找到，请检查~&#39;</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>使用方法</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 初始化需要监听的字段</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    app<span class="token punctuation">.</span><span class="token function">initWatch</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> 
  <span class="token punctuation">}</span>
  
  watch<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token comment">//需要监听的字段</span>
    <span class="token string-property property">&#39;showPop&#39;</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>value<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> isTiptrue<span class="token operator">:</span><span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> isTiptrue<span class="token operator">:</span><span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="复杂类型监听" tabindex="-1"><a class="header-anchor" href="#复杂类型监听" aria-hidden="true">#</a> 复杂类型监听</h3><ul><li>模块封装<code>class.js</code></li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Watch</span><span class="token punctuation">{</span>
  <span class="token doc-comment comment">/**
   * 
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>*Object<span class="token punctuation">}</span> obj 要监听的集合 
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>*String<span class="token punctuation">}</span> key 要监听的字段
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>*Function<span class="token punctuation">}</span> fn 发生改变之后通知的函数
   */</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span>key<span class="token punctuation">,</span>fn<span class="token punctuation">)</span><span class="token punctuation">{</span> 
      <span class="token keyword">this</span><span class="token punctuation">.</span>obj <span class="token operator">=</span> obj
      <span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> key
      <span class="token keyword">this</span><span class="token punctuation">.</span>fn <span class="token operator">=</span> fn
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loop_</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token doc-comment comment">/**
   * loop_ 是为了深度遍历集合，构造每一个子集合
   */</span>
  <span class="token function">loop_</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>obj<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>key<span class="token punctuation">]</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> value <span class="token operator">==</span> <span class="token string">&#39;object&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token keyword">of</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
              <span class="token keyword">new</span> <span class="token class-name">Watch</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>fn<span class="token punctuation">)</span>  <span class="token comment">//遍历其下所有集合，再进行构造</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">define_</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>obj<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>key<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>fn<span class="token punctuation">)</span> <span class="token comment">//开始进行数据劫持 </span>
  <span class="token punctuation">}</span>

  <span class="token comment">//数据劫持</span>
  <span class="token function">define_</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span>key<span class="token punctuation">,</span>fn<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">let</span> val <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
      Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span>key<span class="token punctuation">,</span><span class="token punctuation">{</span>
          <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
              <span class="token keyword">return</span> val
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token function">set</span><span class="token punctuation">(</span>new_<span class="token punctuation">)</span><span class="token punctuation">{</span>
              <span class="token comment">// 此时由于每个子集合都挂载了fn,并且都有了prototype属性，</span>
              <span class="token comment">// 如果新设置的值与原值不等，则触发监听函数</span>
              <span class="token keyword">if</span><span class="token punctuation">(</span>fn <span class="token operator">&amp;&amp;</span> val <span class="token operator">!==</span> new_<span class="token punctuation">)</span><span class="token function">fn</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span>new_<span class="token punctuation">)</span>  
              val <span class="token operator">=</span> new_  <span class="token comment">// 所以，改变任何一项都会进行通知。</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>


<span class="token keyword">export</span> <span class="token keyword">default</span> Watch<span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>使用方法</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 导入class类</span>
<span class="token keyword">import</span> Watch <span class="token keyword">from</span> <span class="token string">&#39;../class.js&#39;</span>

<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    obj <span class="token operator">:</span><span class="token punctuation">{</span>
      melo<span class="token operator">:</span><span class="token punctuation">{</span>
          Denver<span class="token operator">:</span><span class="token punctuation">{</span>
            first<span class="token operator">:</span><span class="token number">95</span><span class="token punctuation">,</span>
           second<span class="token operator">:</span><span class="token number">92</span>
         <span class="token punctuation">}</span><span class="token punctuation">,</span>
         Portland<span class="token operator">:</span><span class="token punctuation">{</span>
          first<span class="token operator">:</span><span class="token number">82</span><span class="token punctuation">,</span>
          second<span class="token operator">:</span><span class="token number">82</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// param1: 监听对象, param2: 监听对象属性，param3: 监听后回调函数 </span>
      <span class="token comment">// var: 旧值，new_：新值 </span>
      <span class="token keyword">new</span> <span class="token class-name">Watch</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>obj<span class="token punctuation">.</span>melo<span class="token punctuation">.</span>Portland<span class="token punctuation">,</span><span class="token string">&#39;second&#39;</span><span class="token punctuation">,</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span>new_<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token operator">+</span><span class="token string">&#39;的新值是：&#39;</span><span class="token operator">+</span> new_<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  
  <span class="token comment">// 改变数据  </span>
  <span class="token function">addObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>obj<span class="token punctuation">.</span>melo<span class="token punctuation">.</span>Portland<span class="token punctuation">.</span>second<span class="token operator">++</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序返回上一页传参" tabindex="-1"><a class="header-anchor" href="#小程序返回上一页传参" aria-hidden="true">#</a> 小程序返回上一页传参</h2><ul><li>A-B页面</li><li>A页面获取参数</li><li></li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>  <span class="token keyword">var</span> pages <span class="token operator">=</span> <span class="token function">getCurrentPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> currPage <span class="token operator">=</span> pages<span class="token punctuation">[</span>pages<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
  <span class="token keyword">let</span> value <span class="token operator">=</span> currPage<span class="token punctuation">.</span>data<span class="token punctuation">.</span>backData <span class="token operator">||</span> <span class="token string">&#39;&#39;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>value <span class="token operator">==</span> <span class="token string">&#39;detail&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">var</span> pages <span class="token operator">=</span> <span class="token function">getCurrentPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">let</span> prevPage <span class="token operator">=</span> pages<span class="token punctuation">[</span>pages<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
      prevPage<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    
        backData<span class="token operator">:</span> <span class="token string">&#39;&#39;</span>   <span class="token comment">// 清空参数</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/packageA/pages/credit/detail2?digest=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>digest<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>A页面跳转下一页传参数据置空</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token function">onUnload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> pages <span class="token operator">=</span> <span class="token function">getCurrentPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> prevPage <span class="token operator">=</span> pages<span class="token punctuation">[</span>pages<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span>
  prevPage<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    backData<span class="token operator">:</span> <span class="token string">&#39;&#39;</span>   <span class="token comment">// 清空参数</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>B页面销毁时给上一页设置参数</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>  <span class="token comment">// 返回上一页传参</span>
  <span class="token keyword">let</span> pages <span class="token operator">=</span> <span class="token function">getCurrentPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 获取当前的页面栈</span>
  <span class="token keyword">let</span> prevPage <span class="token operator">=</span> pages<span class="token punctuation">[</span>pages<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span>
  prevPage<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    
    backData<span class="token operator">:</span> <span class="token string">&#39;detail&#39;</span>   <span class="token comment">// 需要传递的值</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="进度球波浪动画组件" tabindex="-1"><a class="header-anchor" href="#进度球波浪动画组件" aria-hidden="true">#</a> 进度球波浪动画组件</h2><p><img src="/myblog/images/frontEnd/img_9.png" alt="图片"></p><h3 id="canvas动画组" tabindex="-1"><a class="header-anchor" href="#canvas动画组" aria-hidden="true">#</a> canvas动画组</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token doc-comment comment">/**
 * 画布类方法封装
 */</span>

<span class="token keyword">var</span> Canvas <span class="token operator">=</span> <span class="token punctuation">{</span> 

  <span class="token doc-comment comment">/**
   * canvas绘制波浪动画进度球插件
   * <span class="token keyword">@description</span> :
   *  &lt;canvas canvas-id=&#39;canvasArcCir&#39; width=&#39;250&#39; height=&#39;250&#39;&gt;&lt;/canvas&gt;
   *  const ctx = wx.createCanvasContext(&#39;canvasArcCir&#39;)
   *  wave(ctx, 40);
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>*<span class="token punctuation">}</span> ctx : 创建的画布 wx.createCanvasContext(&#39;canvasArcCir&#39;)
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>number<span class="token punctuation">}</span> oRange ：进度值：100 = 100%
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>number<span class="token punctuation">}</span> size ：进度球大小
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>string<span class="token punctuation">}</span> color ：进度球颜色 #892394
   * <span class="token keyword">@param</span> <span class="token punctuation">{</span>string<span class="token punctuation">}</span> bgColor: 进度球背景颜色 #892394
   */</span>
  <span class="token function">wave</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> oRange<span class="token punctuation">,</span> size<span class="token punctuation">,</span> color<span class="token punctuation">,</span> bgColor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> tid<span class="token punctuation">;</span>
    <span class="token keyword">var</span> <span class="token constant">M</span> <span class="token operator">=</span> Math<span class="token punctuation">;</span>
    <span class="token keyword">var</span> Sin <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">.</span>sin<span class="token punctuation">;</span>
    <span class="token keyword">var</span> Cos <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">.</span>cos<span class="token punctuation">;</span>
    <span class="token keyword">var</span> Sqrt <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">.</span>sqrt<span class="token punctuation">;</span>
    <span class="token keyword">var</span> Pow <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">.</span>pow<span class="token punctuation">;</span>
    <span class="token keyword">var</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> Round <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">.</span>round<span class="token punctuation">;</span>
    <span class="token keyword">var</span> oW <span class="token operator">=</span>  size <span class="token operator">?</span> size <span class="token operator">:</span> <span class="token number">150</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> oH <span class="token operator">=</span>  size <span class="token operator">?</span> size <span class="token operator">:</span> <span class="token number">150</span><span class="token punctuation">;</span>
    <span class="token comment">// 线宽</span>
    <span class="token keyword">var</span> lineWidth <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token comment">// 大半径</span>
    <span class="token keyword">var</span> r <span class="token operator">=</span> <span class="token punctuation">(</span>oW <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> cR <span class="token operator">=</span> r <span class="token operator">-</span> <span class="token number">10</span> <span class="token operator">*</span> lineWidth<span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> lineWidth<span class="token punctuation">;</span>
    <span class="token comment">// 水波动画初始参数</span>
    <span class="token keyword">var</span> axisLength <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> r <span class="token operator">-</span> <span class="token number">16</span> <span class="token operator">*</span> lineWidth<span class="token punctuation">;</span>  <span class="token comment">// Sin 图形长度</span>
    <span class="token keyword">var</span> unit <span class="token operator">=</span> axisLength <span class="token operator">/</span> <span class="token number">9</span><span class="token punctuation">;</span> <span class="token comment">// 波浪宽</span>
    <span class="token keyword">var</span> range <span class="token operator">=</span> <span class="token number">.4</span> <span class="token comment">// 浪幅</span>
    <span class="token keyword">var</span> nowrange <span class="token operator">=</span> range<span class="token punctuation">;</span>
    <span class="token keyword">var</span> xoffset <span class="token operator">=</span> <span class="token number">8</span> <span class="token operator">*</span> lineWidth<span class="token punctuation">;</span> <span class="token comment">// x 轴偏移量</span>
    <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token operator">~</span><span class="token operator">~</span><span class="token punctuation">(</span>oRange<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">;</span>   <span class="token comment">// 数据量</span>
    <span class="token keyword">var</span> sp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 周期偏移量</span>
    <span class="token keyword">var</span> nowdata <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> waveupsp <span class="token operator">=</span> <span class="token number">0.006</span><span class="token punctuation">;</span> <span class="token comment">// 水波上涨速度</span>
    <span class="token comment">// 圆动画初始参数</span>
    <span class="token keyword">var</span> arcStack <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// 圆栈</span>
    <span class="token keyword">var</span> bR <span class="token operator">=</span> r <span class="token operator">-</span> <span class="token number">8</span> <span class="token operator">*</span> lineWidth<span class="token punctuation">;</span>
    <span class="token keyword">var</span> soffset <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 圆动画起始位置</span>
    <span class="token keyword">var</span> circleLock <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 起始动画锁</span>
    <span class="token comment">// 获取圆动画轨迹点集</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> soffset<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> soffset <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token constant">PI</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">8</span> <span class="token operator">*</span> <span class="token constant">PI</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      arcStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        r <span class="token operator">+</span> bR <span class="token operator">*</span> <span class="token function">Cos</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>
        r <span class="token operator">+</span> bR <span class="token operator">*</span> <span class="token function">Sin</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
      <span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 圆起始点</span>
    <span class="token keyword">var</span> cStartPoint <span class="token operator">=</span> arcStack<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">&quot;#1c86d1&quot;</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>cStartPoint<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cStartPoint<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 开始渲染</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**************圆圈内部渲染 *****************/</span>
    <span class="token keyword">function</span> <span class="token function">drawSine</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> Stack <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 记录起始点和终点坐标</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> xoffset<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> xoffset <span class="token operator">+</span> axisLength<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">20</span> <span class="token operator">/</span> axisLength<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> x <span class="token operator">=</span> sp <span class="token operator">+</span> <span class="token punctuation">(</span>xoffset <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">/</span> unit<span class="token punctuation">;</span>
        <span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token function">Sin</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">*</span> nowrange<span class="token punctuation">;</span>
        <span class="token keyword">var</span> dx <span class="token operator">=</span> i<span class="token punctuation">;</span>
        <span class="token keyword">var</span> dy <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> cR <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> nowdata<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>r <span class="token operator">-</span> cR<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>unit <span class="token operator">*</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>dx<span class="token punctuation">,</span> dy<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>dx<span class="token punctuation">,</span> dy<span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 获取初始点和结束点</span>
      <span class="token keyword">var</span> startP <span class="token operator">=</span> Stack<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
      <span class="token keyword">var</span> endP <span class="token operator">=</span> Stack<span class="token punctuation">[</span>Stack<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
      ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>xoffset <span class="token operator">+</span> axisLength<span class="token punctuation">,</span> oW<span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>xoffset<span class="token punctuation">,</span> oW<span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>startP<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> startP<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token doc-comment comment">/******** 圓圈內部顏色 ********/</span>
      ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> color <span class="token operator">?</span> color <span class="token operator">:</span> <span class="token string">&quot;#4D6DE3&quot;</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">restore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token doc-comment comment">/***************** 字体配置 ********************/</span>
    <span class="token keyword">function</span> <span class="token function">drawText</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span>globalCompositeOperation <span class="token operator">=</span> <span class="token string">&#39;source-over&#39;</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> size <span class="token operator">=</span> <span class="token number">0.5</span> <span class="token operator">*</span> cR<span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">&#39;bold &#39;</span> <span class="token operator">+</span> size <span class="token operator">+</span> <span class="token string">&#39;px Microsoft Yahei&#39;</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token punctuation">(</span>nowdata<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// var txt = number+ &#39;%&#39;;</span>
      <span class="token keyword">var</span> txt <span class="token operator">=</span> <span class="token string">&#39;良好&#39;</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> fonty <span class="token operator">=</span> r <span class="token operator">+</span> size <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> fontx <span class="token operator">=</span> r <span class="token operator">-</span> size <span class="token operator">*</span> <span class="token number">0.8</span><span class="token punctuation">;</span>
      <span class="token doc-comment comment">/******** 字体颜色 *******/</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">number</span> <span class="token operator">&gt;=</span> <span class="token number">50</span><span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;#FFFFFF&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">else</span><span class="token punctuation">{</span>
        ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;#FFFFFF&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      ctx<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">&#39;center&#39;</span><span class="token punctuation">;</span>
      <span class="token comment">// ctx.strokeText(txt,r + 0, r + 8);</span>
      ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span>txt<span class="token punctuation">,</span> r <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">,</span> r <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token doc-comment comment">/**************** 边框圆圈 *****************/</span>
    <span class="token keyword">function</span> <span class="token function">grayCircle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token doc-comment comment">/******* 边框颜色 *******/</span>
      ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> color <span class="token operator">?</span> color <span class="token operator">:</span> <span class="token string">&#39;#4D6DE3&#39;</span><span class="token punctuation">;</span>
      <span class="token doc-comment comment">/*** cR-x控制边框大小 ***/</span>
      ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> r<span class="token punctuation">,</span> cR <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">restore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token doc-comment comment">/********** 进度球背景 *********/</span>
    <span class="token keyword">function</span> <span class="token function">drawCircle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> bgColor <span class="token operator">?</span> bgColor <span class="token operator">:</span> <span class="token string">&#39;#2d4059&#39;</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> r<span class="token punctuation">,</span> cR <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span>fillStyle<span class="token operator">=</span> bgColor <span class="token operator">?</span> bgColor <span class="token operator">:</span> <span class="token string">&quot;#2d4059&quot;</span><span class="token punctuation">;</span><span class="token comment">//设置填充颜色</span>
      ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开始填充</span>
      ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">restore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token doc-comment comment">/********* 外框进度圈-render中调用 **********/</span>
    <span class="token comment">//使用这个使圆环两端是圆弧形状</span>
    <span class="token keyword">function</span> <span class="token function">orangeCircle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">&#39;#fbdb32&#39;</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span>lineCap <span class="token operator">=</span> <span class="token string">&#39;round&#39;</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> r<span class="token punctuation">,</span> cR <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token operator">*</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">180.0</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>nowdata <span class="token operator">*</span> <span class="token number">360</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">180.0</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token doc-comment comment">/************** 中间水圈大小裁剪 **************/</span>
    <span class="token keyword">function</span> <span class="token function">clipCircle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> r<span class="token punctuation">,</span> cR <span class="token operator">-</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">clip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token doc-comment comment">/************* 执行渲染canvas ***************/</span>
    <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">abortAnimationFrame</span><span class="token punctuation">(</span>tid<span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> oW<span class="token punctuation">,</span> oH<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">drawCircle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 圆圈边框</span>
      <span class="token comment">// grayCircle();</span>
      <span class="token comment">//裁剪中间水圈</span>
      <span class="token function">clipCircle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 控制波幅</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>data <span class="token operator">&gt;=</span> <span class="token number">0.85</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nowrange <span class="token operator">&gt;</span> range <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> t <span class="token operator">=</span> range <span class="token operator">*</span> <span class="token number">0.01</span><span class="token punctuation">;</span>
          nowrange <span class="token operator">-=</span> t<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>data <span class="token operator">&lt;=</span> <span class="token number">0.1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nowrange <span class="token operator">&lt;</span> range <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> t <span class="token operator">=</span> range <span class="token operator">*</span> <span class="token number">0.01</span><span class="token punctuation">;</span>
          nowrange <span class="token operator">+=</span> t<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nowrange <span class="token operator">&lt;=</span> range<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> t <span class="token operator">=</span> range <span class="token operator">*</span> <span class="token number">0.01</span><span class="token punctuation">;</span>
          nowrange <span class="token operator">+=</span> t<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nowrange <span class="token operator">&gt;=</span> range<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> t <span class="token operator">=</span> range <span class="token operator">*</span> <span class="token number">0.01</span><span class="token punctuation">;</span>
          nowrange <span class="token operator">-=</span> t<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>data <span class="token operator">-</span> nowdata<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        nowdata <span class="token operator">+=</span> waveupsp<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>data <span class="token operator">-</span> nowdata<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        nowdata <span class="token operator">-=</span> waveupsp
      <span class="token punctuation">}</span>
      <span class="token doc-comment comment">/************ 控制波浪幅度 *************/</span>
      sp <span class="token operator">+=</span> <span class="token number">0.07</span><span class="token punctuation">;</span>
      <span class="token comment">// 开始水波动画</span>
      <span class="token function">drawSine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 写字</span>
      <span class="token function">drawText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      tid <span class="token operator">=</span> <span class="token function">doAnimationFrame</span><span class="token punctuation">(</span>render<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> lastFrameTime <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">// 模拟 requestAnimationFrame</span>
    <span class="token keyword">function</span> <span class="token function">doAnimationFrame</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> currTime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> timeToCall <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">16</span> <span class="token operator">-</span> <span class="token punctuation">(</span>currTime <span class="token operator">-</span> lastFrameTime<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> id <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">callback</span><span class="token punctuation">(</span>currTime <span class="token operator">+</span> timeToCall<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> timeToCall<span class="token punctuation">)</span><span class="token punctuation">;</span>
      lastFrameTime <span class="token operator">=</span> currTime <span class="token operator">+</span> timeToCall<span class="token punctuation">;</span>
      <span class="token keyword">return</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// 模拟 cancelAnimationFrame</span>
    <span class="token keyword">function</span> <span class="token function">abortAnimationFrame</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> Canvas<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>使用方法</li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">canvas-id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&#39;</span>canvasArcCir<span class="token punctuation">&#39;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&#39;</span>250<span class="token punctuation">&#39;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&#39;</span>250<span class="token punctuation">&#39;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token comment">// 创建动画进度球</span>
  <span class="token keyword">const</span> ctx <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">createCanvasContext</span><span class="token punctuation">(</span><span class="token string">&#39;canvasArcCir&#39;</span><span class="token punctuation">)</span> <span class="token comment">// 进度球画布</span>
  <span class="token keyword">let</span> oRange <span class="token operator">=</span> <span class="token number">50</span> <span class="token comment">// 进度值</span>
  <span class="token keyword">let</span> size <span class="token operator">=</span> <span class="token number">100</span> <span class="token comment">// 尺寸大小</span>
  <span class="token keyword">let</span> color <span class="token operator">=</span>  <span class="token string">&#39;#f4b24e&#39;</span> <span class="token comment">// 进度球颜色</span>
  <span class="token keyword">let</span> bgColor <span class="token operator">=</span>  <span class="token string">&#39;#f4d29c&#39;</span> <span class="token comment">// 进度球背景颜色</span>

  Canvas<span class="token punctuation">.</span><span class="token function">wave</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> oRange<span class="token punctuation">,</span> size<span class="token punctuation">,</span> color<span class="token punctuation">,</span> bgColor<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="静态组件" tabindex="-1"><a class="header-anchor" href="#静态组件" aria-hidden="true">#</a> 静态组件</h3><p><img src="/myblog/images/frontEnd/img_10.png" alt="图片"></p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>percent<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>percentNum<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{count}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>percentB<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>%<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>water_wave<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>water<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token selector">transform:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>transform<span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span> 
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>water_wave<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">body</span> <span class="token punctuation">{</span>
    <span class="token property">background</span><span class="token punctuation">:</span> #020438<span class="token punctuation">;</span>
    <span class="token property">font</span><span class="token punctuation">:</span> 14px/1 <span class="token string">&#39;Open Sans&#39;</span><span class="token punctuation">,</span> helvetica<span class="token punctuation">,</span> sans-serif<span class="token punctuation">;</span>
    <span class="token property">-webkit-font-smoothing</span><span class="token punctuation">:</span> antialiased<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.box</span> <span class="token punctuation">{</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 280px<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 280px<span class="token punctuation">;</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
    <span class="token property">-webkit-transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span> -50%<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span> -50%<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> #020438<span class="token punctuation">;</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.box .percent</span> <span class="token punctuation">{</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">z-index</span><span class="token punctuation">:</span> 3<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> -webkit-box<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> -ms-flexbox<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> -webkit-flex<span class="token punctuation">;</span>
    <span class="token property">-webkit-box-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">-webkit-align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">-ms-flex-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">-webkit-box-pack</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">-webkit-justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">-ms-flex-pack</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 64px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.box .water</span> <span class="token punctuation">{</span>
    <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">z-index</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 100%<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> #4D6DE3<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>data<span class="token operator">:</span> <span class="token punctuation">{</span>
    count<span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
    transform<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>

  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  
 <span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      transform<span class="token operator">:</span> <span class="token string">&#39;translate(0&#39;</span> <span class="token operator">+</span> <span class="token string">&#39;,&#39;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">100</span> <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>count<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;%)&#39;</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="svg版本-小程序不支持" tabindex="-1"><a class="header-anchor" href="#svg版本-小程序不支持" aria-hidden="true">#</a> svg版本(小程序不支持)</h3><p><img src="/myblog/images/frontEnd/img_15.png" alt="图片"></p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://wow.techbrood.com/libs/jquery/jquery-1.11.1.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://www.w3.org/2000/svg<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xlink</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://www.w3.org/1999/xlink<span class="token punctuation">&quot;</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0px<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0px<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>symbol</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wave<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>M420,20c21.5-0.4,38.8-2.5,51.1-4.5c13.4-2.2,26.5-5.2,27.3-5.4C514,6.5,518,4.7,528.5,2.7c7.1-1.3,17.9-2.8,31.5-2.7c0,0,0,0,0,0v20H420z<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>path</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>M420,20c-21.5-0.4-38.8-2.5-51.1-4.5c-13.4-2.2-26.5-5.2-27.3-5.4C326,6.5,322,4.7,311.5,2.7C304.3,1.4,293.6-0.1,280,0c0,0,0,0,0,0v20H420z<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>path</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>M140,20c21.5-0.4,38.8-2.5,51.1-4.5c13.4-2.2,26.5-5.2,27.3-5.4C234,6.5,238,4.7,248.5,2.7c7.1-1.3,17.9-2.8,31.5-2.7c0,0,0,0,0,0v20H140z<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>path</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>M140,20c-21.5-0.4-38.8-2.5-51.1-4.5c-13.4-2.2-26.5-5.2-27.3-5.4C46,6.5,42,4.7,31.5,2.7C24.3,1.4,13.6-0.1,0,0c0,0,0,0,0,0l0,20H140z<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>path</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>symbol</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>percent<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>percentNum<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>count<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>percentB<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>%<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>water<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>water<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0 0 560 20<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>water_wave water_wave_back<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>use</span> <span class="token attr-name"><span class="token namespace">xlink:</span>href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#wave<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>use</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0 0 560 20<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>water_wave water_wave_front<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>use</span> <span class="token attr-name"><span class="token namespace">xlink:</span>href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#wave<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>use</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">*,
*:before,
*:after</span> <span class="token punctuation">{</span>
    <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>
    <span class="token property">outline</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">body</span> <span class="token punctuation">{</span>
    <span class="token property">background</span><span class="token punctuation">:</span> #020438<span class="token punctuation">;</span>
    <span class="token property">font</span><span class="token punctuation">:</span> 14px/1 <span class="token string">&#39;Open Sans&#39;</span><span class="token punctuation">,</span> helvetica<span class="token punctuation">,</span> sans-serif<span class="token punctuation">;</span>
    <span class="token property">-webkit-font-smoothing</span><span class="token punctuation">:</span> antialiased<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.box</span> <span class="token punctuation">{</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 280px<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 280px<span class="token punctuation">;</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
    <span class="token property">-webkit-transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span> -50%<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span> -50%<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> #020438<span class="token punctuation">;</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.box .percent</span> <span class="token punctuation">{</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">z-index</span><span class="token punctuation">:</span> 3<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> -webkit-box<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> -ms-flexbox<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> -webkit-flex<span class="token punctuation">;</span>
    <span class="token property">-webkit-box-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">-webkit-align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">-ms-flex-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">-webkit-box-pack</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">-webkit-justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">-ms-flex-pack</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 64px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.box .water</span> <span class="token punctuation">{</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">z-index</span><span class="token punctuation">:</span> 2<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">-webkit-transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 100%<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 100%<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> #4D6DE3<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.box .water_wave</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 200%<span class="token punctuation">;</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">bottom</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.box .water_wave_back</span> <span class="token punctuation">{</span>
    <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">fill</span><span class="token punctuation">:</span> #C7EEFF<span class="token punctuation">;</span>
    <span class="token property">-webkit-animation</span><span class="token punctuation">:</span> wave-back 1.4s infinite linear<span class="token punctuation">;</span>
    <span class="token property">animation</span><span class="token punctuation">:</span> wave-back 1.4s infinite linear<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.box .water_wave_front</span> <span class="token punctuation">{</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">fill</span><span class="token punctuation">:</span> #4D6DE3<span class="token punctuation">;</span>
    <span class="token property">margin-bottom</span><span class="token punctuation">:</span> -1px<span class="token punctuation">;</span>
    <span class="token property">-webkit-animation</span><span class="token punctuation">:</span> wave-front .7s infinite linear<span class="token punctuation">;</span>
    <span class="token property">animation</span><span class="token punctuation">:</span> wave-front .7s infinite linear<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@-webkit-keyframes</span> wave-front</span> <span class="token punctuation">{</span>
    <span class="token selector">100%</span> <span class="token punctuation">{</span>
        <span class="token property">-webkit-transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span> 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span> 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@keyframes</span> wave-front</span> <span class="token punctuation">{</span>
    <span class="token selector">100%</span> <span class="token punctuation">{</span>
        <span class="token property">-webkit-transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span> 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span> 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@-webkit-keyframes</span> wave-back</span> <span class="token punctuation">{</span>
    <span class="token selector">100%</span> <span class="token punctuation">{</span>
        <span class="token property">-webkit-transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>50%<span class="token punctuation">,</span> 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>50%<span class="token punctuation">,</span> 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@keyframes</span> wave-back</span> <span class="token punctuation">{</span>
    <span class="token selector">100%</span> <span class="token punctuation">{</span>
        <span class="token property">-webkit-transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>50%<span class="token punctuation">,</span> 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>50%<span class="token punctuation">,</span> 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">var</span> cnt <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;count&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> water <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;water&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> percent <span class="token operator">=</span> cnt<span class="token punctuation">.</span>innerText<span class="token punctuation">;</span>
<span class="token keyword">var</span> interval<span class="token punctuation">;</span>
    percent<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">;</span>
    cnt<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> percent<span class="token punctuation">;</span>
    water<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transform <span class="token operator">=</span> <span class="token string">&#39;translate(0&#39;</span> <span class="token operator">+</span> <span class="token string">&#39;,&#39;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">100</span> <span class="token operator">-</span> percent<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;%)&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序消息订阅" tabindex="-1"><a class="header-anchor" href="#小程序消息订阅" aria-hidden="true">#</a> 小程序消息订阅</h2><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token doc-comment comment">/**
 * 打开订阅消息
 */</span>
<span class="token function">openSubscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  wx<span class="token punctuation">.</span><span class="token function">requestSubscribeMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token comment">// 订阅消息弹窗</span>
    tmplIds<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;kBsiZNoVwdn6Oib9R1w.....&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0V9iOrE-ffYnuuMKo1Zc-4PcB......&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token function">success</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> ids <span class="token operator">=</span> <span class="token string">&#39;&#39;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> k <span class="token keyword">in</span> res<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">&#39;accept&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          ids <span class="token operator">+=</span> k<span class="token operator">+</span><span class="token string">&#39;,&#39;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>ids<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// 订阅成功</span>
      <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token comment">// 取消订阅</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序弹窗淡入淡出" tabindex="-1"><a class="header-anchor" href="#小程序弹窗淡入淡出" aria-hidden="true">#</a> 小程序弹窗淡入淡出</h2><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pay-box<span class="token punctuation">&quot;</span></span> <span class="token attr-name">animation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{ani}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">.pay-box</span><span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
  <span class="token property">bottom</span><span class="token punctuation">:</span> -500px<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 20rpx 20rpx 0 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token doc-comment comment">/**
 * 监听节点--在页面初次渲染完成
 * 页面完全渲染完之前调用boundingClientRect会有异常
 */</span>
<span class="token function-variable function">onReady</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> query <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">createSelectorQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  query<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&#39;.pay-box&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">boundingClientRect</span><span class="token punctuation">(</span>rect <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//给页面赋值</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      Bottom<span class="token operator">:</span> rect<span class="token punctuation">.</span>height <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>


<span class="token doc-comment comment">/**
 * 淡入淡出方法封装
 * <span class="token keyword">@param</span> <span class="token punctuation">{</span>number<span class="token punctuation">}</span> value: 
 */</span>
<span class="token function">openAnimation</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> animation <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">createAnimation</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    duration<span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
    timingFunction<span class="token operator">:</span> <span class="token string">&#39;ease&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  animation<span class="token punctuation">.</span><span class="token function">bottom</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">step</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    ani<span class="token operator">:</span> animation<span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>


<span class="token doc-comment comment">/****************单独案例*****************/</span>
  <span class="token comment">// 弹窗</span>
  <span class="token keyword">var</span> animation <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">createAnimation</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    duration<span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
    timingFunction<span class="token operator">:</span> <span class="token string">&#39;ease&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  animation<span class="token punctuation">.</span><span class="token function">bottom</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">step</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    ani<span class="token operator">:</span>  animation<span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  
  
  <span class="token comment">// 关闭</span>
  <span class="token keyword">var</span> animation <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">createAnimation</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    duration<span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
    timingFunction<span class="token operator">:</span> <span class="token string">&#39;ease&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  animation<span class="token punctuation">.</span><span class="token function">bottom</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">step</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    ani<span class="token operator">:</span> animation<span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序弹页面自动滚动动画" tabindex="-1"><a class="header-anchor" href="#小程序弹页面自动滚动动画" aria-hidden="true">#</a> 小程序弹页面自动滚动动画</h2><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 个人中心返回首页查信用状态,跳转到首页1/3位置</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>toArchives <span class="token operator">==</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> me <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> query <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">createSelectorQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">in</span><span class="token punctuation">(</span>me<span class="token punctuation">)</span><span class="token punctuation">;</span>
    query<span class="token punctuation">.</span><span class="token function">selectViewport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">scrollOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    query<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;#myArchives&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">boundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 定位到的id位置</span>
    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> miss <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>scrollTop <span class="token operator">+</span> res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>top <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">;</span>
      wx<span class="token punctuation">.</span><span class="token function">pageScrollTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        scrollTop<span class="token operator">:</span> miss<span class="token punctuation">,</span>
        duration<span class="token operator">:</span> <span class="token number">1000</span> <span class="token comment">// 滚动动画时间</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序文件预览" tabindex="-1"><a class="header-anchor" href="#小程序文件预览" aria-hidden="true">#</a> 小程序文件预览</h2><ul><li>doc.pdf等文档预览</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>  <span class="token doc-comment comment">/**
   * 预览文件
   * <span class="token keyword">@param</span> <span class="token parameter">urlFile</span>:文件下载地址
   * <span class="token keyword">@param</span> <span class="token parameter">type</span>:文件类型
   * <span class="token keyword">@param</span> <span class="token parameter">fileType</span>: 预览文件类型
   * <span class="token keyword">@param</span> <span class="token parameter">success</span>: 预览成功回调
   * <span class="token keyword">@param</span> <span class="token parameter">fail</span>: 预览失败回调
   * <span class="token keyword">@param</span> <span class="token parameter">filePath</span>：本地缓存虚拟访问地址：大小10MB以内
   */</span>
  <span class="token function">toViewFile</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> type <span class="token operator">=</span>  event<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span><span class="token keyword">type</span>
    <span class="token class-name"><span class="token keyword">if</span></span><span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">var</span> urlFile <span class="token operator">=</span> <span class="token string">&#39;https://staticcdn.shuidi.cn/wiki/移出经营异常名录申请表.doc&#39;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">var</span> urlFile <span class="token operator">=</span> <span class="token string">&#39;https://staticcdn.shuidi.cn/wiki/列入经营异常名录异议申请书.doc&#39;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">var</span> urlFile <span class="token operator">=</span> <span class="token string">&#39;https://staticcdn.shuidi.cn/wiki/个体工商户恢复正常记载状态申请表.doc&#39;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">var</span> urlFile <span class="token operator">=</span> <span class="token string">&#39;https://staticcdn.shuidi.cn/wiki/企业指定代表或者委托代理人的证明书.doc&#39;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 文件下载</span>
    wx<span class="token punctuation">.</span><span class="token function">downloadFile</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      url<span class="token operator">:</span> urlFile<span class="token punctuation">,</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> filePath <span class="token operator">=</span> res<span class="token punctuation">.</span>tempFilePath
          <span class="token comment">// 文件预览</span>
          wx<span class="token punctuation">.</span><span class="token function">openDocument</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
              filePath<span class="token operator">:</span> filePath<span class="token punctuation">,</span>
              fileType<span class="token operator">:</span> <span class="token string">&#39;doc&#39;</span><span class="token punctuation">,</span> 
              <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序分包加载" tabindex="-1"><a class="header-anchor" href="#小程序分包加载" aria-hidden="true">#</a> 小程序分包加载</h2><ul><li><code>app.json</code>配置</li></ul><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;pages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;pages/center/index&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;subpackages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;root&quot;</span><span class="token operator">:</span> <span class="token string">&quot;packageA&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;pages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;pages/activity/index&quot;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;root&quot;</span><span class="token operator">:</span> <span class="token string">&quot;packageA&quot;</span><span class="token punctuation">,</span> 
      <span class="token property">&quot;pages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;pages/activity/index&quot;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>分包文件结构 <img src="/myblog/images/frontEnd/img_11.png" alt="图片"></li></ul><h2 id="小程序路由和传参" tabindex="-1"><a class="header-anchor" href="#小程序路由和传参" aria-hidden="true">#</a> 小程序路由和传参</h2><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>第一种：wx.navigateTo(); 有页面栈栈，根据累加路由栈或者组件父级路径跳转 第二种：router.navigateTo(); 无页面栈，绝对路径跳转；获得的路由器对象更好的基路径稳定性</p></div><h3 id="路由api" tabindex="-1"><a class="header-anchor" href="#路由api" aria-hidden="true">#</a> 路由api</h3><ul><li><code>navigateTo</code> 保留当前页面，跳转到其他页面，可使用<code>wx.navigateBack</code>返回原页面</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  	url<span class="token operator">:</span> <span class="token string">&#39;page/home/home&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>navigateBack</code> 关闭当前页面，返回上一级页面或者多级页面，可通过<code>getCurrentPages()</code>获取当前页面栈序号</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token string">&#39;page/news/news&#39;</span><span class="token comment">// 页面 A</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token string">&#39;page/detail/detail&#39;</span><span class="token comment">// 页面 B</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 跳转到页面 A</span>
wx<span class="token punctuation">.</span><span class="token function">navigateBack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  delta<span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 跳转到上一页</span>
wx<span class="token punctuation">.</span><span class="token function">navigateBack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  delta<span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>redirectTo</code> 关闭当前页面，跳转到应用内的某个页面。</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>wx<span class="token punctuation">.</span><span class="token function">redirectTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token string">&#39;page/home/home&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>switchTab</code> 跳转到tabBar页面（在<code>app.json</code>中注册过的tabBar页面），同时关闭其他非tabBar页面。<strong>不可传参</strong></li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>wx<span class="token punctuation">.</span><span class="token function">switchTab</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token string">&#39;page/index/index&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>reLanch</code> 关闭所有页面，打开到应用内的某个页面。</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>wx<span class="token punctuation">.</span><span class="token function">reLanch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token string">&#39;page/home/home?user_id=111&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="navigator组件" tabindex="-1"><a class="header-anchor" href="#navigator组件" aria-hidden="true">#</a> navigator组件</h3><ul><li>设置 open-type 修改路由类型</li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code>// 跳转到新页面
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>navigator</span> 
     <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/page/navigate/navigate?title=navigate<span class="token punctuation">&quot;</span></span>
     <span class="token attr-name">hover-class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>navigator-hover<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>navigator</span><span class="token punctuation">&gt;</span></span>

//在当前页打开
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>navigator</span>
        <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../../home/home<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">open-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>redirect<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">hover-class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>other-navigator-hover<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>navigator</span><span class="token punctuation">&gt;</span></span>

//切换 Tab
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>navigator</span>
        <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/page/index/index<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">open-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>switchTab<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">hover-class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>other-navigator-hover<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>navigator</span><span class="token punctuation">&gt;</span></span>

//关闭所有页面，打开到应用内`的某个页面
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>navigator</span>
        <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../../login/login<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">open-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>redirect<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">hover-class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>other-navigator-hover<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>navigator</span><span class="token punctuation">&gt;</span></span>

//关闭当前页面，返回上一级页面或多级页面
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>navigator</span>
        <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/page/index/index<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">open-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>navigateBack<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">hover-class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>other-navigator-hover<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>navigator</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="路由跳转传参" tabindex="-1"><a class="header-anchor" href="#路由跳转传参" aria-hidden="true">#</a> 路由跳转传参</h3><ul><li>基本类型传参</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">//传递一个参数</span>
wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">../detail/detail?name=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//传递多个参数</span>
wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">../detail/detail?name=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;&amp;id=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>使用JSON字符串传参复杂类型</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">//传递对象</span>
<span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token punctuation">{</span>
    a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    b<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  	url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">page/home/home?user=$(JSON.stringify(user))</span><span class="token template-punctuation string">`</span></span><span class="token comment">//将对象转换成json字符串</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//在接收页面onLoad方法中获取参数</span>
<span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> user<span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 解析json字符串为对象</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;user &quot;</span><span class="token operator">+</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序自定义组件和使用" tabindex="-1"><a class="header-anchor" href="#小程序自定义组件和使用" aria-hidden="true">#</a> 小程序自定义组件和使用</h2><h3 id="组件传参" tabindex="-1"><a class="header-anchor" href="#组件传参" aria-hidden="true">#</a> 组件传参</h3><ul><li>创建四个基础页面 json wxml wxss js 4个文件组成</li><li>首先需要在 json 文件中进行自定义组件声明（将 component 字段设为 true 可将这一组文件设为自定义组件）：</li></ul><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;component&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>wxml定义组件</li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>inner<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  {{innerText}}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="父子组件传值—父传子" tabindex="-1"><a class="header-anchor" href="#父子组件传值—父传子" aria-hidden="true">#</a> 父子组件传值—父传子</h3><ul><li>js文件中<code>properties</code>属性定义子组件接参，相当于vue中的<code>props[]</code></li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  properties<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这里定义了innerText属性，属性值可以在组件使用时指定</span>
    innerText<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> String<span class="token punctuation">,</span>
      value<span class="token operator">:</span> <span class="token string">&#39;default value&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    commentCount<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Number<span class="token punctuation">,</span>
      value<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    commentItem<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Object<span class="token punctuation">,</span>
      value<span class="token operator">:</span> <span class="token string">&#39;&#39;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这里是一些组件内部数据</span>
    someData<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这里是一个自定义方法</span>
    <span class="token function-variable function">customMethod</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>page内使用组件json文件中注入</li></ul><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;usingComponents&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;component-tag-name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;path/to/the/custom/component&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>组件内传值</li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 以下是对一个自定义组件的引用 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component-tag-name</span> <span class="token attr-name">inner-text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Some text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">innerText</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>传值<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component-tag-name</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="父子组件传值—子传父" tabindex="-1"><a class="header-anchor" href="#父子组件传值—子传父" aria-hidden="true">#</a> 父子组件传值—子传父</h3><ul><li>子组件，使用 <code>triggerEvent</code> 事件传递</li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&#39;</span>twoLevelCommentBtnClick<span class="token punctuation">&#39;</span></span> <span class="token attr-name">data-author-name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>传值内容<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>methods<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// 点击评论按钮</span>
  <span class="token function-variable function">twoLevelCommentBtnClick</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> authorName <span class="token operator">=</span> e<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>authorName<span class="token punctuation">;</span>
    <span class="token comment">// 赋值给事件</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">triggerEvent</span><span class="token punctuation">(</span><span class="token string">&quot;twoLevelCommentBtn&quot;</span><span class="token punctuation">,</span> authorName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>父组件， 通过 <code>bind:</code> 事件接收子事件传递的参数</li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>comment</span> 
    <span class="token attr-name">commentCount</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&#39;</span>{{commentList.length}}<span class="token punctuation">&#39;</span></span>
    <span class="token attr-name">commentItem</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&#39;</span>{{item}}<span class="token punctuation">&#39;</span></span> 
    <span class="token attr-name"><span class="token namespace">bind:</span>twoLevelCommentBtn</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&#39;</span>twoLevelCommentBtnClick<span class="token punctuation">&#39;</span></span> <span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>comment</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token function">twoLevelCommentBtnClick</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    placeholderInput<span class="token operator">:</span> e<span class="token punctuation">.</span>detail
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  consoleUtil<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;点击二级评论按钮：&quot;</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="组件内路由跳转" tabindex="-1"><a class="header-anchor" href="#组件内路由跳转" aria-hidden="true">#</a> 组件内路由跳转</h3><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>使用相对路径： 相对父组件位置跳转；</p></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 绝对路径跳转</span>
wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  	url<span class="token operator">:</span> <span class="token string">&#39;/page/home/home&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 相对路径跳转</span>
wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  	url<span class="token operator">:</span> <span class="token string">&#39;../dir/page/home/home&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="input输入联想" tabindex="-1"><a class="header-anchor" href="#input输入联想" aria-hidden="true">#</a> input输入联想</h2><p><img src="/myblog/images/frontEnd/img_12.png" alt="图片"></p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>weui-input<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>input<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{company_name}}<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">bindinput</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>getCompanyList<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>需开票的企业名称<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scroll-view</span> <span class="token attr-name">scroll-y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scrollview<span class="token punctuation">&quot;</span></span> <span class="token attr-name">hidden</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{hideScroll}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{bindSourceList}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{item.company_name_digest}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>itemView<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{item.credit_no}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>itemtap<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{item}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{item.company_name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scroll-view</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">.scrollview</span><span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span>330rpx<span class="token punctuation">;</span>
  <span class="token property">z-index</span><span class="token punctuation">:</span> 5<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 446rpx<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 320rpx<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #ffffff<span class="token punctuation">;</span>
  <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0 5rpx 20rpx 0 
    <span class="token function">rgba</span><span class="token punctuation">(</span>153<span class="token punctuation">,</span> 153<span class="token punctuation">,</span> 153<span class="token punctuation">,</span> 0.3<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 12rpx<span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 2rpx solid  #eeeeee<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.scrollview .itemView</span><span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 70rpx<span class="token punctuation">;</span>
  <span class="token property">line-height</span><span class="token punctuation">:</span> 70rpx<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 0 20rpx<span class="token punctuation">;</span>
  <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 28rpx<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #333333<span class="token punctuation">;</span>
  <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code> <span class="token doc-comment comment">/**
 * 企业联想请求
 * <span class="token keyword">@param</span> <span class="token parameter">company_name</span>：发票抬头
 * <span class="token keyword">@param</span> <span class="token parameter">key</span>: 输入值传参
 * <span class="token keyword">@param</span> <span class="token parameter">bindSourceList</span>：联想返回列表
 * <span class="token keyword">@param</span> <span class="token parameter">hideScroll</span>：联想弹窗打开
 */</span>
<span class="token function">getCompanyList</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 表单双向绑定</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    company_name<span class="token operator">:</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  
  <span class="token keyword">let</span> key <span class="token operator">=</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value <span class="token operator">+</span> <span class="token string">&quot;&quot;</span>
  http<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>config<span class="token punctuation">.</span>baseUrl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/b-search?action=company_name_notice&amp;key=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    method<span class="token operator">:</span> <span class="token string">&quot;post&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      bindSourceList<span class="token operator">:</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>company_list<span class="token punctuation">,</span>
      hideScroll<span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>


<span class="token doc-comment comment">/**
 * 表单双向绑定
 * <span class="token keyword">@param</span> <span class="token parameter">credit_no</span>： 税号
 * <span class="token keyword">@param</span> <span class="token parameter">phone</span>: 电话号码
 * <span class="token keyword">@param</span> <span class="token parameter">email</span>: 邮箱
 */</span>
<span class="token function">getCredit</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    credit_no<span class="token operator">:</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">getPhone</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    phone<span class="token operator">:</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">getEmail</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    email<span class="token operator">:</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>


 <span class="token doc-comment comment">/**
 * 选中联想企业赋值
 * <span class="token keyword">@param</span> <span class="token parameter">company_name</span>：公司名
 * <span class="token keyword">@param</span> <span class="token parameter">credit_no</span>: 公司税号
 * <span class="token keyword">@param</span> <span class="token parameter">digest</span>：企业唯一标识
 * <span class="token keyword">@param</span> <span class="token parameter">hideScroll</span>: 关闭联想
 */</span>
<span class="token function">itemtap</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    company_name<span class="token operator">:</span> event<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>type<span class="token punctuation">.</span>company_name<span class="token punctuation">,</span>
    credit_no<span class="token operator">:</span> event<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>type<span class="token punctuation">.</span>credit_no<span class="token punctuation">,</span>
    digest<span class="token operator">:</span> event<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>type<span class="token punctuation">.</span>digest<span class="token punctuation">,</span>
    hideScroll<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序自定义导航栏" tabindex="-1"><a class="header-anchor" href="#小程序自定义导航栏" aria-hidden="true">#</a> 小程序自定义导航栏</h2><h3 id="导航栏分析" tabindex="-1"><a class="header-anchor" href="#导航栏分析" aria-hidden="true">#</a> 导航栏分析</h3><ul><li>导航栏整体的高度 = <strong>（状态栏高度 + 导航栏高度）</strong></li><li>状态栏高度可以通过 <code>wx.getSystemInfo()</code> 获取</li><li>导航栏高度 = <strong>胶囊高度 +（胶囊和导航栏之间margin值）x 2</strong></li><li>胶囊信息可以通过 <code>wx.getMenuButtonBoundingClientRect()</code> 获取</li><li><code>wx.getMenuButtonBoundingClientRect()</code> 中也返回了胶囊顶部距屏幕顶部距离的信息</li><li>高度差 = <strong>胶囊顶部距屏幕顶部距离 - 状态栏高度</strong></li></ul><h3 id="导航栏图解" tabindex="-1"><a class="header-anchor" href="#导航栏图解" aria-hidden="true">#</a> 导航栏图解</h3><p><img src="/myblog/images/frontEnd/img_13.png" alt="图片"><img src="/myblog/images/frontEnd/img_14.png" alt="图片"></p><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code> // 胶囊背景色、边框
  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> .15<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> solid 2rpx  <span class="token function">rgba</span><span class="token punctuation">(</span>255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> .25<span class="token punctuation">)</span><span class="token punctuation">;</span>
 // 胶囊中划线
  <span class="token property">width</span><span class="token punctuation">:</span> 2rpx<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> .25<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 34rpx<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
  <span class="token property">z-index</span><span class="token punctuation">:</span> 2<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="组件封装" tabindex="-1"><a class="header-anchor" href="#组件封装" aria-hidden="true">#</a> 组件封装</h3><ul><li>app.js</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  globalData<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onLaunch</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//获取系统信息</span>
    wx<span class="token punctuation">.</span><span class="token function">getSystemInfo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> res <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>system <span class="token operator">=</span> res
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">//获取胶囊信息</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>menu <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getMenuButtonBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">//打印数据</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;系统信息&#39;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>system<span class="token punctuation">)</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;胶囊信息&#39;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>menu<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>组件代码</li><li><code>cover-view</code>标签内必须嵌套<code>cover</code>标签，否者可能真机无效或者报错</li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!--
  @description: 自定义导航栏组件
  @author: hhd (2021-07-06)
  @update: 
--&gt;</span>

<span class="token comment">&lt;!-- 
  @description: 组件使用说明
  属  性          类  型      默认值          是否必填      说  明
  navColor        string     #dd3239         否           导航栏背景颜色设置
  title           string     空              否           导航栏标题设置
  titleColor      string     #fff            否           导航栏标题颜色设置
  titlePlace      string     title-center    否           标题位置设置，居中：title-center ，左对齐：title-left
  navType         string     1               否           导航栏类型, 返回上一页：1，双按钮：2，返回首页：3
--&gt;</span>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cover-view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>nav-box<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token selector">background-color:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>navColor<span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cover-view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>status-bar<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token selector">height:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>statusHeight<span class="token punctuation">}</span><span class="token punctuation">}</span>px</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cover-view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cover-view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>nav-bar<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token selector">height:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>navHeight<span class="token punctuation">}</span><span class="token punctuation">}</span>px</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- 导航栏返回-上一页 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>block</span> <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{navType == 1}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cover-view</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>back<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cover-image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>img-back<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../../img/center/personal/personal-back.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cover-image</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cover-view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>block</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- 导航栏返回-双按钮 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>block</span> <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{navType == 2}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cover-view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>back<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token selector">height:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>menuHeight<span class="token punctuation">}</span><span class="token punctuation">}</span>px<span class="token punctuation">;</span> <span class="token selector">border-radius:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>menuHeight*0.5<span class="token punctuation">}</span><span class="token punctuation">}</span>px</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cover-view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>left<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>back<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cover-image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>img1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../../img/center/personal/personal-back.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cover-image</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cover-view</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cover-view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>line<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cover-view</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cover-view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>right<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>backHome<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cover-image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>img2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../../img/center/personal/back-home.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cover-image</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cover-view</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cover-view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>block</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- 导航栏返回-首页--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>block</span> <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{navType == 3}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cover-view</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>backHome<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>back-home<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token selector">height:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>menuHeight<span class="token punctuation">}</span><span class="token punctuation">}</span>px<span class="token punctuation">;</span> <span class="token selector">width:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>menuHeight<span class="token punctuation">}</span><span class="token punctuation">}</span>px<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cover-image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>img-home<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../../img/center/personal/back-home.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cover-image</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cover-view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>block</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- 导航栏标题 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cover-view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{titlePlace}}<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token selector">color:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>titleColor<span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>{{navTitle}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cover-view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cover-view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cover-view</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token comment">/* 组件盒子 */</span>
<span class="token selector">.nav-box</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 750rpx<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 32rpx<span class="token punctuation">;</span>
  <span class="token property">z-index</span><span class="token punctuation">:</span> 2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 导航栏 */</span>
<span class="token selector">.nav-box .nav-bar</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 0 30rpx<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 导航栏按钮-返回上一页 */</span>
<span class="token selector">.img-back</span><span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 16rpx<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 导航栏按钮-返回首页*/</span>
<span class="token selector">.back-home</span><span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> .15<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> solid 2rpx  <span class="token function">rgba</span><span class="token punctuation">(</span>255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> .25<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.img-home</span><span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 28rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 返回按钮-双按钮 */</span>
<span class="token selector">.nav-bar .back</span><span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 175rpx<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> space-between<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> .15<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> solid 2rpx  <span class="token function">rgba</span><span class="token punctuation">(</span>255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> .25<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.back .left</span><span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 87rpx<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.left .img1</span><span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 12rpx<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 22rpx<span class="token punctuation">;</span>
 
<span class="token punctuation">}</span>
<span class="token selector">.back .line</span><span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 2rpx<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> .25<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 34rpx<span class="token punctuation">;</span>
  <span class="token property">z-index</span><span class="token punctuation">:</span> 2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.back .right</span><span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 87rpx<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.right .img2</span><span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 28rpx<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 26rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 标题居中：默认 */</span>
<span class="token selector">.nav-bar .title-center</span><span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateX</span><span class="token punctuation">(</span>-50%<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 标题居中 */</span>
<span class="token selector">.nav-bar .title-left</span><span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token doc-comment comment">/**
   * 组件的属性列表
   * Created by hhd on 2021-07-06, 自定义导航栏组件
   * <span class="token keyword">@param</span> <span class="token parameter">navTitle</span>: 导航栏标题
   * <span class="token keyword">@param</span> <span class="token parameter">navColor</span>: 导航栏背景颜色
   * <span class="token keyword">@param</span> <span class="token parameter">titleColor</span>: 导航栏标题颜色
   * <span class="token keyword">@param</span> <span class="token parameter">titlePlace</span>: 导航栏标题位置：居中：title-center，左对齐：title-left
   * <span class="token keyword">@param</span> <span class="token parameter">navType</span>: 导航栏类型，返回上一页：1，双按钮：2，返回首页：3
   */</span>
  properties<span class="token operator">:</span> <span class="token punctuation">{</span>
    navTitle<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> String<span class="token punctuation">,</span>
      value<span class="token operator">:</span> <span class="token string">&#39;&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    navColor<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> String<span class="token punctuation">,</span>
      value<span class="token operator">:</span> <span class="token string">&#39;#dd3239&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    titleColor<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> String<span class="token punctuation">,</span>
      value<span class="token operator">:</span> <span class="token string">&#39;#fff&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    titlePlace<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> String<span class="token punctuation">,</span>
      value<span class="token operator">:</span> <span class="token string">&#39;title-center&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    navType<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> String<span class="token punctuation">,</span>
      value<span class="token operator">:</span> <span class="token string">&#39;1&#39;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token doc-comment comment">/**
   * 组件的初始数据
   * <span class="token keyword">@param</span> <span class="token parameter">statusHeight</span>: 状态栏高度
   * <span class="token keyword">@param</span> <span class="token parameter">navHeight</span>: 航栏高度
   * <span class="token keyword">@param</span> <span class="token parameter">menuHeight</span>: 胶囊高度
   */</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 此处使用原有接参globalData.navigation代替system</span>
    statusHeight<span class="token operator">:</span> app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>navigation<span class="token punctuation">.</span>statusBarHeight <span class="token punctuation">,</span>
    navHeight<span class="token operator">:</span> <span class="token punctuation">(</span>app<span class="token punctuation">.</span>menu<span class="token punctuation">.</span>top <span class="token operator">-</span> app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>navigation<span class="token punctuation">.</span>statusBarHeight<span class="token punctuation">)</span> 
    <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> app<span class="token punctuation">.</span>menu<span class="token punctuation">.</span>height<span class="token punctuation">,</span> 
    menuHeight<span class="token operator">:</span> app<span class="token punctuation">.</span>menu<span class="token punctuation">.</span>height<span class="token punctuation">,</span> 
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token doc-comment comment">/**
   * 组件的方法列表
   */</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * 返回首页
     * 组件内使用路径：/pages/center/index
     */</span>
    <span class="token function">backHome</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token string">&#39;/pages/center/index&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    <span class="token doc-comment comment">/**
     * 返回上一页
     */</span>
    <span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      wx<span class="token punctuation">.</span><span class="token function">navigateBack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        delta<span class="token operator">:</span> <span class="token number">1</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="组件使用" tabindex="-1"><a class="header-anchor" href="#组件使用" aria-hidden="true">#</a> 组件使用</h3><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;navigationStyle&quot;</span><span class="token operator">:</span><span class="token string">&quot;custom&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;usingComponents&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;navgation-bar&quot;</span><span class="token operator">:</span> <span class="token string">&quot;../../../mycomponents/navgation-bar&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- 自定义导航栏组件 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>navgation-bar</span> <span class="token attr-name">navTitle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>经营异常移出<span class="token punctuation">&quot;</span></span> <span class="token attr-name">navType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>navgation-bar</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序复制文本到到粘贴板" tabindex="-1"><a class="header-anchor" href="#小程序复制文本到到粘贴板" aria-hidden="true">#</a> 小程序复制文本到到粘贴板</h2><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token doc-comment comment">/**
 * 复制链接到粘贴板
 */</span>
<span class="token function">copyHref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> href <span class="token operator">=</span> <span class="token string">&quot;http://www.gsxt.gov.cn/&quot;</span><span class="token punctuation">;</span>
  wx<span class="token punctuation">.</span><span class="token function">setClipboardData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    data<span class="token operator">:</span> href<span class="token punctuation">,</span>
    <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">{</span>
      wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        title<span class="token operator">:</span> <span class="token string">&#39;复制成功&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">fail</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">{</span>
      wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        title<span class="token operator">:</span> <span class="token string">&#39;复制失败&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序多选列表开发票组件" tabindex="-1"><a class="header-anchor" href="#小程序多选列表开发票组件" aria-hidden="true">#</a> 小程序多选列表开发票组件</h2><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>checkbox-group</span>  <span class="token attr-name">bindchange</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkboxChange<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{invoiceList}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{item.order_no}}<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>left<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>check<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>checkbox</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{item.order_no}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">checked</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{item.checked}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{item.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>time<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{item.add_time}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>right<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>price<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{item.price}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>元<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>status<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>未申请开票<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>checkbox-group</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token comment">/*  重写 checkbox 样式  */</span>
<span class="token comment">/* 未选中的 背景样式 */</span>
<span class="token selector">checkbox .wx-checkbox-input</span><span class="token punctuation">{</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span><span class="token comment">/* 圆角 */</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span> <span class="token comment">/* 背景的宽 */</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span> <span class="token comment">/* 背景的高 */</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 选中后的 背景样式 （红色背景 无边框 可根据UI需求自己修改） */</span>
<span class="token selector">checkbox .wx-checkbox-input.wx-checkbox-input-checked</span><span class="token punctuation">{</span>
  <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> #1ec56a<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 选中后的 对勾样式 （白色对勾） */</span>
<span class="token selector">checkbox .wx-checkbox-input.wx-checkbox-input-checked::before</span><span class="token punctuation">{</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span><span class="token comment">/* 圆角 */</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span><span class="token comment">/* 选中后对勾大小，不要超过背景的尺寸 */</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span><span class="token comment">/* 选中后对勾大小，不要超过背景的尺寸 */</span>
  <span class="token property">line-height</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span>30rpx<span class="token punctuation">;</span> <span class="token comment">/* 对勾大小 30rpx */</span>
  <span class="token property">color</span><span class="token punctuation">:</span>#fff<span class="token punctuation">;</span> <span class="token comment">/* 对勾颜色 白色 */</span>
  <span class="token property">background</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span><span class="token function">translate</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span> -50%<span class="token punctuation">)</span> <span class="token function">scale</span><span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">-webkit-transform</span><span class="token punctuation">:</span><span class="token function">translate</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span> -50%<span class="token punctuation">)</span> <span class="token function">scale</span><span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>  <span class="token comment">// 添加勾选参数：默认全选</span>
 <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> item <span class="token keyword">of</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>un_apply<span class="token punctuation">)</span><span class="token punctuation">{</span>
   item<span class="token punctuation">.</span>checked <span class="token operator">=</span> <span class="token boolean">true</span>
 <span class="token punctuation">}</span>
     
  <span class="token doc-comment comment">/**
   * 列表多选样式控制
   * <span class="token keyword">@param</span> <span class="token parameter">checkOrderList</span>  values: 选中列表order_no集
   * <span class="token keyword">@param</span> <span class="token parameter">invoiceList</span>: 待开票列表
   * <span class="token keyword">@param</span> <span class="token parameter">checked</span>: 是否勾选状态
   */</span>
  <span class="token function">checkboxChange</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 选中列表order_no List</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> checkOrderList<span class="token operator">:</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> items <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>invoiceList
    <span class="token keyword">const</span> values <span class="token operator">=</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> lenI <span class="token operator">=</span> items<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> lenI<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      items<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>checked <span class="token operator">=</span> <span class="token boolean">false</span>

      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> lenJ <span class="token operator">=</span> values<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j <span class="token operator">&lt;</span> lenJ<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>items<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>order_no <span class="token operator">===</span> values<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          items<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>checked <span class="token operator">=</span> <span class="token boolean">true</span>
          <span class="token keyword">break</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 勾选操作后赋值checked状态</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      invoiceList<span class="token operator">:</span> items
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  
  <span class="token comment">// 合计总金额</span>
  <span class="token keyword">let</span> total <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">let</span> order_ids <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> item <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>invoiceList<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>checked <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      total <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token operator">+</span>item<span class="token punctuation">.</span>price<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> totalPrice<span class="token operator">:</span> total <span class="token punctuation">}</span><span class="token punctuation">)</span> 
  
  <span class="token comment">// order_no选中订单id拼接</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> item <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>checkOrderList<span class="token punctuation">)</span><span class="token punctuation">{</span>
    order_ids <span class="token operator">+=</span> item <span class="token operator">+</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> order_ids<span class="token operator">:</span> order_ids <span class="token punctuation">}</span><span class="token punctuation">)</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序使用canvas旋转图片" tabindex="-1"><a class="header-anchor" href="#小程序使用canvas旋转图片" aria-hidden="true">#</a> 小程序使用canvas旋转图片</h2><div class="custom-container tip"><p class="custom-container-title">思路</p><p>创建一个新的<code>canvas</code>画布，隐藏到屏幕外，做旋转处理；</p></div><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> 
      <span class="token attr-name">canvas-id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>canvas<span class="token punctuation">&quot;</span></span> 
      <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token selector">width:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>imageWidth<span class="token punctuation">}</span><span class="token punctuation">}</span>px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>imageHeight<span class="token punctuation">}</span><span class="token punctuation">}</span>px<span class="token punctuation">;</span><span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span><span class="token property">top</span><span class="token punctuation">:</span>200%</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code> <span class="token doc-comment comment">/**
   * base64图片旋转
   * <span class="token keyword">@param</span> <span class="token parameter">src</span> 图片文件
   * <span class="token keyword">@param</span> <span class="token parameter">edg</span> 图片旋转角度：必须是90的倍数
   */</span>
  <span class="token function">rotateBase64Img</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> edg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    wx<span class="token punctuation">.</span><span class="token function">getImageInfo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      src<span class="token operator">:</span> src<span class="token punctuation">,</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
          <span class="token keyword">let</span> canvasContext <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">createCanvasContext</span><span class="token punctuation">(</span><span class="token string">&#39;canvas&#39;</span><span class="token punctuation">)</span>
          <span class="token keyword">var</span> width <span class="token operator">=</span> res<span class="token punctuation">.</span>width<span class="token punctuation">;</span>
          <span class="token keyword">var</span> height <span class="token operator">=</span> res<span class="token punctuation">.</span>height<span class="token punctuation">;</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            imageWidth<span class="token operator">:</span> height<span class="token punctuation">,</span>
            imageHeight<span class="token operator">:</span> width<span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
          canvasContext<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span>height <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span>                 
          canvasContext<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span>edg <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span>
          canvasContext<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> <span class="token operator">-</span> width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span> height <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>
          canvasContext<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token doc-comment comment">/**
   * 旋转后生成图片
   */</span>
  <span class="token function">drawImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> that <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      wx<span class="token punctuation">.</span><span class="token function">canvasToTempFilePath</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        x<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        y<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        canvasId<span class="token operator">:</span> <span class="token string">&#39;canvas&#39;</span><span class="token punctuation">,</span>
        <span class="token function">success</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">let</span> shareImg <span class="token operator">=</span> res<span class="token punctuation">.</span>tempFilePath<span class="token punctuation">;</span>
          <span class="token comment">// 生成旋转后的图片文件</span>
          that<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            tmpPath<span class="token operator">:</span> shareImg
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token comment">// 上传图片</span>
          that<span class="token punctuation">.</span><span class="token function">upImgs</span><span class="token punctuation">(</span>shareImg<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小程序调用微信企业客服" tabindex="-1"><a class="header-anchor" href="#小程序调用微信企业客服" aria-hidden="true">#</a> 小程序调用微信企业客服</h2><h3 id="小程序内直接使用" tabindex="-1"><a class="header-anchor" href="#小程序内直接使用" aria-hidden="true">#</a> 小程序内直接使用</h3><ul><li>必须用户点击才可以触发</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>wx<span class="token punctuation">.</span><span class="token function">openCustomerServiceChat</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  extInfo<span class="token operator">:</span> <span class="token punctuation">{</span>url<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  corpId<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
  <span class="token function">success</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="小程序web-view页面使用" tabindex="-1"><a class="header-anchor" href="#小程序web-view页面使用" aria-hidden="true">#</a> 小程序web-view页面使用</h3><ul><li>因为需要用户点击，所以需要在小程序内新增一个客服中转页供用户点击</li><li>跳转到小程序原生客服页，使用小程序内调用方法打开</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> weixin-js-sdk --save
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">//页面引入sdk</span>
<span class="token keyword">import</span> wx <span class="token keyword">from</span> <span class="token string">&quot;weixin-js-sdk&quot;</span><span class="token punctuation">;</span>

wx<span class="token punctuation">.</span>miniProgram<span class="token punctuation">.</span><span class="token function">redirectTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token string">&quot;/pages/customer/index?id=1&quot;</span><span class="token punctuation">,</span> <span class="token comment">// id:所需参数</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 页面跳转成功的回调函数</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 页面跳转失败的回调函数</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>参考文档：</li><li><a href="https://developers.weixin.qq.com/miniprogram/dev/api/open-api/service-chat/wx.openCustomerServiceChat.html" target="_blank" rel="noopener noreferrer">https://developers.weixin.qq.com/miniprogram/dev/api/open-api/service-chat/wx.openCustomerServiceChat.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://developer.work.weixin.qq.com/document/path/94848" target="_blank" rel="noopener noreferrer">https://developer.work.weixin.qq.com/document/path/94848<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: haohaidong@pingansec.com">haohaidong</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: haohaidong@pingansec.com">hhd</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: 15147218548abc@gmail.com">haohaidong</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/myblog/frontEnd/frame/wechatMini/webviewBridge.html" class="" aria-label="WebView Bridge 跨平台方案：统一 API 实现多端小程序通信"><!--[--><!--]--> WebView Bridge 跨平台方案：统一 API 实现多端小程序通信 <!--[--><!--]--></a></span><!----></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/myblog/assets/app.4c8b15c1.js" defer></script>
  </body>
</html>
