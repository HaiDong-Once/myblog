import{_ as n,o as s,c as a,e as p}from"./app.4c8b15c1.js";const t={},o=p(`<h1 id="\u56FE\u7247\u4E0A\u4F20\u901F\u5EA6\u76D1\u542C\u548C\u4E2D\u65AD\u4E0A\u4F20" tabindex="-1"><a class="header-anchor" href="#\u56FE\u7247\u4E0A\u4F20\u901F\u5EA6\u76D1\u542C\u548C\u4E2D\u65AD\u4E0A\u4F20" aria-hidden="true">#</a> \u56FE\u7247\u4E0A\u4F20\u901F\u5EA6\u76D1\u542C\u548C\u4E2D\u65AD\u4E0A\u4F20</h1><div class="custom-container tip"><p class="custom-container-title">\u8BF4\u660E\uFF1A</p><ul><li>\u4E0A\u4F20\u901F\u5EA6\u76D1\u542C <code>onUploadProgress</code> \u65B9\u6CD5</li><li>\u4E2D\u65AD\u8BF7\u6C42\uFF1Avue \u9879\u76EE\u4E2D\u4F7F\u7528 <code>axios</code> \u7684 <code>CancelToken</code></li></ul></div><h2 id="onuploadprogress" tabindex="-1"><a class="header-anchor" href="#onuploadprogress" aria-hidden="true">#</a> onUploadProgress</h2><p><code>onUploadProgress</code> \u662F\u4E00\u4E2A\u7528\u4E8E\u76D1\u89C6\u6587\u4EF6\u4E0A\u4F20\u8FDB\u5EA6\u7684\u4E8B\u4EF6\u5904\u7406\u7A0B\u5E8F\u3002\u5B83\u901A\u5E38\u7528\u4E8E\u4E0E\u670D\u52A1\u5668\u8FDB\u884C\u6587\u4EF6\u4E0A\u4F20\u4EA4\u4E92\u7684\u524D\u7AEF\u5F00\u53D1\u4E2D\uFF0C \u53EF\u4EE5\u901A\u8FC7\u8BE5\u4E8B\u4EF6\u6765\u83B7\u53D6\u4E0A\u4F20\u6587\u4EF6\u7684\u8FDB\u5EA6\u4FE1\u606F\u5E76\u8FDB\u884C\u76F8\u5E94\u7684\u5904\u7406</p><h2 id="\u4EE3\u7801\u5B9E\u73B0" tabindex="-1"><a class="header-anchor" href="#\u4EE3\u7801\u5B9E\u73B0" aria-hidden="true">#</a> \u4EE3\u7801\u5B9E\u73B0</h2><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">&#39;axios&#39;</span>

<span class="token function">handleUpload</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> that <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>uploadPercent <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>tipsPopFlag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  
  <span class="token keyword">const</span> <span class="token punctuation">{</span> file <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">validateImg</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u521B\u5EFA FormData \u5BF9\u8C61\uFF0C\u7528\u4E8E\u5C01\u88C5\u4E0A\u4F20\u6570\u636E</span>
    data<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&#39;file&#39;</span><span class="token punctuation">,</span> file<span class="token punctuation">)</span> <span class="token comment">// \u5C06\u6587\u4EF6\u5BF9\u8C61\u6DFB\u52A0\u5230 FormData \u4E2D</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$http</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      method<span class="token operator">:</span> <span class="token string">&#39;POST&#39;</span><span class="token punctuation">,</span>
      url<span class="token operator">:</span> <span class="token string">&#39;//upload.........&#39;</span><span class="token punctuation">,</span>
      data<span class="token punctuation">,</span>
      <span class="token comment">// \u4E0A\u4F20\u8FDB\u5EA6\u76D1\u542C</span>
      <span class="token function-variable function">onUploadProgress</span><span class="token operator">:</span> <span class="token punctuation">(</span>progressEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>uploadPercent <span class="token operator">=</span>
         Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span>progressEvent<span class="token punctuation">.</span>loaded <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">/</span> progressEvent<span class="token punctuation">.</span>total<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// \u4E2D\u65AD\u8BF7\u6C42\u8BBE\u7F6E</span>
      cancelToken<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">axios</span><span class="token punctuation">.</span><span class="token function">CancelToken</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">executor</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        that<span class="token punctuation">.</span>cancelUploadFun <span class="token operator">=</span> c<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        
      <span class="token keyword">this</span><span class="token punctuation">.</span>tipsPopFlag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>err <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      err <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$toast</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>tipsPopFlag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
     res <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$toast</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token doc-comment comment">/**
 * \u53D6\u6D88\u4E0A\u4F20
 */</span>
<span class="token function">cancelUpload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cancelUploadFun <span class="token operator">===</span><span class="token string">&#39;function&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">cancelUploadFun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6),e=[o];function c(l,i){return s(),a("div",null,e)}var k=n(t,[["render",c],["__file","workApply23.html.vue"]]);export{k as default};
