import{_ as p,r as t,o as e,c as o,b as n,a as c,e as i,d as s}from"./app.4c8b15c1.js";const l={},u=i(`<h1 id="webview-bridge-\u8DE8\u5E73\u53F0\u65B9\u6848-\u7EDF\u4E00-api-\u5B9E\u73B0\u591A\u7AEF\u5C0F\u7A0B\u5E8F\u901A\u4FE1" tabindex="-1"><a class="header-anchor" href="#webview-bridge-\u8DE8\u5E73\u53F0\u65B9\u6848-\u7EDF\u4E00-api-\u5B9E\u73B0\u591A\u7AEF\u5C0F\u7A0B\u5E8F\u901A\u4FE1" aria-hidden="true">#</a> WebView Bridge \u8DE8\u5E73\u53F0\u65B9\u6848\uFF1A\u7EDF\u4E00 API \u5B9E\u73B0\u591A\u7AEF\u5C0F\u7A0B\u5E8F\u901A\u4FE1</h1><h2 id="\u6982\u8FF0" tabindex="-1"><a class="header-anchor" href="#\u6982\u8FF0" aria-hidden="true">#</a> \u6982\u8FF0</h2><p>\u56E0\u9879\u76EE\u4E2D\u5C0F\u7A0B\u5E8F\u4F7F\u7528 uniapp \u5F00\u53D1\uFF0C\u6253\u5305\u53D1\u5E03\u5FAE\u4FE1\u3001\u652F\u4ED8\u5B9D\uFF0C\u5934\u6761\u5C0F\u7A0B\u5E8F\uFF0C\u5176\u4E2D\u90E8\u5206\u9875\u9762\u9700\u8981\u4F7F\u7528webview\u505A\u8DF3\u8F6C\uFF0C\u5B9E\u6D4Buniapp api\u65E0\u6548\uFF0C\u6240\u4EE5\u5C1D\u8BD5\u81EA\u4E3B\u5C01\u88C5\u591A\u4E2A\u5C0F\u7A0B\u5E8Fapi, \u5728H5\u9875\u9762\u4E2D\u5F15\u5165\u4F7F\u7528\u3002 <code>webviewBridge</code> \u662F\u4E00\u4E2A\u8DE8\u5E73\u53F0\u7684 WebView \u6865\u63A5\u5DE5\u5177\uFF0C\u63D0\u4F9B\u4E86\u7EDF\u4E00\u7684 API \u63A5\u53E3\u6765\u5B9E\u73B0 Web \u9875\u9762\u4E0E\u5404\u79CD\u5C0F\u7A0B\u5E8F\u5BBF\u4E3B\u73AF\u5883\u7684\u901A\u4FE1\u3002\u652F\u6301\u5FAE\u4FE1\u5C0F\u7A0B\u5E8F\u3001QQ \u5C0F\u7A0B\u5E8F\u3001\u652F\u4ED8\u5B9D\u5C0F\u7A0B\u5E8F\u3001\u767E\u5EA6\u5C0F\u7A0B\u5E8F\u3001\u5B57\u8282\u8DF3\u52A8\u5C0F\u7A0B\u5E8F\uFF1B</p><h2 id="\u7279\u6027" tabindex="-1"><a class="header-anchor" href="#\u7279\u6027" aria-hidden="true">#</a> \u7279\u6027</h2><ul><li>\u{1F310} <strong>\u8DE8\u5E73\u53F0\u652F\u6301</strong>\uFF1A\u81EA\u52A8\u68C0\u6D4B\u8FD0\u884C\u73AF\u5883\uFF0C\u652F\u6301\u591A\u79CD\u5C0F\u7A0B\u5E8F\u5E73\u53F0</li><li>\u{1F4F1} <strong>\u7EDF\u4E00 API</strong>\uFF1A\u63D0\u4F9B\u4E00\u81F4\u7684\u63A5\u53E3\uFF0C\u65E0\u9700\u5173\u5FC3\u5E95\u5C42\u5B9E\u73B0\u5DEE\u5F02</li><li>\u{1F527} <strong>\u81EA\u52A8\u52A0\u8F7D</strong>\uFF1A\u81EA\u52A8\u52A0\u8F7D\u5BF9\u5E94\u5E73\u53F0\u7684 SDK</li><li>\u{1F3AF} <strong>\u7C7B\u578B\u5B89\u5168</strong>\uFF1AES6 \u6A21\u5757\u5316\uFF0C\u652F\u6301\u73B0\u4EE3\u5F00\u53D1\u5DE5\u5177</li></ul><h2 id="\u652F\u6301\u7684\u5E73\u53F0" tabindex="-1"><a class="header-anchor" href="#\u652F\u6301\u7684\u5E73\u53F0" aria-hidden="true">#</a> \u652F\u6301\u7684\u5E73\u53F0</h2><table><thead><tr><th>\u5E73\u53F0</th><th>\u73AF\u5883\u6807\u8BC6</th><th>SDK \u6765\u6E90</th></tr></thead><tbody><tr><td>\u5FAE\u4FE1\u5C0F\u7A0B\u5E8F</td><td>wx</td><td>https://res.wx.qq.com/open/js/jweixin-1.3.2.js</td></tr><tr><td>QQ \u5C0F\u7A0B\u5E8F</td><td>qq</td><td>https://qqq.gtimg.cn/miniprogram/webview_jssdk/qqjssdk-1.0.0.js</td></tr><tr><td>\u652F\u4ED8\u5B9D\u5C0F\u7A0B\u5E8F</td><td>my</td><td>https://appx/web-view.min.js</td></tr><tr><td>\u767E\u5EA6\u5C0F\u7A0B\u5E8F</td><td>swan</td><td>https://b.bdstatic.com/searchbox/icms/searchbox/js/swan-2.0.4.js</td></tr><tr><td>\u5B57\u8282\u8DF3\u52A8\u5C0F\u7A0B\u5E8F</td><td>tt</td><td>https://lf3-cdn-tos.bytegoofy.com/obj/goofy/developer/jssdk/jssdk-1.2.1.js</td></tr></tbody></table><h2 id="\u5B89\u88C5\u4E0E\u5F15\u5165" tabindex="-1"><a class="header-anchor" href="#\u5B89\u88C5\u4E0E\u5F15\u5165" aria-hidden="true">#</a> \u5B89\u88C5\u4E0E\u5F15\u5165</h2><h3 id="es6-\u6A21\u5757\u65B9\u5F0F" tabindex="-1"><a class="header-anchor" href="#es6-\u6A21\u5757\u65B9\u5F0F" aria-hidden="true">#</a> ES6 \u6A21\u5757\u65B9\u5F0F</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> webviewBridge <span class="token keyword">from</span> <span class="token string">&#39;@/utils/webviewBridge.js&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="\u5728-vue-\u7EC4\u4EF6\u4E2D\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#\u5728-vue-\u7EC4\u4EF6\u4E2D\u4F7F\u7528" aria-hidden="true">#</a> \u5728 Vue \u7EC4\u4EF6\u4E2D\u4F7F\u7528</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u5728 Vue \u7EC4\u4EF6\u4E2D</span>
<span class="token keyword">import</span> webviewBridge <span class="token keyword">from</span> <span class="token string">&#39;@/utils/webviewBridge.js&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u4F7F\u7528 webviewBridge</span>
    webviewBridge<span class="token punctuation">.</span><span class="token function">getEnv</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u5F53\u524D\u73AF\u5883:&#39;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u57FA\u7840\u7528\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u57FA\u7840\u7528\u6CD5" aria-hidden="true">#</a> \u57FA\u7840\u7528\u6CD5</h2><h3 id="_1-\u73AF\u5883\u68C0\u6D4B" tabindex="-1"><a class="header-anchor" href="#_1-\u73AF\u5883\u68C0\u6D4B" aria-hidden="true">#</a> 1. \u73AF\u5883\u68C0\u6D4B</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u83B7\u53D6\u5F53\u524D\u8FD0\u884C\u73AF\u5883</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">getEnv</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u73AF\u5883\u4FE1\u606F:&#39;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Web \u73AF\u5883\u8FD4\u56DE: { webapp: true }</span>
  <span class="token comment">// RN \u73AF\u5883\u8FD4\u56DE: { reactNative: true }</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-\u9875\u9762\u5BFC\u822A" tabindex="-1"><a class="header-anchor" href="#_2-\u9875\u9762\u5BFC\u822A" aria-hidden="true">#</a> 2. \u9875\u9762\u5BFC\u822A</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u5BFC\u822A\u5230\u6307\u5B9A\u9875\u9762</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;/pages/detail/detail?id=123&#39;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u5BFC\u822A\u6210\u529F&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u5BFC\u822A\u5931\u8D25&#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u8FD4\u56DE\u4E0A\u4E00\u9875</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">navigateBack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">delta</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// \u8FD4\u56DE\u5C42\u6570</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u8FD4\u56DE\u6210\u529F&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u5207\u6362\u5230 Tab \u9875\u9762</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">switchTab</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;/pages/index/index&#39;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u5207\u6362\u6210\u529F&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u91CD\u65B0\u52A0\u8F7D\u9875\u9762</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">reLaunch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;/pages/index/index&#39;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u91CD\u8F7D\u6210\u529F&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u91CD\u5B9A\u5411\u5230\u6307\u5B9A\u9875\u9762</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">redirectTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;/pages/detail/detail?id=123&#39;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u91CD\u5B9A\u5411\u6210\u529F&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-\u4F4D\u7F6E\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#_3-\u4F4D\u7F6E\u670D\u52A1" aria-hidden="true">#</a> 3. \u4F4D\u7F6E\u670D\u52A1</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u83B7\u53D6\u5F53\u524D\u4F4D\u7F6E</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">getLocation</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;wgs84&#39;</span><span class="token punctuation">,</span> <span class="token comment">// \u5750\u6807\u7C7B\u578B</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u7EAC\u5EA6:&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>latitude<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u7ECF\u5EA6:&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>longitude<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u83B7\u53D6\u4F4D\u7F6E\u5931\u8D25&#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u6253\u5F00\u5730\u56FE\u9009\u62E9\u4F4D\u7F6E</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">openLocation</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">latitude</span><span class="token operator">:</span> <span class="token number">39.908823</span><span class="token punctuation">,</span>
  <span class="token literal-property property">longitude</span><span class="token operator">:</span> <span class="token number">116.397470</span><span class="token punctuation">,</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;\u5317\u4EAC\u5929\u5B89\u95E8&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token string">&#39;\u5317\u4EAC\u5E02\u4E1C\u57CE\u533A\u4E1C\u957F\u5B89\u8857&#39;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u6253\u5F00\u5730\u56FE\u6210\u529F&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-\u56FE\u7247\u5904\u7406" tabindex="-1"><a class="header-anchor" href="#_4-\u56FE\u7247\u5904\u7406" aria-hidden="true">#</a> 4. \u56FE\u7247\u5904\u7406</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u9009\u62E9\u56FE\u7247</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">chooseImage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// \u6700\u591A\u9009\u62E9\u56FE\u7247\u6570\u91CF</span>
  <span class="token literal-property property">sizeType</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;original&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;compressed&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// \u56FE\u7247\u5C3A\u5BF8</span>
  <span class="token literal-property property">sourceType</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;album&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;camera&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// \u56FE\u7247\u6765\u6E90</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u9009\u62E9\u7684\u56FE\u7247:&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>tempFilePaths<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u9884\u89C8\u56FE\u7247</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">previewImage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">current</span><span class="token operator">:</span> <span class="token string">&#39;https://example.com/image1.jpg&#39;</span><span class="token punctuation">,</span> <span class="token comment">// \u5F53\u524D\u663E\u793A\u56FE\u7247</span>
  <span class="token literal-property property">urls</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// \u56FE\u7247\u5217\u8868</span>
    <span class="token string">&#39;https://example.com/image1.jpg&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;https://example.com/image2.jpg&#39;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u9884\u89C8\u6210\u529F&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-\u7F51\u7EDC\u72B6\u6001" tabindex="-1"><a class="header-anchor" href="#_5-\u7F51\u7EDC\u72B6\u6001" aria-hidden="true">#</a> 5. \u7F51\u7EDC\u72B6\u6001</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u83B7\u53D6\u7F51\u7EDC\u72B6\u6001</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">getNetworkType</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u7F51\u7EDC\u7C7B\u578B:&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>networkType<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// wifi\u30012g\u30013g\u30014g\u3001unknown\u3001none</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-\u6D88\u606F\u901A\u4FE1" tabindex="-1"><a class="header-anchor" href="#_6-\u6D88\u606F\u901A\u4FE1" aria-hidden="true">#</a> 6. \u6D88\u606F\u901A\u4FE1</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u5411\u5C0F\u7A0B\u5E8F\u53D1\u9001\u6D88\u606F</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;userAction&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">payload</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">action</span><span class="token operator">:</span> <span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">&#39;button&#39;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u5FAE\u4FE1\u5C0F\u7A0B\u5E8F\u7279\u6709\u529F\u80FD" tabindex="-1"><a class="header-anchor" href="#\u5FAE\u4FE1\u5C0F\u7A0B\u5E8F\u7279\u6709\u529F\u80FD" aria-hidden="true">#</a> \u5FAE\u4FE1\u5C0F\u7A0B\u5E8F\u7279\u6709\u529F\u80FD</h2><h3 id="\u914D\u7F6E\u5FAE\u4FE1-js-sdk" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E\u5FAE\u4FE1-js-sdk" aria-hidden="true">#</a> \u914D\u7F6E\u5FAE\u4FE1 JS-SDK</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u4EC5\u5728\u5FAE\u4FE1\u73AF\u5883\u4E0B\u9700\u8981\u914D\u7F6E</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">appId</span><span class="token operator">:</span> <span class="token string">&#39;your-app-id&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">timestamp</span><span class="token operator">:</span> <span class="token string">&#39;1234567890&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">nonceStr</span><span class="token operator">:</span> <span class="token string">&#39;random-string&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">signature</span><span class="token operator">:</span> <span class="token string">&#39;signature-string&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">jsApiList</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&#39;checkJsApi&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;chooseImage&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;previewImage&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;getLocation&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;openLocation&#39;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u5FAE\u4FE1\u4E13\u6709-api" tabindex="-1"><a class="header-anchor" href="#\u5FAE\u4FE1\u4E13\u6709-api" aria-hidden="true">#</a> \u5FAE\u4FE1\u4E13\u6709 API</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u626B\u63CF\u4E8C\u7EF4\u7801</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">scanQRCode</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">needResult</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// \u662F\u5426\u8FD4\u56DE\u626B\u63CF\u7ED3\u679C</span>
  <span class="token literal-property property">scanType</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;qrCode&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;barCode&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// \u626B\u63CF\u7C7B\u578B</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u626B\u63CF\u7ED3\u679C:&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>resultStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u5F55\u97F3\u76F8\u5173</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">startRecord</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u5F00\u59CB\u5F55\u97F3&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

webviewBridge<span class="token punctuation">.</span><span class="token function">stopRecord</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u5F55\u97F3\u6587\u4EF6:&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>localId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u64AD\u653E\u5F55\u97F3</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">playVoice</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">localId</span><span class="token operator">:</span> <span class="token string">&#39;localId&#39;</span><span class="token punctuation">,</span> <span class="token comment">// \u5F55\u97F3\u6587\u4EF6\u7684\u672C\u5730ID</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u64AD\u653E\u6210\u529F&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u652F\u4ED8\u5B9D\u5C0F\u7A0B\u5E8F\u7279\u6709\u529F\u80FD" tabindex="-1"><a class="header-anchor" href="#\u652F\u4ED8\u5B9D\u5C0F\u7A0B\u5E8F\u7279\u6709\u529F\u80FD" aria-hidden="true">#</a> \u652F\u4ED8\u5B9D\u5C0F\u7A0B\u5E8F\u7279\u6709\u529F\u80FD</h2><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u663E\u793A\u52A0\u8F7D\u63D0\u793A</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">showLoading</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">&#39;\u52A0\u8F7D\u4E2D...&#39;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u663E\u793A\u52A0\u8F7D\u63D0\u793A\u6210\u529F&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u9690\u85CF\u52A0\u8F7D\u63D0\u793A</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u9690\u85CF\u52A0\u8F7D\u63D0\u793A\u6210\u529F&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u5F39\u51FA\u63D0\u793A\u6846</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;\u63D0\u793A&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">&#39;\u8FD9\u662F\u4E00\u4E2A\u63D0\u793A&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">buttonText</span><span class="token operator">:</span> <span class="token string">&#39;\u786E\u5B9A&#39;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u63D0\u793A\u6846\u5173\u95ED&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u53D1\u8D77\u652F\u4ED8</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">tradePay</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">tradeNO</span><span class="token operator">:</span> <span class="token string">&#39;trade-no-123&#39;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u652F\u4ED8\u6210\u529F&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u652F\u4ED8\u5931\u8D25&#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u767E\u5EA6\u5C0F\u7A0B\u5E8F\u7279\u6709\u529F\u80FD" tabindex="-1"><a class="header-anchor" href="#\u767E\u5EA6\u5C0F\u7A0B\u5E8F\u7279\u6709\u529F\u80FD" aria-hidden="true">#</a> \u767E\u5EA6\u5C0F\u7A0B\u5E8F\u7279\u6709\u529F\u80FD</h2><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u62E8\u6253\u7535\u8BDD</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">makePhoneCall</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">phoneNumber</span><span class="token operator">:</span> <span class="token string">&#39;10086&#39;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u62E8\u6253\u6210\u529F&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u8BBE\u7F6E\u526A\u8D34\u677F\u5185\u5BB9</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">setClipboardData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token string">&#39;\u8981\u590D\u5236\u7684\u6587\u672C&#39;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u590D\u5236\u6210\u529F&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u9009\u62E9\u4F4D\u7F6E</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">chooseLocation</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u9009\u62E9\u7684\u4F4D\u7F6E:&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u8BE6\u7EC6\u5730\u5740:&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u7ECF\u7EAC\u5EA6:&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>latitude<span class="token punctuation">,</span> res<span class="token punctuation">.</span>longitude<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u5B57\u8282\u8DF3\u52A8\u5C0F\u7A0B\u5E8F\u7279\u6709\u529F\u80FD" tabindex="-1"><a class="header-anchor" href="#\u5B57\u8282\u8DF3\u52A8\u5C0F\u7A0B\u5E8F\u7279\u6709\u529F\u80FD" aria-hidden="true">#</a> \u5B57\u8282\u8DF3\u52A8\u5C0F\u7A0B\u5E8F\u7279\u6709\u529F\u80FD</h2><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u8BBE\u7F6E\u6ED1\u52A8\u8FD4\u56DE\u6A21\u5F0F</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">setSwipeBackModeSync</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;close&#39;</span> <span class="token comment">// &#39;open&#39; | &#39;close&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u538B\u7F29\u56FE\u7247</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">compressImage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">src</span><span class="token operator">:</span> <span class="token string">&#39;path/to/image&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">quality</span><span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token comment">// \u538B\u7F29\u8D28\u91CF</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u538B\u7F29\u540E\u7684\u56FE\u7247\u8DEF\u5F84:&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>tempFilePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u4E0A\u4F20\u6587\u4EF6</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">uploadFile</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;https://example.com/upload&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">filePath</span><span class="token operator">:</span> <span class="token string">&#39;path/to/file&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;file&#39;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u4E0A\u4F20\u6210\u529F&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u9519\u8BEF\u5904\u7406" tabindex="-1"><a class="header-anchor" href="#\u9519\u8BEF\u5904\u7406" aria-hidden="true">#</a> \u9519\u8BEF\u5904\u7406</h2><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u7EDF\u4E00\u7684\u9519\u8BEF\u5904\u7406\u65B9\u5F0F</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">someApi</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u64CD\u4F5C\u6210\u529F&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;\u64CD\u4F5C\u5931\u8D25&#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// \u6839\u636E\u9519\u8BEF\u7C7B\u578B\u8FDB\u884C\u5904\u7406</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">.</span>errMsg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;\u9519\u8BEF\u4FE1\u606F:&#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span>errMsg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">complete</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u64CD\u4F5C\u5B8C\u6210\uFF08\u65E0\u8BBA\u6210\u529F\u6216\u5931\u8D25\uFF09&#39;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u6700\u4F73\u5B9E\u8DF5" tabindex="-1"><a class="header-anchor" href="#\u6700\u4F73\u5B9E\u8DF5" aria-hidden="true">#</a> \u6700\u4F73\u5B9E\u8DF5</h2><h3 id="_1-\u73AF\u5883\u68C0\u6D4B-1" tabindex="-1"><a class="header-anchor" href="#_1-\u73AF\u5883\u68C0\u6D4B-1" aria-hidden="true">#</a> 1. \u73AF\u5883\u68C0\u6D4B</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u5728\u4F7F\u7528\u7279\u5B9A\u5E73\u53F0\u529F\u80FD\u524D\uFF0C\u5148\u68C0\u6D4B\u73AF\u5883</span>
webviewBridge<span class="token punctuation">.</span><span class="token function">getEnv</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>webapp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Web \u73AF\u5883\u7684\u5904\u7406\u903B\u8F91</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u5F53\u524D\u5728 Web \u73AF\u5883&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>reactNative<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// React Native \u73AF\u5883\u7684\u5904\u7406\u903B\u8F91</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u5F53\u524D\u5728 React Native \u73AF\u5883&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u5C0F\u7A0B\u5E8F\u73AF\u5883\u7684\u5904\u7406\u903B\u8F91</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u5F53\u524D\u5728\u5C0F\u7A0B\u5E8F\u73AF\u5883&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-\u529F\u80FD\u964D\u7EA7" tabindex="-1"><a class="header-anchor" href="#_2-\u529F\u80FD\u964D\u7EA7" aria-hidden="true">#</a> 2. \u529F\u80FD\u964D\u7EA7</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u5BF9\u4E8E\u4E0D\u652F\u6301\u7684\u529F\u80FD\uFF0C\u63D0\u4F9B\u964D\u7EA7\u65B9\u6848</span>
<span class="token keyword">function</span> <span class="token function">shareContent</span><span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> webviewBridge<span class="token punctuation">.</span>startShare <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u652F\u4ED8\u5B9D\u5C0F\u7A0B\u5E8F\u7684\u5206\u4EAB</span>
    webviewBridge<span class="token punctuation">.</span><span class="token function">startShare</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">title</span><span class="token operator">:</span> content<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
      <span class="token literal-property property">content</span><span class="token operator">:</span> content<span class="token punctuation">.</span>desc<span class="token punctuation">,</span>
      <span class="token literal-property property">url</span><span class="token operator">:</span> content<span class="token punctuation">.</span>url
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u964D\u7EA7\u65B9\u6848\uFF1A\u590D\u5236\u94FE\u63A5\u5230\u526A\u8D34\u677F</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>clipboard<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      navigator<span class="token punctuation">.</span>clipboard<span class="token punctuation">.</span><span class="token function">writeText</span><span class="token punctuation">(</span>content<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;\u94FE\u63A5\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301\u5206\u4EAB\u529F\u80FD&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-promise-\u5C01\u88C5" tabindex="-1"><a class="header-anchor" href="#_3-promise-\u5C01\u88C5" aria-hidden="true">#</a> 3. Promise \u5C01\u88C5</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u5C06\u56DE\u8C03\u5F62\u5F0F\u7684 API \u5C01\u88C5\u4E3A Promise</span>
<span class="token keyword">function</span> <span class="token function">chooseImageAsync</span><span class="token punctuation">(</span><span class="token parameter">options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    webviewBridge<span class="token punctuation">.</span><span class="token function">chooseImage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token operator">...</span>options<span class="token punctuation">,</span>
      <span class="token literal-property property">success</span><span class="token operator">:</span> resolve<span class="token punctuation">,</span>
      <span class="token literal-property property">fail</span><span class="token operator">:</span> reject
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// \u4F7F\u7528 async/await</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">handleChooseImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">chooseImageAsync</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token literal-property property">sizeType</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;compressed&#39;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u9009\u62E9\u7684\u56FE\u7247:&#39;</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>tempFilePaths<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;\u9009\u62E9\u56FE\u7247\u5931\u8D25:&#39;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u6CE8\u610F\u4E8B\u9879" tabindex="-1"><a class="header-anchor" href="#\u6CE8\u610F\u4E8B\u9879" aria-hidden="true">#</a> \u6CE8\u610F\u4E8B\u9879</h2><ol><li><strong>\u73AF\u5883\u68C0\u6D4B</strong>\uFF1A\u5728\u4F7F\u7528\u7279\u5B9A\u5E73\u53F0\u529F\u80FD\u524D\uFF0C\u5EFA\u8BAE\u5148\u68C0\u6D4B\u5F53\u524D\u8FD0\u884C\u73AF\u5883</li><li><strong>\u9519\u8BEF\u5904\u7406</strong>\uFF1A\u59CB\u7EC8\u63D0\u4F9B <code>fail</code> \u56DE\u8C03\u6765\u5904\u7406\u53EF\u80FD\u7684\u9519\u8BEF</li><li><strong>\u6743\u9650\u7533\u8BF7</strong>\uFF1A\u67D0\u4E9B\u529F\u80FD\uFF08\u5982\u4F4D\u7F6E\u3001\u76F8\u673A\uFF09\u9700\u8981\u7528\u6237\u6388\u6743</li><li><strong>\u517C\u5BB9\u6027</strong>\uFF1A\u4E0D\u540C\u5E73\u53F0\u5BF9\u76F8\u540C API \u7684\u652F\u6301\u7A0B\u5EA6\u53EF\u80FD\u4E0D\u540C</li><li><strong>\u6D4B\u8BD5</strong>\uFF1A\u5728\u5404\u4E2A\u76EE\u6807\u5E73\u53F0\u4E0A\u8FDB\u884C\u5145\u5206\u6D4B\u8BD5</li></ol><h2 id="\u8C03\u8BD5\u6280\u5DE7" tabindex="-1"><a class="header-anchor" href="#\u8C03\u8BD5\u6280\u5DE7" aria-hidden="true">#</a> \u8C03\u8BD5\u6280\u5DE7</h2><ol><li><strong>\u63A7\u5236\u53F0\u65E5\u5FD7</strong>\uFF1A\u4F7F\u7528 <code>console.log</code> \u67E5\u770B\u8FD4\u56DE\u7ED3\u679C</li><li><strong>\u9519\u8BEF\u4FE1\u606F</strong>\uFF1A\u5173\u6CE8 <code>fail</code> \u56DE\u8C03\u4E2D\u7684\u9519\u8BEF\u4FE1\u606F</li><li><strong>\u7F51\u7EDC\u8C03\u8BD5</strong>\uFF1A\u4F7F\u7528\u5F00\u53D1\u8005\u5DE5\u5177\u76D1\u63A7\u7F51\u7EDC\u8BF7\u6C42</li><li><strong>\u771F\u673A\u6D4B\u8BD5</strong>\uFF1A\u67D0\u4E9B\u529F\u80FD\u9700\u8981\u5728\u771F\u673A\u4E0A\u6D4B\u8BD5</li></ol><h2 id="\u6253\u5305\u540Ejs\u6587\u4EF6-\u53EF\u76F4\u63A5\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#\u6253\u5305\u540Ejs\u6587\u4EF6-\u53EF\u76F4\u63A5\u4F7F\u7528" aria-hidden="true">#</a> \u6253\u5305\u540Ejs\u6587\u4EF6(\u53EF\u76F4\u63A5\u4F7F\u7528\uFF09</h2><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// utils/webviewBridge.js</span>

<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">global<span class="token punctuation">,</span> factory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">typeof</span> exports <span class="token operator">===</span> <span class="token string">&#39;object&#39;</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> module <span class="token operator">!==</span> <span class="token string">&#39;undefined&#39;</span> <span class="token operator">?</span> module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span>
    <span class="token keyword">typeof</span> window <span class="token operator">!==</span> <span class="token string">&#39;undefined&#39;</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> window<span class="token punctuation">.</span>define <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span> <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>define<span class="token punctuation">.</span>amd <span class="token operator">?</span> window<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span>factory<span class="token punctuation">)</span> <span class="token operator">:</span>
    <span class="token punctuation">(</span>global <span class="token operator">=</span> global <span class="token operator">||</span> self<span class="token punctuation">,</span> global<span class="token punctuation">.</span>mpx <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>
  
    <span class="token keyword">function</span> <span class="token function">loadScript</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> _ref <span class="token operator">=</span> arguments<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        _ref$time <span class="token operator">=</span> _ref<span class="token punctuation">.</span>time<span class="token punctuation">,</span>
        time <span class="token operator">=</span> _ref$time <span class="token operator">===</span> <span class="token keyword">void</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">5000</span> <span class="token operator">:</span> _ref$time<span class="token punctuation">,</span>
        _ref$crossOrigin <span class="token operator">=</span> _ref<span class="token punctuation">.</span>crossOrigin<span class="token punctuation">,</span>
        crossOrigin <span class="token operator">=</span> _ref$crossOrigin <span class="token operator">===</span> <span class="token keyword">void</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token boolean">false</span> <span class="token operator">:</span> _ref$crossOrigin<span class="token punctuation">;</span>
      <span class="token keyword">function</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> sc <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;script&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          sc<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">&#39;text/javascript&#39;</span><span class="token punctuation">;</span>
          sc<span class="token punctuation">.</span>async <span class="token operator">=</span> <span class="token string">&#39;async&#39;</span><span class="token punctuation">;</span>
  
          <span class="token comment">// \u53EF\u9009\u5730\u589E\u52A0 crossOrigin \u7279\u6027</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>crossOrigin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            sc<span class="token punctuation">.</span>crossOrigin <span class="token operator">=</span> <span class="token string">&#39;anonymous&#39;</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          sc<span class="token punctuation">.</span>onload <span class="token operator">=</span> sc<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>readyState <span class="token operator">||</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^(loaded|complete)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>readyState<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              sc<span class="token punctuation">.</span>onload <span class="token operator">=</span> sc<span class="token punctuation">.</span>onreadystatechange <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">;</span>
          sc<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;load &quot;</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token string">&quot; error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            sc<span class="token punctuation">.</span>onerror <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">;</span>
          sc<span class="token punctuation">.</span>src <span class="token operator">=</span> url<span class="token punctuation">;</span>
          document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">&#39;head&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>sc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">function</span> <span class="token function">timeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;load &quot;</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token string">&quot; timeout&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">timeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  
    <span class="token keyword">var</span> sdkReady<span class="token punctuation">;</span>
    <span class="token keyword">var</span> <span class="token constant">SDK_URL_MAP</span> <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">wx</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;https://res.wx.qq.com/open/js/jweixin-1.3.2.js&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">qq</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;https://qqq.gtimg.cn/miniprogram/webview_jssdk/qqjssdk-1.0.0.js&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">my</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;https://appx/web-view.min.js&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">swan</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;https://b.bdstatic.com/searchbox/icms/searchbox/js/swan-2.0.4.js&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">tt</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;https://lf3-cdn-tos.bytegoofy.com/obj/goofy/developer/jssdk/jssdk-1.2.1.js&#39;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> window<span class="token punctuation">.</span>sdkUrlMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">getMpxWebViewId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> href <span class="token operator">=</span> location<span class="token punctuation">.</span>href<span class="token punctuation">;</span>
      <span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">mpx_webview_id=(\\d+)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> matchVal <span class="token operator">=</span> reg<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>href<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> result<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>matchVal <span class="token operator">&amp;&amp;</span> matchVal<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        result <span class="token operator">=</span> <span class="token operator">+</span>matchVal<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> env <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> callbackId <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> clientUid <span class="token operator">=</span> <span class="token function">getMpxWebViewId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> callbacks <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> <span class="token function-variable function">runCallback</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">runCallback</span><span class="token punctuation">(</span><span class="token parameter">msgData</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> callbackId <span class="token operator">=</span> msgData<span class="token punctuation">.</span>callbackId<span class="token punctuation">,</span>
        error <span class="token operator">=</span> msgData<span class="token punctuation">.</span>error<span class="token punctuation">,</span>
        result <span class="token operator">=</span> msgData<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>callbackId <span class="token operator">!==</span> <span class="token keyword">undefined</span> <span class="token operator">&amp;&amp;</span> callbacks<span class="token punctuation">[</span>callbackId<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          callbacks<span class="token punctuation">[</span>callbackId<span class="token punctuation">]</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          callbacks<span class="token punctuation">[</span>callbackId<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">delete</span> callbacks<span class="token punctuation">[</span>callbackId<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> <span class="token function-variable function">eventListener</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">eventListener</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// \u63A5\u6536web-view\u7684\u56DE\u8C03</span>
      <span class="token keyword">var</span> msgData <span class="token operator">=</span> event<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> msgData <span class="token operator">===</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          msgData <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>msgData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">runCallback</span><span class="token punctuation">(</span>msgData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  
    <span class="token comment">// \u73AF\u5883\u5224\u65AD\u903B\u8F91</span>
    <span class="token keyword">var</span> systemUA <span class="token operator">=</span> navigator<span class="token punctuation">.</span>userAgent<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>systemUA<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;AlipayClient&#39;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> systemUA<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;MiniProgram&#39;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      env <span class="token operator">=</span> <span class="token string">&#39;my&#39;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>systemUA<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;miniprogram&#39;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      env <span class="token operator">=</span> systemUA<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;QQ&#39;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">?</span> <span class="token string">&#39;qq&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;wx&#39;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>systemUA<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;swan/&#39;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      env <span class="token operator">=</span> <span class="token string">&#39;swan&#39;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>systemUA<span class="token punctuation">.</span><span class="token function">toLocaleLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;toutiao&#39;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      env <span class="token operator">=</span> <span class="token string">&#39;tt&#39;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>ReactNativeWebView<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      env <span class="token operator">=</span> <span class="token string">&#39;rn&#39;</span><span class="token punctuation">;</span>
      window<span class="token punctuation">.</span>mpxWebviewMessageCallback <span class="token operator">=</span> runCallback<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      env <span class="token operator">=</span> <span class="token string">&#39;web&#39;</span><span class="token punctuation">;</span>
      window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;message&#39;</span><span class="token punctuation">,</span> eventListener<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> <span class="token function-variable function">initWebviewBridge</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">initWebviewBridge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      sdkReady <span class="token operator">=</span> env <span class="token operator">!==</span> <span class="token string">&#39;web&#39;</span> <span class="token operator">&amp;&amp;</span> env <span class="token operator">!==</span> <span class="token string">&#39;rn&#39;</span> <span class="token operator">?</span> <span class="token constant">SDK_URL_MAP</span><span class="token punctuation">[</span>env<span class="token punctuation">]</span><span class="token punctuation">.</span>url <span class="token operator">?</span> <span class="token function">loadScript</span><span class="token punctuation">(</span><span class="token constant">SDK_URL_MAP</span><span class="token punctuation">[</span>env<span class="token punctuation">]</span><span class="token punctuation">.</span>url<span class="token punctuation">)</span> <span class="token operator">:</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#39;\u672A\u627E\u5230\u5BF9\u5E94\u7684sdk&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">getWebviewApi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> webviewSdkready <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">runWebviewApiMethod</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>webviewSdkready<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        sdkReady<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          webviewSdkready <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
          <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> webviewBridge <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">config</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">config</span><span class="token punctuation">(</span><span class="token parameter">_config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>env <span class="token operator">!==</span> <span class="token string">&#39;wx&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&#39;\u975E\u5FAE\u4FE1\u73AF\u5883\u4E0D\u9700\u8981\u914D\u7F6Econfig&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">runWebviewApiMethod</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>wx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            window<span class="token punctuation">.</span>wx<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span>_config<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> _len <span class="token operator">=</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">,</span> extraData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>_len <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">?</span> _len <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _key <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> _key <span class="token operator">&lt;</span> _len<span class="token punctuation">;</span> _key<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        extraData<span class="token punctuation">[</span>_key <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> arguments<span class="token punctuation">[</span>_key<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&#39;invoke&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        type <span class="token operator">=</span> extraData<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        extraData <span class="token operator">=</span> extraData<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">var</span> data <span class="token operator">=</span> extraData<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">!==</span> <span class="token string">&#39;getEnv&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> currentCallbackId <span class="token operator">=</span> <span class="token operator">++</span>callbackId<span class="token punctuation">;</span>
        callbacks<span class="token punctuation">[</span>currentCallbackId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            data<span class="token punctuation">.</span>fail <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
            data<span class="token punctuation">.</span>complete <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            data<span class="token punctuation">.</span>success <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
            data<span class="token punctuation">.</span>complete <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">delete</span> callbacks<span class="token punctuation">[</span>currentCallbackId<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> postParams <span class="token operator">=</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">type</span><span class="token operator">:</span> type<span class="token punctuation">,</span>
          <span class="token literal-property property">callbackId</span><span class="token operator">:</span> callbackId<span class="token punctuation">,</span>
          <span class="token literal-property property">args</span><span class="token operator">:</span> extraData
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>clientUid <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          postParams<span class="token punctuation">.</span>clientUid <span class="token operator">=</span> clientUid<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>ReactNativeWebView<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          window<span class="token punctuation">.</span>ReactNativeWebView<span class="token punctuation">.</span>postMessage <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>ReactNativeWebView<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>postParams<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          window<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>postMessage <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>parent<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>postParams<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;*&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">webapp</span><span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>ReactNativeWebView<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          result <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">reactNative</span><span class="token operator">:</span> <span class="token boolean">true</span>
          <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">data</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> <span class="token function-variable function">getWebviewApi</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">getWebviewApi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> multiApiMap <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">wx</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">keyName</span><span class="token operator">:</span> <span class="token string">&#39;miniProgram&#39;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">api</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;navigateTo&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;navigateBack&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;switchTab&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;reLaunch&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;redirectTo&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;postMessage&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;getEnv&#39;</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">tt</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">keyName</span><span class="token operator">:</span> <span class="token string">&#39;miniProgram&#39;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">api</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;redirectTo&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;navigateTo&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;switchTab&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;reLaunch&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;navigateBack&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;setSwipeBackModeSync&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;postMessage&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;getEnv&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;checkJsApi&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;chooseImage&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;compressImage&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;previewImage&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;uploadFile&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;getNetworkType&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;openLocation&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;getLocation&#39;</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">swan</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">keyName</span><span class="token operator">:</span> <span class="token string">&#39;webView&#39;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">api</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;navigateTo&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;navigateBack&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;switchTab&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;reLaunch&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;redirectTo&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;getEnv&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;postMessage&#39;</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">qq</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">keyName</span><span class="token operator">:</span> <span class="token string">&#39;miniProgram&#39;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">api</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;navigateTo&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;navigateBack&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;switchTab&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;reLaunch&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;redirectTo&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;getEnv&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;postMessage&#39;</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> singleApiMap <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">wx</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;checkJSApi&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;chooseImage&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;previewImage&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;uploadImage&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;downloadImage&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;getLocalImgData&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;startRecord&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;stopRecord&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;onVoiceRecordEnd&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;playVoice&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;pauseVoice&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;stopVoice&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;onVoicePlayEnd&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;uploadVoice&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;downloadVoice&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;translateVoice&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;getNetworkType&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;openLocation&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;getLocation&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;startSearchBeacons&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;stopSearchBeacons&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;onSearchBeacons&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;scanQRCode&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;chooseCard&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;addCard&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;openCard&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">my</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;navigateTo&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;navigateBack&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;switchTab&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;reLaunch&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;redirectTo&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;chooseImage&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;previewImage&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;getLocation&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;openLocation&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;alert&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;showLoading&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;hideLoading&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;getNetworkType&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;startShare&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;tradePay&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;postMessage&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;onMessage&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;getEnv&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">swan</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;makePhoneCall&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;setClipboardData&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;getNetworkType&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;openLocation&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;getLocation&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;chooseLocation&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;chooseImage&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;previewImage&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;openShare&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;navigateToSmartProgram&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">web</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;navigateTo&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;navigateBack&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;switchTab&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;reLaunch&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;redirectTo&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;getEnv&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;postMessage&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;getLocation&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;invoke&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">rn</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;navigateTo&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;navigateBack&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;switchTab&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;reLaunch&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;redirectTo&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;getEnv&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;postMessage&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;getLocation&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;invoke&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">tt</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> multiApi <span class="token operator">=</span> multiApiMap<span class="token punctuation">[</span>env<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> singleApi <span class="token operator">=</span> singleApiMap<span class="token punctuation">[</span>env<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> multiApiLists <span class="token operator">=</span> multiApi<span class="token punctuation">.</span>api <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      multiApiLists<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        webviewBridge<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> _len2 <span class="token operator">=</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">,</span> args <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>_len2<span class="token punctuation">)</span><span class="token punctuation">,</span> _key2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> _key2 <span class="token operator">&lt;</span> _len2<span class="token punctuation">;</span> _key2<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            args<span class="token punctuation">[</span>_key2<span class="token punctuation">]</span> <span class="token operator">=</span> arguments<span class="token punctuation">[</span>_key2<span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token function">runWebviewApiMethod</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> _window$env$multiApi$<span class="token punctuation">;</span>
            <span class="token punctuation">(</span>_window$env$multiApi$ <span class="token operator">=</span> window<span class="token punctuation">[</span>env<span class="token punctuation">]</span><span class="token punctuation">[</span>multiApi<span class="token punctuation">.</span>keyName<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>_window$env$multiApi$<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      singleApi<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        webviewBridge<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> _len3 <span class="token operator">=</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">,</span> args <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>_len3<span class="token punctuation">)</span><span class="token punctuation">,</span> _key3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> _key3 <span class="token operator">&lt;</span> _len3<span class="token punctuation">;</span> _key3<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            args<span class="token punctuation">[</span>_key3<span class="token punctuation">]</span> <span class="token operator">=</span> arguments<span class="token punctuation">[</span>_key3<span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>env <span class="token operator">===</span> <span class="token string">&#39;web&#39;</span> <span class="token operator">||</span> env <span class="token operator">===</span> <span class="token string">&#39;rn&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">postMessage</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>env <span class="token operator">===</span> <span class="token string">&#39;wx&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">runWebviewApiMethod</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              window<span class="token punctuation">[</span>env<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">[</span>env<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">var</span> _window$env<span class="token punctuation">;</span>
                <span class="token punctuation">(</span>_window$env <span class="token operator">=</span> window<span class="token punctuation">[</span>env<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>_window$env<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">runWebviewApiMethod</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token keyword">var</span> _window$env2<span class="token punctuation">;</span>
              <span class="token punctuation">(</span>_window$env2 <span class="token operator">=</span> window<span class="token punctuation">[</span>env<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>_window$env2<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">initWebviewBridge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
    <span class="token keyword">return</span> webviewBridge<span class="token punctuation">;</span>
  
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="es6\u6A21\u5757\u4EE3\u7801-\u9700\u8C03\u8BD5" tabindex="-1"><a class="header-anchor" href="#es6\u6A21\u5757\u4EE3\u7801-\u9700\u8C03\u8BD5" aria-hidden="true">#</a> ES6\u6A21\u5757\u4EE3\u7801\uFF08\u9700\u8C03\u8BD5\uFF09</h2><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> loadScript <span class="token keyword">from</span> <span class="token string">&#39;./loadscript&#39;</span>
<span class="token keyword">let</span> sdkReady
<span class="token keyword">const</span> <span class="token constant">SDK_URL_MAP</span> <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">wx</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;https://res.wx.qq.com/open/js/jweixin-1.3.2.js&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">qq</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;https://qqq.gtimg.cn/miniprogram/webview_jssdk/qqjssdk-1.0.0.js&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">my</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;https://appx/web-view.min.js&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">swan</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;https://b.bdstatic.com/searchbox/icms/searchbox/js/swan-2.0.4.js&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">tt</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;https://lf3-cdn-tos.bytegoofy.com/obj/goofy/developer/jssdk/jssdk-1.2.1.js&#39;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> window<span class="token punctuation">.</span>sdkUrlMap<span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">getMpxWebViewId</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> href <span class="token operator">=</span> location<span class="token punctuation">.</span>href
  <span class="token keyword">const</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">mpx_webview_id=(\\d+)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span>
  <span class="token keyword">const</span> matchVal <span class="token operator">=</span> reg<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>href<span class="token punctuation">)</span>
  <span class="token keyword">let</span> result
  <span class="token keyword">if</span> <span class="token punctuation">(</span>matchVal <span class="token operator">&amp;&amp;</span> matchVal<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result <span class="token operator">=</span> <span class="token operator">+</span>matchVal<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result
<span class="token punctuation">}</span>
<span class="token keyword">let</span> env <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token keyword">let</span> callbackId <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">const</span> clientUid <span class="token operator">=</span> <span class="token function">getMpxWebViewId</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> callbacks <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">runCallback</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">msgData</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> callbackId<span class="token punctuation">,</span> error<span class="token punctuation">,</span> result <span class="token punctuation">}</span> <span class="token operator">=</span> msgData
  <span class="token keyword">if</span> <span class="token punctuation">(</span>callbackId <span class="token operator">!==</span> <span class="token keyword">undefined</span> <span class="token operator">&amp;&amp;</span> callbacks<span class="token punctuation">[</span>callbackId<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      callbacks<span class="token punctuation">[</span>callbackId<span class="token punctuation">]</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      callbacks<span class="token punctuation">[</span>callbackId<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">delete</span> callbacks<span class="token punctuation">[</span>callbackId<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">eventListener</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u63A5\u6536web-view\u7684\u56DE\u8C03</span>
  <span class="token keyword">let</span> msgData <span class="token operator">=</span> event<span class="token punctuation">.</span>data
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> msgData <span class="token operator">===</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      msgData <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>msgData<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span>
  <span class="token function">runCallback</span><span class="token punctuation">(</span>msgData<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// \u73AF\u5883\u5224\u65AD\u903B\u8F91</span>
<span class="token keyword">const</span> systemUA <span class="token operator">=</span> navigator<span class="token punctuation">.</span>userAgent
<span class="token keyword">if</span> <span class="token punctuation">(</span>systemUA<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;AlipayClient&#39;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> systemUA<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;MiniProgram&#39;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  env <span class="token operator">=</span> <span class="token string">&#39;my&#39;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>systemUA<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;miniprogram&#39;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  env <span class="token operator">=</span> systemUA<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;QQ&#39;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">?</span> <span class="token string">&#39;qq&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;wx&#39;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>systemUA<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;swan/&#39;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  env <span class="token operator">=</span> <span class="token string">&#39;swan&#39;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>systemUA<span class="token punctuation">.</span><span class="token function">toLocaleLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;toutiao&#39;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  env <span class="token operator">=</span> <span class="token string">&#39;tt&#39;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>ReactNativeWebView<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  env <span class="token operator">=</span> <span class="token string">&#39;rn&#39;</span>
  window<span class="token punctuation">.</span>mpxWebviewMessageCallback <span class="token operator">=</span> runCallback
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  env <span class="token operator">=</span> <span class="token string">&#39;web&#39;</span>
  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;message&#39;</span><span class="token punctuation">,</span> eventListener<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">initWebviewBridge</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  sdkReady <span class="token operator">=</span> <span class="token punctuation">(</span>env <span class="token operator">!==</span> <span class="token string">&#39;web&#39;</span> <span class="token operator">&amp;&amp;</span> env <span class="token operator">!==</span> <span class="token string">&#39;rn&#39;</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token constant">SDK_URL_MAP</span><span class="token punctuation">[</span>env<span class="token punctuation">]</span><span class="token punctuation">.</span>url <span class="token operator">?</span> <span class="token function">loadScript</span><span class="token punctuation">(</span><span class="token constant">SDK_URL_MAP</span><span class="token punctuation">[</span>env<span class="token punctuation">]</span><span class="token punctuation">.</span>url<span class="token punctuation">)</span> <span class="token operator">:</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#39;\u672A\u627E\u5230\u5BF9\u5E94\u7684sdk&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">getWebviewApi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> webviewSdkready <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token keyword">function</span> <span class="token function">runWebviewApiMethod</span> <span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>webviewSdkready<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    sdkReady<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      webviewSdkready <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> webviewBridge <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">config</span> <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>env <span class="token operator">!==</span> <span class="token string">&#39;wx&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&#39;\u975E\u5FAE\u4FE1\u73AF\u5883\u4E0D\u9700\u8981\u914D\u7F6Econfig&#39;</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token function">runWebviewApiMethod</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>wx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        window<span class="token punctuation">.</span>wx<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">postMessage</span> <span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> <span class="token operator">...</span>extraData</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&#39;invoke&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    type <span class="token operator">=</span> extraData<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    extraData <span class="token operator">=</span> extraData<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> extraData<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">!==</span> <span class="token string">&#39;getEnv&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> currentCallbackId <span class="token operator">=</span> <span class="token operator">++</span>callbackId
    callbacks<span class="token punctuation">[</span>currentCallbackId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        data<span class="token punctuation">.</span>fail <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        data<span class="token punctuation">.</span>complete <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        data<span class="token punctuation">.</span>success <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
        data<span class="token punctuation">.</span>complete <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">delete</span> callbacks<span class="token punctuation">[</span>currentCallbackId<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> postParams <span class="token operator">=</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">,</span>
      callbackId<span class="token punctuation">,</span>
      <span class="token literal-property property">args</span><span class="token operator">:</span> extraData
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>clientUid <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      postParams<span class="token punctuation">.</span>clientUid <span class="token operator">=</span> clientUid
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>ReactNativeWebView<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      window<span class="token punctuation">.</span>ReactNativeWebView<span class="token punctuation">.</span>postMessage <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>ReactNativeWebView<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>postParams<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      window<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>postMessage <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>parent<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>postParams<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;*&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">webapp</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>ReactNativeWebView<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      result <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">reactNative</span><span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">data</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">getWebviewApi</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> multiApiMap <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">wx</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">keyName</span><span class="token operator">:</span> <span class="token string">&#39;miniProgram&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">api</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&#39;navigateTo&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;navigateBack&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;switchTab&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;reLaunch&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;redirectTo&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;postMessage&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;getEnv&#39;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">tt</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">keyName</span><span class="token operator">:</span> <span class="token string">&#39;miniProgram&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">api</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&#39;redirectTo&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;navigateTo&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;switchTab&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;reLaunch&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;navigateBack&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;setSwipeBackModeSync&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;postMessage&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;getEnv&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;checkJsApi&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;chooseImage&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;compressImage&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;previewImage&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;uploadFile&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;getNetworkType&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;openLocation&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;getLocation&#39;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">swan</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">keyName</span><span class="token operator">:</span> <span class="token string">&#39;webView&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">api</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&#39;navigateTo&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;navigateBack&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;switchTab&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;reLaunch&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;redirectTo&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;getEnv&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;postMessage&#39;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">qq</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">keyName</span><span class="token operator">:</span> <span class="token string">&#39;miniProgram&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">api</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&#39;navigateTo&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;navigateBack&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;switchTab&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;reLaunch&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;redirectTo&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;getEnv&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;postMessage&#39;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> singleApiMap <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">wx</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&#39;checkJSApi&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;chooseImage&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;previewImage&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;uploadImage&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;downloadImage&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;getLocalImgData&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;startRecord&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;stopRecord&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;onVoiceRecordEnd&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;playVoice&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;pauseVoice&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;stopVoice&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;onVoicePlayEnd&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;uploadVoice&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;downloadVoice&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;translateVoice&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;getNetworkType&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;openLocation&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;getLocation&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;startSearchBeacons&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;stopSearchBeacons&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;onSearchBeacons&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;scanQRCode&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;chooseCard&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;addCard&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;openCard&#39;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">my</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&#39;navigateTo&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;navigateBack&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;switchTab&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;reLaunch&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;redirectTo&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;chooseImage&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;previewImage&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;getLocation&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;openLocation&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;alert&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;showLoading&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;hideLoading&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;getNetworkType&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;startShare&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;tradePay&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;postMessage&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;onMessage&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;getEnv&#39;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">swan</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&#39;makePhoneCall&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;setClipboardData&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;getNetworkType&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;openLocation&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;getLocation&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;chooseLocation&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;chooseImage&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;previewImage&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;openShare&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;navigateToSmartProgram&#39;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">web</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&#39;navigateTo&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;navigateBack&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;switchTab&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;reLaunch&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;redirectTo&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;getEnv&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;postMessage&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;getLocation&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;invoke&#39;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">rn</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&#39;navigateTo&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;navigateBack&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;switchTab&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;reLaunch&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;redirectTo&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;getEnv&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;postMessage&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;getLocation&#39;</span><span class="token punctuation">,</span>
      <span class="token string">&#39;invoke&#39;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">tt</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> multiApi <span class="token operator">=</span> multiApiMap<span class="token punctuation">[</span>env<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">const</span> singleApi <span class="token operator">=</span> singleApiMap<span class="token punctuation">[</span>env<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> multiApiLists <span class="token operator">=</span> multiApi<span class="token punctuation">.</span>api <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  multiApiLists<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    webviewBridge<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">runWebviewApiMethod</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        window<span class="token punctuation">[</span>env<span class="token punctuation">]</span><span class="token punctuation">[</span>multiApi<span class="token punctuation">.</span>keyName<span class="token punctuation">]</span><span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  singleApi<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    webviewBridge<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>env <span class="token operator">===</span> <span class="token string">&#39;web&#39;</span> <span class="token operator">||</span> env <span class="token operator">===</span> <span class="token string">&#39;rn&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">postMessage</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>env <span class="token operator">===</span> <span class="token string">&#39;wx&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">runWebviewApiMethod</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          window<span class="token punctuation">[</span>env<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">[</span>env<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            window<span class="token punctuation">[</span>env<span class="token punctuation">]</span><span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">runWebviewApiMethod</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          window<span class="token punctuation">[</span>env<span class="token punctuation">]</span><span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">initWebviewBridge</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> webviewBridge
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u53C2\u8003\u5730\u5740" tabindex="-1"><a class="header-anchor" href="#\u53C2\u8003\u5730\u5740" aria-hidden="true">#</a> \u53C2\u8003\u5730\u5740</h2>`,54),r=s("\u53C2\u8003\u5730\u5740\uFF1A"),k={href:"https://www.npmjs.com/package/@mpxjs/webview-bridge?activeTab=readme",target:"_blank",rel:"noopener noreferrer"},d=s("https://www.npmjs.com/package/@mpxjs/webview-bridge?activeTab=readme");function v(m,b){const a=t("ExternalLinkIcon");return e(),o("div",null,[u,n("ul",null,[n("li",null,[r,n("a",k,[d,c(a)])])])])}var w=p(l,[["render",v],["__file","webviewBridge.html.vue"]]);export{w as default};
